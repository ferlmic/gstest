<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="fr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Rétablir les contraintes linéaires transversales (contemporaines) — tsbalancing • gstest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rétablir les contraintes linéaires transversales (contemporaines) — tsbalancing"><meta name="description" content="Réplication de la macro GSeriesTSBalancing de G-Séries 2.0 en SAS\(^\circledR\). Voir la documentation
de G-Séries 2.0 pour plus de détails (Statistique Canada 2016).
Cette fonction équilibre (réconcilie) un système de séries chronologiques selon un ensemble de contraintes linéaires.
La solution d'équilibrage (« balancing ») est obtenue en résolvant un ou plusieurs problèmes de minimisation quadratique
(voir la section Détails) avec le solveur OSQP (Stellato et al. 2020). Étant donné la faisabilité du (des) problème(s)
d'équilibrage, les données des séries chronologiques résultantes respectent les contraintes spécifiées pour chaque période.
Des contraintes linéaires d'égalité et d'inégalité sont permises. Optionnellement, la préservation des totaux temporels peut
également être spécifiée."><meta property="og:description" content="Réplication de la macro GSeriesTSBalancing de G-Séries 2.0 en SAS\(^\circledR\). Voir la documentation
de G-Séries 2.0 pour plus de détails (Statistique Canada 2016).
Cette fonction équilibre (réconcilie) un système de séries chronologiques selon un ensemble de contraintes linéaires.
La solution d'équilibrage (« balancing ») est obtenue en résolvant un ou plusieurs problèmes de minimisation quadratique
(voir la section Détails) avec le solveur OSQP (Stellato et al. 2020). Étant donné la faisabilité du (des) problème(s)
d'équilibrage, les données des séries chronologiques résultantes respectent les contraintes spécifiées pour chaque période.
Des contraintes linéaires d'égalité et d'inégalité sont permises. Optionnellement, la préservation des totaux temporels peut
également être spécifiée."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Passer au contenu</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Navigation sur le site"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gstest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Dernière version publiée">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Activer la navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gstest.html">Prise en main</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Référence</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmarking-cookbook.html">Livre de recette sur l'étalonnage</a></li>
    <li><a class="dropdown-item" href="../articles/benchmarking-demo-script.html">Un script d'étalonnage pour débutant</a></li>
    <li><a class="dropdown-item" href="../articles/osqp-settings-sequence-dataframe.html">« Data frame » pour la séquence de paramètres d'OSQP</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-nouveaut-s" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Nouveautés</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-nouveaut-s"><li><h6 class="dropdown-header" data-toc-skip>Versions</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/tree/main/">G-Séries 3.0 (version la plus récente - librairie R gstest 3.0.0)</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/releases/tag/v2.0/">G-Séries 2.0 (version SAS®)</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/releases/tag/v1.04/">G-Séries 1.04 (version SAS®)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changements</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Rechercher sur le site" placeholder="Rechercher" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ferlmic/gstest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>

    <ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="#" onclick="window.location = location.href.replace('/fr/','/en/');"><span class="fa fa-language fa-lg"></span> English</a></li></ul></div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rétablir les contraintes linéaires transversales (contemporaines)</h1>
      <small class="dont-index">Source : <a href="https://github.com/ferlmic/gstest/tree/main/fr/R/tsbalancing.R" class="external-link"><code>R/tsbalancing.R</code></a></small>
      <div class="d-none name"><code>tsbalancing.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><em>Réplication de la macro <em><strong>GSeriesTSBalancing</strong></em> de G-Séries 2.0 en SAS\(^\circledR\). Voir la documentation
de G-Séries 2.0 pour plus de détails (Statistique Canada 2016).</em></p>
<p>Cette fonction équilibre (réconcilie) un système de séries chronologiques selon un ensemble de contraintes linéaires.
La solution d'équilibrage (« <em>balancing</em> ») est obtenue en résolvant un ou plusieurs problèmes de minimisation quadratique
(voir la section <strong>Détails</strong>) avec le solveur OSQP (Stellato et al. 2020). Étant donné la faisabilité du (des) problème(s)
d'équilibrage, les données des séries chronologiques résultantes respectent les contraintes spécifiées pour chaque période.
Des contraintes linéaires d'égalité et d'inégalité sont permises. Optionnellement, la préservation des totaux temporels peut
également être spécifiée.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Utilisation<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tsbalancing</span><span class="op">(</span></span>
<span>  <span class="va">in_ts</span>,</span>
<span>  <span class="va">problem_specs_df</span>,</span>
<span>  temporal_grp_periodicity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  temporal_grp_start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  osqp_settings_df <span class="op">=</span> <span class="va">default_osqp_sequence</span>,</span>
<span>  display_level <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alter_pos <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alter_neg <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alter_mix <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alter_temporal <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lower_bound <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper_bound <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  tolV <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tolV_temporal <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tolP_temporal <span class="op">=</span> <span class="cn">NA</span>,</span>
<span></span>
<span>  <span class="co"># Nouveau dans G-Séries 3.0</span></span>
<span>  validation_tol <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  trunc_to_zero_tol <span class="op">=</span> <span class="va">validation_tol</span>,</span>
<span>  full_sequence <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  validation_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-in-ts">in_ts<a class="anchor" aria-label="anchor" href="#arg-in-ts"></a></dt>
<dd><p>(obligatoire)</p>
<p>Objet de type série chronologique (« ts » ou « mts »), ou objet compatible, qui contient les données des séries
chronologiques à réconcilier. Il s'agit des données d'entrée (solutions initiales) des problèmes d'équilibrage
(« <em>balancing</em> »).</p></dd>


<dt id="arg-problem-specs-df">problem_specs_df<a class="anchor" aria-label="anchor" href="#arg-problem-specs-df"></a></dt>
<dd><p>(obligatoire)</p>
<p><em>Data frame</em> des spécifications du problème d'équilibrage. En utilisant un format clairsemé (épars) inspiré de la
procédure LP de SAS/OR\(^\circledR\) (SAS Institute 2015), il ne contient que les informations pertinentes
telles que les coefficients non nuls des contraintes d'équilibrage ainsi que les coefficients d'altérabilité et les
bornes inférieures/supérieures à utiliser au lieu des valeurs par défaut (c.-à-d., les valeurs qui auraient la priorité
sur celles définies avec les arguments <code>alter_pos</code>, <code>alter_neg</code>, <code>alter_mix</code>, <code>alter_temporal</code>, <code>lower_bound</code> et
<code>upper_bound</code>).</p>
<p>Les informations sont fournies à l'aide de quatre variables obligatoires (<code>type</code>, <code>col</code>, <code>row</code> et <code>coef</code>) et d'une
variable facultative (<code>timeVal</code>). Un enregistrement (une rangée) dans le <em>data frame</em> des spécifications du problème
définit soit une étiquette pour l'un des sept types d'éléments du problème d'équilibrage avec les colonnes <code>type</code> et <code>row</code>
(voir <em>Enregistrements de définition d'étiquette</em> ci-dessous) ou bien spécifie des coefficients (valeurs numériques) pour
ces éléments du problème d'équilibrage avec les variables <code>col</code>, <code>row</code>, <code>coef</code> et <code>timeVal</code> (voir <em>Enregistrements de
spécification d'information</em> ci-dessous).</p><ul><li><p><strong>Enregistrements de définition d'étiquette</strong> (<code>type</code> n'est pas manquant (n'est pas <code>NA</code>))</p><ul><li><p><code>type</code> (car) : mot-clé réservé identifiant le type d'élément du problème en cours de définition :</p><ul><li><p><code>EQ</code> : contrainte d'équilibrage d'égalité (\(=\))</p></li>
<li><p><code>LE</code> : contrainte d'équilibrage d'inégalité de type inférieure ou égale (\(\le\))</p></li>
<li><p><code>GE</code> : contrainte d'équilibrage d'inégalité de type supérieure ou égale (\(\ge\))</p></li>
<li><p><code>lowerBd</code> : borne inférieure des valeurs de période</p></li>
<li><p><code>upperBd</code> : borne supérieure des valeurs de période</p></li>
<li><p><code>alter</code> : coefficient d'altérabilité des valeurs de période</p></li>
<li><p><code>alterTmp</code> : coefficient d'altérabilité des totaux temporels</p></li>
</ul></li>
<li><p><code>row</code> (car) : étiquette à associer à l'élément du problème (<em>mot-clé <code>type</code></em>)</p></li>
<li><p><em>toutes les autres variables ne sont pas pertinentes et devraient contenir des données manquantes (valeurs <code>NA</code>)</em> <br><br></p></li>
</ul></li>
<li><p><strong>Enregistrements de spécification d'information</strong> (<code>type</code> est manquant (est <code>NA</code>))</p><ul><li><p><code>type</code> (car) : non applicable (<code>NA</code>)</p></li>
<li><p><code>col</code> (car) : nom de la série ou mot réservé <code>_rhs_</code> pour spécifier la valeur du côté droit (<em>RHS</em> pour
<em><strong>R</strong>ight-<strong>H</strong>and <strong>S</strong>ide</em>)
d'une contrainte d'équilibrage.</p></li>
<li><p><code>row</code> (car) : étiquette de l'élément du problème.</p></li>
<li><p><code>coef</code> (num) : valeur de l'élément du problème :</p><ul><li><p>coefficient de la série dans la contrainte d'équilibrage ou valeur <em>RHS</em></p></li>
<li><p>borne inférieure ou supérieure des valeurs de période de la série</p></li>
<li><p>coefficient d'altérabilité des valeurs de période ou des totaux temporels de la série</p></li>
</ul></li>
<li><p><code>timeVal</code> (num) : valeur de temps optionnelle pour restreindre l'application des bornes ou coefficients
d'altérabilité des séries à une période (ou groupe temporel) spécifique. Elle correspond à la valeur de temps,
telle que renvoyée par <code><a href="https://rdrr.io/r/stats/time.html" class="external-link">stats::time()</a></code>, pour une période (observation) donnée des séries chronologiques d'entrée
(argument <code>in_ts</code>) et correspond conceptuellement à \(ann\acute{e}e + (p\acute{e}riode - 1) / fr\acute{e}quence\).</p></li>
</ul></li>
</ul><p>Notez que les chaînes de caractères vides (<code>""</code> ou <code>''</code>) pour les variables de type caractère sont interprétées comme
manquantes (<code>NA</code>) par la fonction. La variable <code>row</code> identifie les éléments du problème d'équilibrage et est la variable
clé qui fait le lien entre les deux types d'enregistrements. La même étiquette (<code>row</code>) ne peut être associée à plus d'un
type d'éléments du problème (<code>type</code>) et plusieurs étiquettes (<code>row</code>) ne peuvent pas être définies pour un même type
d'éléments du problème donné (<code>type</code>), à l'exception des contraintes d'équilibrage (valeurs <code>"EQ"</code>, <code>"LE"</code> et <code>"GE"</code> de
la colonne <code>type</code>). Voici certaines caractéristiques conviviales du <em>data frame</em> des spécifications du problème :</p><ul><li><p>L'ordre des enregistrements (rangées) n'est pas important.</p></li>
<li><p>Les valeurs des variables de type caractère (<code>type</code>, <code>row</code> et <code>col</code>) ne sont pas sensibles à la casse (ex., les chaînes de
caractères <code>"Constraint 1"</code> et <code>"CONSTRAINT 1"</code> pour la variable <code>row</code> seraient considérées comme une même étiquette d'élément
du problème), sauf lorsque <code>col</code> est utilisé pour spécifier un nom de série (une colonne de l'objet d'entrée de type série
chronologique) où <strong>la sensibilité à la casse est appliquée</strong>.</p></li>
<li><p>Les noms des variables du <em>data frame</em> des spécifications du problème ne sont pas non plus sensibles à la casse (ex.,
<code>type</code>, <code>Type</code> ou <code>TYPE</code> sont tous des noms de variable valides) et <code>time_val</code> est un nom de variable accepté (au lieu de
<code>timeVal</code>).</p></li>
</ul><p>Enfin, le tableau suivant dresse la liste des alias valides (acceptés) pour les <em>mots-clés <code>type</code></em>
(type d'éléments du problème) :</p><table class="table table"><tr><td><strong>Mot-clé</strong></td><td><strong>Alias</strong></td></tr><tr><td><code>EQ</code></td><td><code>==</code>, <code>=</code></td></tr><tr><td><code>LE</code></td><td><code>&lt;=</code>, <code>&lt;</code></td></tr><tr><td><code>GE</code></td><td><code>&gt;=</code>, <code>&gt;</code></td></tr><tr><td><code>lowerBd</code></td><td><code>lowerBound</code>, <code>lowerBnd</code>, + <em>mêmes termes avec '_', '.' ou ' ' entre les mots</em></td></tr><tr><td><code>upperBd</code></td><td><code>upperBound</code>, <code>upperBnd</code>, + <em>mêmes termes avec '_', '.' ou ' ' entre les mots</em></td></tr><tr><td><code>alterTmp</code></td><td><code>alterTemporal</code>, <code>alterTemp</code>, + <em>mêmes termes avec '_', '.' ou ' ' entre les mots</em></td></tr></table><p>L'examen des <strong>Exemples</strong> devrait aider à conceptualiser le <em>data frame</em> des spécifications du problème d'équilibrage.</p></dd>


<dt id="arg-temporal-grp-periodicity">temporal_grp_periodicity<a class="anchor" aria-label="anchor" href="#arg-temporal-grp-periodicity"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre entier positif définissant le nombre de périodes dans les groupes temporels pour lesquels les totaux doivent
être préservés. Par exemple, spécifiez <code>temporal_grp_periodicity = 3</code> avec des séries chronologiques mensuelles pour la
préservation des totaux trimestriels et <code>temporal_grp_periodicity = 12</code> (ou <code>temporal_grp_periodicity = frequency(in_ts)</code>)
pour la préservation des totaux annuels. Spécifier <code>temporal_grp_periodicity = 1</code> (<em>défaut</em>) correspond à un traitement
période par période sans préservation des totaux temporels.</p>
<p><strong>La valeur par défaut</strong> est <code>temporal_grp_periodicity = 1</code> (traitement période par période sans préservation des
totaux temporels).</p></dd>


<dt id="arg-temporal-grp-start">temporal_grp_start<a class="anchor" aria-label="anchor" href="#arg-temporal-grp-start"></a></dt>
<dd><p>(optionnel)</p>
<p>Entier dans l'intervalle [1 .. <code>temporal_grp_periodicity</code>] spécifiant la période (cycle) de départ pour la préservation
des totaux temporels. Par exemple, des totaux annuels correspondant aux années financières définies d'avril à mars de l'année
suivante seraient spécifiés avec <code>temporal_grp_start = 4</code> pour des séries chronologiques mensuelles (<code>frequency(in_ts) = 12</code>)
et <code>temporal_grp_start = 2</code> pour des séries chronologiques trimestrielles (<code>frequency(in_ts) = 4</code>). Cet argument n'a pas
d'effet pour un traitement période par période sans préservation des totaux temporels (<code>temporal_grp_periodicity = 1</code>).</p>
<p><strong>La valeur par défaut</strong> est <code>temporal_grp_start = 1</code>.</p></dd>


<dt id="arg-osqp-settings-df">osqp_settings_df<a class="anchor" aria-label="anchor" href="#arg-osqp-settings-df"></a></dt>
<dd><p>(optionnel)</p>
<p><em>Data frame</em> contenant une séquence de paramètres d'OSQP pour la résolution des problèmes d'équilibrage. La librairie
inclut deux <em>data frames</em> prédéfinis de séquences de paramètres d'OSQP :</p><ul><li><p><a href="osqp_settings_sequence.html">default_osqp_sequence</a> : rapide et efficace (par défaut);</p></li>
<li><p><a href="osqp_settings_sequence.html">alternate_osqp_sequence</a> : orienté vers la précision au détriment du temps d'exécution.</p></li>
</ul><p>Voir la <code><a href="../articles/osqp-settings-sequence-dataframe.html">vignette("osqp-settings-sequence-dataframe")</a></code> pour plus de détails sur ce sujet et pour voir le contenu de ces
deux <em>data frames</em>. Notez que le concept d'une <em>séquence de résolution</em> avec différents ensembles de paramètres pour
le solveur est nouveau dans G-Séries 3.0 (une seule tentative de résolution était effectuée dans G-Séries 2.0).</p>
<p><strong>La valeur par défaut</strong> est <code>osqp_settings_df = default_osqp_sequence</code>.</p></dd>


<dt id="arg-display-level">display_level<a class="anchor" aria-label="anchor" href="#arg-display-level"></a></dt>
<dd><p>(optionnel)</p>
<p>Entier dans l'intervalle [0 .. 3] spécifiant le niveau d'information à afficher dans la console (<code><a href="https://rdrr.io/r/base/showConnections.html" class="external-link">stdout()</a></code>).
Notez que spécifier l'argument <code>quiet = TRUE</code> annulerait l'argument <code>display_level</code> (aucune des informations suivantes
ne serait affichée).</p><table class="table table"><tr><td><strong>Information affichée</strong></td><td><strong><code>0</code></strong></td><td><strong><code>1</code></strong></td><td><strong><code>2</code></strong></td><td><strong><code>3</code></strong></td></tr><tr><td>En-tête de la fonction</td><td>\(\checkmark\)</td><td>\(\checkmark\)</td><td>\(\checkmark\)</td><td>\(\checkmark\)</td></tr><tr><td>Éléments du problème d'équilibrage</td><td></td><td>\(\checkmark\)</td><td>\(\checkmark\)</td><td>\(\checkmark\)</td></tr><tr><td>Détails de résolution de chaque problème</td><td></td><td></td><td>\(\checkmark\)</td><td>\(\checkmark\)</td></tr><tr><td>Résultats de chaque problème (valeurs et contraintes)</td><td></td><td></td><td></td><td>\(\checkmark\)</td></tr></table><p><strong>La valeur par défaut</strong> est <code>display_level = 1</code>.</p></dd>


<dt id="arg-alter-pos">alter_pos<a class="anchor" aria-label="anchor" href="#arg-alter-pos"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif spécifiant le coefficient d'altérabilité par défaut associé aux valeurs des séries chronologiques
avec des coefficients <strong>positifs</strong> dans toutes les contraintes d'équilibrage dans lesquelles elles sont impliquées (ex.,
les séries composantes dans les problèmes de ratissage (« <em>raking</em> ») de tables d'agrégation). Les coefficients
d'altérabilité fournis dans le <em>data frame</em> des spécifications du problème (argument <code>problem_specs_df</code>) remplacent cette
valeur.</p>
<p><strong>La valeur par défaut</strong> est <code>alter_pos = 1.0</code> (valeurs non contraignantes).</p></dd>


<dt id="arg-alter-neg">alter_neg<a class="anchor" aria-label="anchor" href="#arg-alter-neg"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif spécifiant le coefficient d'altérabilité par défaut associé aux valeurs des séries chronologiques
avec des coefficients <strong>négatifs</strong> dans toutes les contraintes d'équilibrage dans lesquelles elles sont impliquées (ex.,
les séries de total de marge dans les problèmes de ratissage (« <em>raking</em> ») de tables d'agrégation). Les coefficients
d'altérabilité fournis dans le <em>data frame</em> des spécifications du problème (argument <code>problem_specs_df</code>) remplacent cette
valeur.</p>
<p><strong>La valeur par défaut</strong> est <code>alter_neg = 1.0</code> (valeurs non contraignantes).</p></dd>


<dt id="arg-alter-mix">alter_mix<a class="anchor" aria-label="anchor" href="#arg-alter-mix"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif spécifiant le coefficient d'altérabilité par défaut associé aux valeurs des séries chronologiques
avec un mélange de coefficients <strong>positifs et négatifs</strong> dans les contraintes d'équilibrage dans lesquelles elles sont
impliquées. Les coefficients d'altérabilité fournis dans le <em>data frame</em> des spécifications du problème (argument
<code>problem_specs_df</code>) remplacent cette valeur.</p>
<p><strong>La valeur par défaut</strong> est <code>alter_mix = 1.0</code> (valeurs non contraignantes).</p></dd>


<dt id="arg-alter-temporal">alter_temporal<a class="anchor" aria-label="anchor" href="#arg-alter-temporal"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif spécifiant le coefficient d'altérabilité par défaut associé aux totaux temporels des séries
chronologiques. Les coefficients d'altérabilité fournis dans le <em>data frame</em> des spécifications du problème (argument
<code>problem_specs_df</code>) remplacent cette valeur.</p>
<p><strong>La valeur par défaut</strong> est <code>alter_temporal = 0.0</code> (valeurs contraignantes).</p></dd>


<dt id="arg-lower-bound">lower_bound<a class="anchor" aria-label="anchor" href="#arg-lower-bound"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel spécifiant la borne inférieure par défaut pour les valeurs des séries chronologiques. Les bornes inférieures
fournies dans le <em>data frame</em> des spécifications du problème (argument <code>problem_specs_df</code>) remplacent cette valeur.</p>
<p><strong>La valeur par défaut</strong> est <code>lower_bound = -Inf</code> (non borné).</p></dd>


<dt id="arg-upper-bound">upper_bound<a class="anchor" aria-label="anchor" href="#arg-upper-bound"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel spécifiant la borne supérieure par défaut pour les valeurs des séries chronologiques. Les bornes supérieures
fournies dans le <em>data frame</em> des spécifications du problème (argument <code>problem_specs_df</code>) remplacent cette valeur.</p>
<p><strong>La valeur par défaut</strong> est <code>upper_bound = Inf</code> (non borné).</p></dd>


<dt id="arg-tolv">tolV<a class="anchor" aria-label="anchor" href="#arg-tolv"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif spécifiant la tolérance, en valeur absolue, de la valeur du côté droit (<em>RHS</em>) des contraintes
d'équilibrage :</p><ul><li><p>Contraintes <code>EQ</code> : \(\quad A\mathbf{x} = \mathbf{b} \quad\) devient \(\quad \mathbf{b} - \epsilon \le
A\mathbf{x} \le \mathbf{b} + \epsilon\)</p></li>
<li><p>Contraintes <code>LE</code> : \(\quad A\mathbf{x} \le \mathbf{b} \quad\) devient \(\quad A\mathbf{x} \le
\mathbf{b} + \epsilon\)</p></li>
<li><p>Contraintes <code>GE</code> : \(\quad A\mathbf{x} \ge \mathbf{b} \quad\) devient \(\quad A\mathbf{x} \ge
\mathbf{b} - \epsilon\)</p></li>
</ul><p>où \(\epsilon\) est la tolérance spécifiée avec <code>tolV</code>. Cet argument ne s'applique pas aux <em>bornes (inférieures et
supérieures) des valeurs de période</em> spécifiées avec les arguments <code>lower_bound</code> et <code>upper_bound</code> ou dans le <em>data frame</em>
des spécifications du problème (argument <code>prob_specs_df</code>). Autrement dit, <code>tolV</code> n'affecte pas les bornes inférieure et
supérieure des valeurs des séries chronologiques, à moins qu'elles ne soient spécifiées comme <em>contraintes d'équilibrage</em>
à la place (avec des contraintes <code>GE</code> et <code>LE</code> dans le <em>data frame</em> des spécifications du problème).</p>
<p><strong>La valeur par défaut</strong> est <code>tolV = 0.0</code> (pas de tolérance).</p></dd>


<dt id="arg-tolv-temporal-tolp-temporal">tolV_temporal, tolP_temporal<a class="anchor" aria-label="anchor" href="#arg-tolv-temporal-tolp-temporal"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif, ou <code>NA</code>, spécifiant la tolérance, en pourcentage (<code>tolP_temporal</code>) ou en valeur absolue
(<code>tolV_temporal</code>), pour les contraintes implicites d'agrégation temporelle associées aux <strong>totaux temporels contraignants</strong>
\(\left( \sum_t{x_{i,t}} = \sum_t{y_{i,t}} \right)\), qui deviennent :
$$\sum_t{y_{i,t}} - \epsilon_\text{abs} \le \sum_t{x_{i,t}} \le \sum_t{y_{i,t}} + \epsilon_\text{abs}$$
ou
$$\sum_t{y_{i,t}} \left( 1 - \epsilon_\text{rel} \right) \le \sum_t{x_{i,t}} \le \sum_t{y_{i,t}} \left( 1 +
\epsilon_\text{rel} \right)$$</p>
<p>où \(\epsilon_\text{abs}\) et \(\epsilon_\text{rel}\) sont les tolérances absolues et en pourcentage
spécifiées respectivement avec <code>tolV_temporal</code> et <code>tolP_temporal</code>. Les deux arguments ne peuvent pas être spécifiés tous
les deux à la fois (l'un doit être spécifié tandis que l'autre doit être <code>NA</code>).</p>
<p><strong>Exemple :</strong> pour une tolérance de 10 <em>unités</em>, spécifiez <code>tolV_temporal = 10, tolP_temporal = NA</code>; pour une tolérance
de 1%, spécifiez <code>tolV_temporal = NA, tolP_temporal = 0.01</code>.</p>
<p><strong>Les valeurs par défaut</strong> sont <code>tolV_temporal = 0.0</code> et <code>tolP_temporal = NA</code> (pas de tolérance).</p></dd>


<dt id="arg-validation-tol">validation_tol<a class="anchor" aria-label="anchor" href="#arg-validation-tol"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif spécifiant la tolérance pour la validation des résultats d'équilibrage. La fonction vérifie si
les valeurs finales des séries chronologiques (réconciliées) satisfont les contraintes, en autorisant des écarts jusqu'à
la valeur spécifiée avec cet argument. Un avertissement est émis dès qu'une contrainte n'est pas respectée (écart
supérieur à <code>validation_tol</code>).</p>
<p>Avec des contraintes définies comme \(\mathbf{l} \le A\mathbf{x} \le \mathbf{u}\), où \(\mathbf{l =
u}\) pour les contraintes <code>EQ</code>, \(\mathbf{l} = -\infty\) pour les contraintes <code>LE</code> et \(\mathbf{u} =
\infty\) pour les contraintes <code>GE</code>, <strong>les écarts de contraintes</strong> correspondent à \(\max \left( 0, \mathbf{l} -
A\mathbf{x}, A\mathbf{x} - \mathbf{u} \right)\), où les bornes de contraintes \(\mathbf{l}\)
et \(\mathbf{u}\) incluent les tolérances, le cas échéant, spécifiées avec les arguments <code>tolV</code>, <code>tolV_temporal</code> et
<code>tolP_temporal</code>.</p>
<p><strong>La valeur par défaut</strong> est <code>validation_tol = 0.001</code>.</p></dd>


<dt id="arg-trunc-to-zero-tol">trunc_to_zero_tol<a class="anchor" aria-label="anchor" href="#arg-trunc-to-zero-tol"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif spécifiant la tolérance, en valeur absolue, pour le remplacement par zéro de (petites) valeurs
dans les données (réconciliées) de séries chronologiques de sortie (objet de sortie <code>out_ts</code>). Spécifiez
<code>trunc_to_zero_tol = 0</code> pour désactiver ce processus de <em>troncation à zéro</em> des données réconciliées. Sinon, spécifiez
<code>trunc_to_zero_tol &gt; 0</code> pour remplacer par \(0.0\) toute valeur dans l'intervalle \(\left[ -\epsilon, \epsilon
\right]\), où \(\epsilon\) est la tolérance spécifiée avec <code>trunc_to_zero_tol</code>.</p>
<p>Notez que les écarts de contraintes finaux (voir l'argument <code>validation_tol</code>) sont calculées sur les séries
chronologiques réconciliées <em>tronquées à zéro</em>, ce qui garantit une validation précise des données réconciliées
réelles renvoyées par la fonction.</p>
<p><strong>La valeur par défaut</strong> est <code>trunc_to_zero_tol = validation_tol</code>.</p></dd>


<dt id="arg-full-sequence">full_sequence<a class="anchor" aria-label="anchor" href="#arg-full-sequence"></a></dt>
<dd><p>(optionnel)</p>
<p>Argument logique (<em>logical</em>) spécifiant si toutes les étapes du <em>data frame pour la séquence de paramètres d'OSQP</em>
doivent être exécutées ou non.  Voir l'argument <code>osqp_settings_df</code> et la <code><a href="../articles/osqp-settings-sequence-dataframe.html">vignette("osqp-settings-sequence-dataframe")</a></code>
pour plus de détails sur ce sujet.</p>
<p><strong>La valeur par défaut</strong> est <code>full_sequence = FALSE</code>.</p></dd>


<dt id="arg-validation-only">validation_only<a class="anchor" aria-label="anchor" href="#arg-validation-only"></a></dt>
<dd><p>(optionnel)</p>
<p>Argument logique (<em>logical</em>) spécifiant si la fonction doit uniquement effectuer la validation des données d'entrée ou
non. Lorsque <code>validation_only = TRUE</code>, les <em>contraintes d'équilibrage</em> et les <em>bornes (inférieures et supérieures) des
valeurs de période</em> spécifiées sont validées par rapport aux données de séries chronologiques d'entrée, en permettant
des écarts jusqu'à la valeur spécifiée avec l'argument <code>validation_tol</code>. Sinon, lorsque <code>validation_only = FALSE</code>
(par défaut), les données d'entrée sont d'abord réconciliées et les données résultantes (en sortie) sont ensuite
validées.</p>
<p><strong>La valeur par défaut</strong> est <code>validation_only = FALSE</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>(optionnel)</p>
<p>Argument logique (<em>logical</em>) spécifiant s'il faut ou non afficher uniquement les informations essentielles telles que
les avertissements, les erreurs et la période (ou l'ensemble de périodes) en cours de traitement. Vous pouvez également
supprimer, si vous le souhaitez, l'affichage des informations relatives à la (aux) période(s) en cours de traitement en
<em>enveloppant</em> votre appel à <code>tsbalancing()</code> avec <code><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages()</a></code>. Dans ce cas, le <em>data frame</em> de sortie
<strong>proc_grp_df</strong> peut être utilisé pour identifier les problèmes d'équilibrage (infructueux) associés aux messages
d'avertissement (le cas échéant). Notez que la spécification de <code>quiet = TRUE</code> annulera également l'argument <code>display_level</code>.</p>
<p><strong>La valeur par défaut</strong> est <code>quiet = FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="valeur-de-retour">Valeur de retour<a class="anchor" aria-label="anchor" href="#valeur-de-retour"></a></h2>
    <p>La fonction renvoie une liste de sept objets :</p><ul><li><p><strong>out_ts</strong> : version modifiée de l'objet d'entrée de type série chronologique (« ts » ou « mts »; voir l'argument <code>in_ts</code>)
contenant les valeurs réconciliées des séries chronologiques qui résultent de l'exécution de la fonction (sortie
principale de la fonction). Il peut être explicitement converti en un autre type d'objet avec la fonction <code>as*()</code>
appropriée (ex., <code><a href="https://tsibble.tidyverts.org/reference/as-tsibble.html" class="external-link">tsibble::as_tsibble()</a></code> le convertirait en tsibble).</p></li>
<li><p><strong>proc_grp_df</strong> : <em>data frame</em> récapitulatif des groupes de traitement, utile pour identifier les problèmes
fructueux ou infructueux. Il contient un enregistrement (une rangée) pour chaque problème d'équilibrage avec les
colonnes suivantes :</p><ul><li><p><code>proc_grp</code> (num) : identificateur du groupe de traitement.</p></li>
<li><p><code>proc_grp_type</code> (car) : type de groupe de traitement. Les valeurs possibles sont :</p><ul><li><p><code>"period"</code> (périodes uniques);</p></li>
<li><p><code>"temporal group"</code> (groupes temporels).</p></li>
</ul></li>
<li><p><code>proc_grp_label</code> (car) : chaîne de caractères décrivant le groupe de traitement dans le format suivant :</p><ul><li><p><code>"&lt;year&gt;-&lt;period&gt;"</code> (périodes uniques)</p></li>
<li><p><code>"&lt;start year&gt;-&lt;start period&gt; - &lt;end year&gt;-&lt;end period&gt;"</code> (groupes temporels)</p></li>
</ul></li>
<li><p><code>sol_status_val</code>, <code>sol_status</code> (num, car) : valeur numérique (entière) et chaîne de caractères associés au
statut de la solution :</p><ul><li><p><code> 1</code> : <code>"valid initial solution"</code> (solution initiale valide);</p></li>
<li><p><code>-1</code> : <code>"invalid initial solution"</code> (solution initiale invalide);</p></li>
<li><p><code> 2</code> : <code>"valid polished osqp solution"</code> (solution OSQP <em>raffinée</em> valide);</p></li>
<li><p><code>-2</code> : <code>"invalid polished osqp solution"</code> (solution OSQP <em>raffinée</em> invalide);</p></li>
<li><p><code> 3</code> : <code>"valid unpolished osqp solution"</code> (solution OSQP <em>non raffinée</em> valide);</p></li>
<li><p><code>-3</code> : <code>"invalid unpolished osqp solution"</code> (solution OSQP <em>non raffinée</em> invalide);</p></li>
<li><p><code>-4</code> : <code>"unsolvable fixed problem"</code> (problème fixe insoluble, avec solution initiale invalide).</p></li>
</ul></li>
<li><p><code>n_unmet_con</code> (num) : nombre de contraintes non satisfaites (<code>sum(prob_conf_df$unmet_flag)</code>).</p></li>
<li><p><code>max_discr</code> (num) : écart de contrainte maximal (<code>max(prob_conf_df$discr_out)</code>).</p></li>
<li><p><code>validation_tol</code> (num) : tolérance spécifiée à des fins de validation (argument <code>validation_tol</code>).</p></li>
<li><p><code>sol_type</code> (car) : type de solution renvoyée. Les valeurs possibles sont :</p><ul><li><p><code>"initial"</code> (solution initiale, c.-à-d., les valeurs des données d'entrée);</p></li>
<li><p><code>"osqp"</code> (solution OSQP).</p></li>
</ul></li>
<li><p><code>osqp_attempts</code> (num) : nombre de tentatives effectuées avec OSQP (profondeur atteinte dans la séquence
de résolution).</p></li>
<li><p><code>osqp_seqno</code> (num) : numéro d'étape de la séquence de résolution correspondant à la solution renvoyée.
<code>NA</code> lorsque <code>sol_type = "initial"</code>.</p></li>
<li><p><code>osqp_status</code> (car) : chaîne de caractères décrivant le statut OSQP (<code>osqp_sol_info_df$status</code>). <code>NA</code> lorsque
<code>sol_type = "initial"</code>.</p></li>
<li><p><code>osqp_polished</code> (logi) : <code>TRUE</code> si la solution OSQP renvoyée est <em>raffinée</em> (<code>osqp_sol_info_df$status_polish = 1</code>), <code>FALSE</code> sinon.
<code>NA</code> lorsque <code>sol_type = "initial"</code>.</p></li>
<li><p><code>total_solve_time</code> (num) : temps total, en secondes, de la séquence de résolution.</p></li>
</ul><p>La colonne <code>proc_grp</code> constitue une <em>clé unique</em> (enregistrements distincts) pour le <em>data frame</em>. Les problèmes
d'équilibrage fructueux (problèmes avec une solution valide) correspondent aux enregistrements avec
<code>sol_status_val &gt; 0</code> ou, de manière équivalente, à <code>n_unmet_con = 0</code> ou à <code>max_discr &lt;= validation_tol</code>. La
<em>solution initiale</em> (<code>sol_type = "initial"</code>) n'est renvoyée que si <strong>a)</strong> il n'y a pas de d'écarts de contraintes
initiaux, <strong>b)</strong> le problème est fixé (toutes les valeurs sont contraignantes) ou <strong>c)</strong> elle est meilleure que la
solution OSQP (total des écarts de contraintes plus faible). La séquence de résolution est décrite dans la
<code><a href="../articles/osqp-settings-sequence-dataframe.html">vignette("osqp-settings-sequence-dataframe")</a></code>.</p></li>
<li><p><strong>periods_df</strong> : <em>data frame</em> sur les périodes de temps, utile pour faire correspondre les périodes aux groupes
de traitement. Il contient un enregistrement (une rangée) pour chaque période de l'objet d'entrée de type série
chronologique (argument <code>in_ts</code>) avec les colonnes suivantes :</p><ul><li><p><code>proc_grp</code> (num) : identificateur du groupe de traitement.</p></li>
<li><p><code>t</code> (num) : identificateur de la période (<code>1:nrow(in_ts)</code>).</p></li>
<li><p><code>time_val</code> (num) : valeur de temps (<code>stats::time(in_ts)</code>). Correspond conceptuellement à \(ann\acute{e}e +
  (p\acute{e}riode - 1) / fr\acute{e}quence\).</p></li>
</ul><p>Les colonnes <code>t</code> et <code>time_val</code> constituent toutes deux une <em>clé unique</em> (enregistrements distincts) pour le
<em>data frame</em>.</p></li>
<li><p><strong>prob_val_df</strong> : <em>data frame</em> sur les valeurs du problème, utile pour analyser les changements entre les valeurs
initiales et finales (réconciliées). Il contient un enregistrement (une rangée) pour chaque valeur impliquée dans
chaque problème d'équilibrage, avec les colonnes suivantes :</p><ul><li><p><code>proc_grp</code> (num) : identificateur du groupe de traitement.</p></li>
<li><p><code>val_type</code> (car) : type de valeur du problème. Les valeurs possibles sont :</p><ul><li><p><code>"period value"</code> (valeur de période);</p></li>
<li><p><code>"temporal total"</code> (total temporel).</p></li>
</ul></li>
<li><p><code>name</code> (car) : nom de la série chronologique (variable).</p></li>
<li><p><code>t</code> (num) : identificateur de la période (<code>1:nrow(in_ts)</code>); identificateur de la première période du groupe
temporel pour un <em>total temporel</em>.</p></li>
<li><p><code>time_val</code> (num) : valeur de temps (<code>stats::time(in_ts)</code>); valeur de la première période du groupe temporel
pour un <em>total temporel</em>. Correspond conceptuellement à \(ann\acute{e}e + (p\acute{e}riode - 1) / fr\acute{e}quence\).</p></li>
<li><p><code>lower_bd</code>, <code>upper_bd</code> (num) : bornes des valeurs de période; toujours <code>-Inf</code> et <code>Inf</code> pour un <em>total temporel</em>.</p></li>
<li><p><code>alter</code> (num) : coefficient d'altérabilité.</p></li>
<li><p><code>value_in</code>, <code>value_out</code> (num) : valeurs initiales et finales (réconciliées).</p></li>
<li><p><code>dif</code> (num) : <code>value_out - value_in</code>.</p></li>
<li><p><code>rdif</code> (num) : <code>dif / value_in</code>; <code>NA</code> si <code>value_in = 0</code>.</p></li>
</ul><p>Les colonnes <code>val_type + name + t</code> et <code>val_type + name + time_val</code> constituent toutes deux une <em>clé unique</em>
(enregistrements distincts) pour le <em>data frame</em>. Les valeurs contraignantes (fixes) des problèmes correspondent aux
enregistrements avec <code>alter = 0</code> ou <code>value_in = 0</code>. Inversement, les valeurs de problèmes non contraignantes (libres)
correspondent aux enregistrements avec <code>alter != 0</code> et <code>value_in != 0</code>.</p></li>
<li><p><strong>prob_con_df</strong> : <em>data frame</em> sur les contraintes du problème, utile pour dépanner les problèmes infructueux (identifier
les contraintes non satisfaites). Il contient un enregistrement (une rangée) pour chaque contrainte impliquée dans chaque
problème d'équilibrage, avec les colonnes suivantes :</p><ul><li><p><code>proc_grp</code> (num) : identificateur du groupe de traitement.</p></li>
<li><p><code>con_type</code> (car) : type de contrainte. Les valeurs possibles sont :</p><ul><li><p><code>"balancing constraint"</code> (contrainte d'équilibrage);</p></li>
<li><p><code>"temporal aggregation constraint"</code> (contrainte d'agrégation temporelle);</p></li>
<li><p><code>"period value bounds"</code> (bornes de valeur de période).</p></li>
</ul><p>Alors que les <em>contraintes d'équilibrage</em> sont spécifiées par l'utilisateur, les deux autres types de contraintes
(<em>contraintes d'agrégation temporelle</em> et <em>bornes de valeur de période</em>) sont automatiquement ajoutées au problème
par la fonction (le cas échéant).</p></li>
<li><p><code>name</code> (car) : étiquette de la contrainte ou nom de la série chronologique (variable).</p></li>
<li><p><code>t</code> (num) : identificateur de la période (<code>1:nrow(in_ts)</code>); identificateur de la première période du groupe
temporel pour une <em>contrainte d'agrégation temporelle</em>.</p></li>
<li><p><code>time_val</code> (num) : valeur de temps (<code>stats::time(in_ts)</code>); valeur de la première période du groupe temporel
pour une <em>contrainte d'agrégation temporelle</em>. Correspond conceptuellement à \(ann\acute{e}e + (p\acute{e}riode - 1)
  / fr\acute{e}quence\).</p></li>
<li><p><code>l</code>, <code>u</code>, <code>Ax_in</code>, <code>Ax_out</code> (num) : éléments de contrainte initiaux et finaux \(\left( \mathbf{l} \le A \mathbf{x}
  \le \mathbf{u} \right)\).</p></li>
<li><p><code>discr_in</code>, <code>discr_out</code> (num) : écarts de contrainte initiaux et finaux \(\left( \max \left( 0, \mathbf{l} - A
  \mathbf{x}, A \mathbf{x} - \mathbf{u} \right) \right)\).</p></li>
<li><p><code>validation_tol</code> (num) : tolérance spécifiée à des fins de validation (argument <code>validation_tol</code>).</p></li>
<li><p><code>unmet_flag</code> (logi) : <code>TRUE</code> si la contrainte n'est pas satisfaite (<code>discr_out &gt; validation_tol</code>), <code>FALSE</code> sinon.</p></li>
</ul><p>Les colonnes <code>con_type + name + t</code> et <code>con_type + name + time_val</code> constituent toutes deux une <em>clé unique</em>
(enregistrements distincts) pour le <em>data frame</em>. Les bornes de contrainte \(\mathbf{l = u}\) pour des
contraintes <code>EQ</code>, \(\mathbf{l} = -\infty\) pour des contraintes <code>LE</code>, \(\mathbf{u} = \infty\)
pour des contraintes <code>GE</code>, et incluent les tolérances, le cas échéant, spécifiées avec les arguments <code>tolV</code>,
<code>tolV_temporal</code> et <code>tolP_temporal</code>.</p></li>
<li><p><strong>osqp_settings_df</strong> : <em>data frame</em> des paramètres d'OSQP. Il contient un enregistrement (une rangée) pour chaque
problème (groupe de traitement) résolu avec OSQP (<code>proc_grp_df$sol_type = "osqp"</code>), avec les colonnes suivantes :</p><ul><li><p><code>proc_grp</code> (num) : identificateur du groupe de traitement.</p></li>
<li><p>une colonne correspondant à chaque élément de la liste renvoyée par la méthode <code>osqp::GetParams()</code> appliquée à un <em>objet solveur d'OSQP</em> (objet de classe « osqp_model » tel que renvoyé par
<code><a href="https://rdrr.io/pkg/osqp/man/osqp.html" class="external-link">osqp::osqp()</a></code>), ex. :</p><ul><li><p>Nombre maximal d'itérations (<code>max_iter</code>);</p></li>
<li><p>Tolérances d'infaisabilité primale et duale (<code>eps_prim_inf</code> et <code>eps_dual_inf</code>);</p></li>
<li><p>Drapeau d'exécution de l'étape de raffinement de la solution (<code>polish</code>);</p></li>
<li><p>Nombre d'itérations de mise à l'échelle (<code>scaling</code>);</p></li>
<li><p>etc.</p></li>
</ul></li>
<li><p>paramètres supplémentaires spécifiques à <code>tsbalancing()</code> :</p><ul><li><p><code>prior_scaling</code> (logi) : <code>TRUE</code> si les données du problème ont été mises à l'échelle (en utilisant la moyenne des
valeurs libres (non contraignantes) du problème comme facteur d'échelle) avant la résolution avec OSQP, <code>FALSE</code> sinon.</p></li>
<li><p><code>require_polished</code> (logi) : <code>TRUE</code> si une solution <em>raffinée</em> d'OSQP (<code>osqp_sol_info_df$status_polish = 1</code>) était nécessaire pour cette
étape afin de terminer la séquence de résolution, <code>FALSE</code> sinon. Voir la <code><a href="../articles/osqp-settings-sequence-dataframe.html">vignette("osqp-settings-sequence-dataframe")</a></code>
pour plus de détails sur la séquence de résolution utilisée par <code>tsbalancing()</code>.</p></li>
</ul></li>
</ul><p>La colonne <code>proc_grp</code> constitue une <em>clé unique</em> (enregistrements distincts) pour le <em>data frame</em>. Visitez le site
<a href="https://osqp.org/docs/interfaces/solver_settings.html" class="external-link">https://osqp.org/docs/interfaces/solver_settings.html</a> pour tous les paramètres d'OSQP disponibles. Les problèmes
(groupes de traitement) pour lesquels la solution initiale a été renvoyée (<code>proc_grp_df$sol_type = "initial"</code>) ne sont
pas inclus dans ce <em>data frame</em>.</p></li>
<li><p><strong>osqp_sol_info_df</strong> : <em>data frame</em> d'informations sur les solutions OSQP. Il contient un enregistrement (une rangée)
pour chaque problème (groupe de traitement) résolu avec OSQP (<code>proc_grp_df$sol_type = "osqp"</code>), avec les colonnes suivantes :</p><ul><li><p><code>proc_grp</code> (num) : identificateur du groupe de traitement.</p></li>
<li><p>une colonne correspondant à chaque élément de la liste <code>info</code> d'un <em>objet solveur d'OSQP</em> (objet de classe
« osqp_model » tel que renvoyé par <code><a href="https://rdrr.io/pkg/osqp/man/osqp.html" class="external-link">osqp::osqp()</a></code>), ex. :</p><ul><li><p>Statut de la solution (<code>status</code> et <code>status_val</code>) ;</p></li>
<li><p>Statut de raffinement de la solution (<code>status_polish</code>) ;</p></li>
<li><p>Nombre d'itérations (<code>iter</code>) ;</p></li>
<li><p>Valeur de la fonction objectif (<code>obj_val</code>) ;</p></li>
<li><p>Résidus primal et dual (<code>pri_res</code> et <code>dua_res</code>) ;</p></li>
<li><p>Temps de résolution (<code>solve_time</code>) ;</p></li>
<li><p>etc.</p></li>
</ul></li>
<li><p>informations supplémentaires spécifiques à <code>tsbalancing()</code> :</p><ul><li><p><code>prior_scaling_factor</code> (num) : valeur du facteur d'échelle lorsque <code>osqp_settings_df$prior_scaling = TRUE</code> (<code>prior_scaling_factor = 1.0</code> sinon).</p></li>
<li><p><code>obj_val_ori_prob</code> (num) : valeur de la fonction objectif du problème d'équilibrage original, qui est la valeur
de la fonction objectif d'OSQP (<code>obj_val</code>) sur l'échelle originale (lorsque <code>osqp_settings_df$prior_scaling = TRUE</code>)
plus le terme constant de la fonction objectif du problème d'équilibrage original, c.-à-d., <code>obj_val_ori_prob = obj_val
    * prior_scaling_factor + &lt;terme constant&gt;</code>, où <code>&lt;terme constant&gt;</code> correspond à \(\mathbf{y}^{\mathrm{T}} W \mathbf{y}\). Voir la section <strong>Détails</strong> pour la définition du vecteur \(\mathbf{y}\), de la matrice \(W\) et, plus
généralement, de l'expression complète de la fonction objectif du problème d'équilibrage.</p></li>
</ul></li>
</ul><p>La colonne <code>proc_grp</code> constitue une <em>clé unique</em> (enregistrements distincts) pour le <em>data frame</em>. Visitez
<a href="https://osqp.org" class="external-link">https://osqp.org</a> pour plus d'informations sur OSQP. Les problèmes (groupes de traitement) pour lesquels la solution
initiale a été renvoyée (<code>proc_grp_df$sol_type = "initial"</code>) ne sont pas inclus dans ce <em>data frame</em>.</p></li>
</ul><p>Notez que les objets de type « data.frame » renvoyés par la fonction peuvent être explicitement convertis en d'autres types
d'objets avec la fonction <code>as*()</code> appropriée (ex., <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">tibble::as_tibble()</a></code> convertirait n'importe lequel d'entre eux en tibble).</p>
    </div>
    <div class="section level2">
    <h2 id="d-tails">Détails<a class="anchor" aria-label="anchor" href="#d-tails"></a></h2>
    <p>Cette fonction résout un problème d'équilibrage par groupe de traitement (voir la section <strong>Groupes de traitement</strong> pour
plus de détails). Chacun de ces problèmes d'équilibrage est un problème de minimisation quadratique de la forme suivante :
$$\displaystyle
\begin{aligned}
&amp; \underset{\mathbf{x}}{\text{minimiser}}
&amp; &amp; \mathbf{\left( y - x \right)}^{\mathrm{T}} W \mathbf{\left( y - x \right)} \\
&amp; \text{sous contrainte(s)}
&amp; &amp; \mathbf{l} \le A \mathbf{x} \le \mathbf{u}
\end{aligned}
$$
où</p><ul><li><p>\(\mathbf{y}\) est le vecteur des valeurs initiales du problème, c.-à-d., les valeurs de période initiales et, le cas
échéant, les totaux temporels initiaux des séries chronologiques;</p></li>
<li><p>\(\mathbf{x}\) est la version finale (réconciliée) du vecteur \(\mathbf{y}\);</p></li>
<li><p>la matrice \(W = \mathrm{diag} \left( \mathbf{w} \right)\) avec les éléments du vecteur \(\mathbf{w}\)
définis comme \(w_i = \left\{
    \begin{array}{cl}
      0 &amp; \text{if } |c_i y_i| = 0 \\
      \frac{1}{|c_i y_i|} &amp; \text{sinon}
    \end{array} \right.
    \),
où \(c_i\) est coefficient d'altérabilité de la valeur du problème \(y_i\) et où les cas correspondant à \(|c_i
    y_i| = 0\) sont des valeurs fixes (valeurs de période ou totaux temporels contraignants);</p></li>
<li><p>la matrice \(A\) et les vecteurs \(\mathbf{l}\) et \(\mathbf{u}\) définissent les <em>contraintes d'équilibrage</em>,
les <em>contraintes implicites d'agrégation temporelle</em> (le cas échéant), les <em>bornes (inférieures et supérieures) des
valeurs de période</em> et <em>les contraintes \(x_i = y_i\) pour les valeurs \(y_i\) fixes</em> \(\left( \left| c_i y_i \right|
= 0 \right)\).</p></li>
</ul><p>En pratique, la fonction objectif du problème résolu par OSQP exclut le terme constant \(\mathbf{y}^{\mathrm{T}} W
\mathbf{y}\), correspondant alors à \(\mathbf{x}^{\mathrm{T}} W \mathbf{x} - 2 \left( \mathbf{w} \mathbf{y}
\right)^{\mathrm{T}} \mathbf{x}\), et les valeurs \(y_i\) fixes \(\left( \left| c_i y_i \right|
= 0 \right)\) sont exclues du problème, en ajustant les contraintes en conséquence, c.-à-d. :</p><ul><li><p>les lignes correspondant aux <em>contraintes \(x_i = y_i\) pour les valeurs \(y_i\) fixes</em> sont supprimées de \(A\),
\(\mathbf{l}\) et \(\mathbf{u}\);</p></li>
<li><p>les colonnes correspondant aux valeurs \(y_i\) fixes sont supprimées de \(A\) tout en ajustant de manière appropriée
\(\mathbf{l}\) et \(\mathbf{u}\).</p></li>
</ul><div class="section">
<h3 id="coefficients-d-alt-rabilit-">Coefficients d'altérabilité<a class="anchor" aria-label="anchor" href="#coefficients-d-alt-rabilit-"></a></h3>


<p>Les coefficients d'altérabilité sont des nombres non négatifs qui modifient le coût relatif de la modification d'une valeur
initiale du problème. En modifiant la fonction objectif à minimiser, ils permettent de générer un large éventail de solutions.
Puisqu'ils apparaissent dans le dénominateur de la fonction objectif (matrice \(W\)), plus le coefficient d'altérabilité
est élevé, moins il est coûteux de modifier une valeur du problème (valeur de période ou total temporel) et, inversement,
plus le coefficient d'altérabilité est petit, plus il devient coûteux de le faire. Il en résulte que les valeurs du problème
ayant des coefficients d'altérabilité plus élevés changent proportionnellement plus que celles ayant des coefficients
d'altérabilité plus petits. Un coefficient d'altérabilité de \(0.0\) définit une valeur de problème fixe (contraignante),
tandis qu'un coefficient d'altérabilité supérieur à \(0.0\) définit une valeur libre (non contraignante). Les coefficients
d'altérabilité par défaut sont \(0.0\) pour les totaux temporels (argument <code>alter_temporal</code>) et \(1.0\) pour les valeurs
de période (arguments <code>alter_pos</code>, <code>alter_neg</code>, <code>alter_mix</code>). Dans le cas courant des problèmes de ratissage (« <em>raking</em> »)
de tables d'agrégation, les valeurs de période des totaux de marge (séries chronologiques avec un coefficient de \(-1\)
dans les contraintes d'équilibrage) sont généralement contraignantes (spécifié avec <code>alter_neg = 0</code>) tandis que les valeurs
de période des séries composantes (séries chronologiques avec un coefficient \(1\) dans les contraintes d'équilibrage) sont
généralement non contraignantes (spécifié avec <code>alter_pos &gt; 0</code>, ex., <code>alter_pos = 1</code>). Des valeurs de problème <em>presque
contraignantes</em> (ex., pour les totaux de marge ou les totaux temporels) peuvent être obtenues en pratique en spécifiant de
très petits (presque \(0.0\)) coefficents d'altérabilité par rapport à ceux des autres valeurs (non contraignantes) du
problème.</p>
<p><strong>La préservation des totaux temporels</strong> fait référence au fait que les totaux temporels, le cas échéant, sont
généralement conservés « aussi près que possible » de leur valeur initiale. Une <em>préservation pure</em> est obtenue par
défaut avec des totaux temporels contraignants, tandis que le changement est minimisé avec des totaux temporels non
contraignants (conformément à l'ensemble de coefficients d'altérabilité utilisés).</p>
</div>

<div class="section">
<h3 id="validation-et-d-pannage">Validation et dépannage<a class="anchor" aria-label="anchor" href="#validation-et-d-pannage"></a></h3>


<p>Les problèmes d'équilibrage fructueux (problèmes avec une solution valide) ont <code>sol_status_val &gt; 0</code> ou, de manière
équivalente, <code>n_unmet_con = 0</code> ou <code>max_discr &lt;= validation_tol</code> dans le <em>data frame</em> de sortie <strong>proc_grp_df</strong>.
Le dépannage des problèmes d'équilibrage infructueux n'est pas nécessairement simple. Voici quelques suggestions :</p><ul><li><p>Examinez les contraintes qui ont échoué (<code>unmet_flag = TRUE</code> ou, de manière équivalente, <code>discr_out &gt; validation_tol</code>
dans le <em>data frame</em> de sortie <strong>prob_conf_df</strong>) pour s'assurer qu'elles ne causent pas un espace de solution vide
(problème infaisable).</p></li>
<li><p>Modifier la séquence de résolution d'OSQP. Par exemple, essayez :</p><ol><li><p>l' argument <code>full_sequence = TRUE</code></p></li>
<li><p>l' argument <code>osqp_settings_df = alternate_osqp_sequence</code></p></li>
<li><p>les arguments <code>osqp_settings_df = alternate_osqp_sequence</code> et <code>full_sequence = TRUE</code></p></li>
</ol><p>Voir la <code><a href="../articles/osqp-settings-sequence-dataframe.html">vignette("osqp-settings-sequence-dataframe")</a></code> pour plus de détails sur ce sujet.</p></li>
<li><p>Augmenter (revoir) la valeur de <code>validation_tol</code>. Bien que cela puisse ressembler à de la <em>tricherie</em>, la valeur par
défaut de <code>validation_tol</code> (\(1 \times 10^{-3}\)) peut en fait être trop petite pour les problèmes d'équilibrage qui
impliquent de très grandes valeurs (ex., en milliards) ou, inversement, trop grande avec des valeurs de problème très
petites (ex., \(&lt; 1.0\)). Multiplier l'échelle moyenne des données du problème par la <em>tolérance de la machine</em>
(<code>.Machine$double.eps</code>) donne une approximation de la taille moyenne des écarts que <code>tsbalancing()</code> devrait être capable
de détecter (distinguer de \(0\)) et devrait probablement constituer une <strong>limite inférieure absolue</strong> pour l'argument
<code>validation_tol</code>. En pratique, une valeur raisonnable de <code>validation_tol</code> devrait probablement être de \(1
\times 10^3\) à \(1 \times 10^6\) fois plus grande que cette <em>limite inférieure</em>.</p></li>
<li><p>S'attaquer aux contraintes redondantes. Les problèmes de ratissage (« <em>raking</em> ») de tables d'agrégation
multidimensionnelles sont surspécifiés (ils impliquent des contraintes redondantes) lorsque tous les totaux de toutes
les dimensions du <em>cube de données</em> sont contraignants (fixes) et qu'une contrainte est définie pour chacun d'entre eux.
La redondance se produit également pour les contraintes implicites d'agrégation temporelle dans les tables d'agrégation
unidimensionnelles ou multidimensionnelles avec des totaux temporels contraignants (fixes). La surspécification n'est
généralement pas un problème pour <code>tsbalancing()</code> si les données d'entrée ne sont pas contradictoires en ce qui concerne
les contraintes redondantes, c'est-à-dire, s'il n'y a pas d'incohérences (d'écarts) associées aux contraintes redondantes
dans les données d'entrée ou si elles sont <em>négligeables</em> (raisonnablement faibles par rapport à l'échelle des données
du problème). Dans le cas contraire, cela peut conduire à des problèmes d'équilibrage infructueux <code>tsbalancing()</code>. Les
solutions possibles sont alors les suivantes :</p><ol><li><p>Résoudre (ou réduire) les écarts associés aux contraintes redondantes dans les données d'entrée.</p></li>
<li><p>Sélectionner un total de marge dans chaque dimension, sauf une, du cube de données et supprimer du problème les
contraintes d'équilibrage correspondantes. <em>Cela ne peut pas être fait pour les contraintes implicites d'agrégation
temporelle.</em></p></li>
<li><p>Sélectionnez un total de marge dans chaque dimension, sauf une, du cube de données et rendez-les non contraignantes
(coefficient d'altérabilité de, disons, \(1.0\)).</p></li>
<li><p>Faire la même chose que (3) pour les totaux temporels d'une des séries composantes de l'intérieur du cube (les
rendre non contraignants).</p></li>
<li><p>Rendre tous les totaux de marge de chaque dimension, sauf une, du cube de données <em>presque contraignants</em>, c.-à-d.,
spécifier de très petits coefficients d'altérabilité (disons \(1 \times 10^{-6}\)) par rapport à ceux des séries
composantes de l'intérieur du cube.</p></li>
<li><p>Faire la même chose que (5) pour les totaux temporels de toutes les séries composantes de l'intérieur du cube
(coefficients d'altérabilité très petits, par exemple, avec l'argument <code>alter_temporal</code>).</p></li>
<li><p>Utilisez <code><a href="tsraking.html">tsraking()</a></code> (le cas échéant), qui gère ces incohérences en utilisant l'inverse de Moore-Penrose
(distribution uniforme à travers tous les totaux contraignants).</p></li>
</ol><p>Les solutions (2) à (7) ci-dessus ne doivent être envisagées que si les écarts associés aux contraintes redondantes
dans les données d'entrée sont <em>raisonnablement faibles</em> car ils seraient distribués parmi les totaux omis ou non
contraignants avec <code>tsbalancing()</code> et tous les totaux contraignants avec <code><a href="tsraking.html">tsraking()</a></code>. Sinon, il faut d'abord étudier
la solution (1) ci-dessus.</p></li>
<li><p>Assouplir (relaxer) les bornes des contraintes du problème, par exemple :</p><ul><li><p>avec l'argument <code>tolV</code> pour les contraintes d'équilibrage;</p></li>
<li><p>avec les arguments <code>tolV_temporal</code> et <code>tolP_temporal</code> pour les contraintes implicites d'agrégation temporelle;</p></li>
<li><p>avec les arguments <code>lower_bound</code> et <code>upper_bound</code>.</p></li>
</ul></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="groupes-de-traitement">Groupes de traitement<a class="anchor" aria-label="anchor" href="#groupes-de-traitement"></a></h2>
    <p>L'ensemble des périodes d'un problème de réconciliation (ratissage ou équilibrage) donné est appelé <em>groupe de
traitement</em> et correspond soit :</p><ul><li><p>à une <strong>période unique</strong> lors d'un traitement période par période ou, lorsque les totaux temporels sont préservés,
pour les périodes individuelles d'un groupe temporel incomplet (ex., une année incomplète)</p></li>
<li><p>ou à l'<strong>ensemble des périodes d'un groupe temporel complet</strong> (ex., une année complète) lorsque les totaux temporels
sont préservés.</p></li>
</ul><p>Le nombre total de groupes de traitement (nombre total de problèmes de réconciliation) dépend de l'ensemble de périodes
des séries chronologiques d'entrée (objet de type série chronologique spécifié avec l'argument <code>in_ts</code>) et de la valeur
des arguments <code>temporal_grp_periodicity</code> et <code>temporal_grp_start</code>.</p>
<p>Les scénarios courants incluent <code>temporal_grp_periodicity = 1</code> (par défaut) pour un traitement période par période sans
préservation des totaux temporels et
<code>temporal_grp_periodicity = frequency(in_ts)</code> pour la préservation des totaux annuels (années civiles par défaut).
L'argument <code>temporal_grp_start</code> permet de spécifier d'autres types d'années (<em>non civile</em>). Par exemple, des années
financières commençant en avril correspondent à <code>temporal_grp_start = 4</code> avec des données mensuelles et à
<code>temporal_grp_start = 2</code> avec des données trimestrielles. La préservation des totaux trimestriels avec des données
mensuelles correspondrait à <code>temporal_grp_periodicity = 3</code>.</p>
<p>Par défaut, les groupes temporels convrant plus d'une année (c.-à-d., correspondant à <code>temporal_grp_periodicity &gt; frequency(in_ts)</code>) débutent avec une année
qui est un multiple de <code>
ceiling(temporal_grp_periodicity / frequency(in_ts))</code>. Par exemple, les groupes bisannuels correspondant à
<code>temporal_grp_periodicity = 2 * frequency(in_ts)</code> débutent avec une <em>année paire</em> par défaut. Ce comportement peut être
modifié avec l'argument <code>temporal_grp_start</code>. Par exemple, la préservation des totaux bisannuels débutant avec une <em>année
impaire</em> au lieu d'une <em>année paire</em> (par défaut) correspond à <code>temporal_grp_start = frequency(in_ts) + 1</code> (avec
<code>temporal_grp_periodicity = 2 * frequency(in_ts)</code>).</p>
<p>Voir les <strong>Exemples</strong> de <code><a href="gs.build_proc_grps.html">gs.build_proc_grps()</a></code> pour des scénarios courants de groupes de traitements.</p>
    </div>
    <div class="section level2">
    <h2 id="comparaison-de-tsraking-et-tsbalancing-">Comparaison de <code><a href="tsraking.html">tsraking()</a></code> et <code>tsbalancing()</code><a class="anchor" aria-label="anchor" href="#comparaison-de-tsraking-et-tsbalancing-"></a></h2>

<ul><li><p><code><a href="tsraking.html">tsraking()</a></code> est limitée aux problèmes de ratissage (« <em>raking</em> ») de tables d'agrégation unidimensionnelles et
bidimensionnelles (avec préservation des totaux temporels si nécessaire) alors que <code>tsbalancing()</code> traite des problèmes
d'équilibrage plus généraux (ex., des problèmes de ratissage de plus grande dimension, solutions non négatives,
contraintes linéaires générales d'égalité et d'inégalité par opposition à des règles d'agrégation uniquement, etc.)</p></li>
<li><p><code><a href="tsraking.html">tsraking()</a></code> renvoie la solution des moindres carrés généralisés du modèle de ratissage basé sur la régression de
Dagum et Cholette (Dagum et Cholette 2006) tandis que <code>tsbalancing()</code> résout le problème de minimisation quadratique
correspondant à l'aide d'un solveur numérique. Dans la plupart des cas, la <em>convergence vers le minimum</em> est atteinte
et la solution de <code>tsbalancing()</code> correspond à la solution (exacte) des moindres carrés de <code><a href="tsraking.html">tsraking()</a></code>. Cela peut ne
pas être le cas, cependant, si la convergence n'a pas pu être atteinte après un nombre raisonnable d'itérations. Cela
dit, ce n'est qu'en de très rares occasions que la solution de <code>tsbalancing()</code> différera <em>significativement</em> de celle
de <code><a href="tsraking.html">tsraking()</a></code>.</p></li>
<li><p><code>tsbalancing()</code> est généralement plus rapide que <code><a href="tsraking.html">tsraking()</a></code>, en particulier pour les gros problèmes de ratissage,
mais est généralement plus sensible à la présence de (petites) incohérences dans les données d'entrée associées aux
contraintes redondantes des problèmes de ratissage <em>entièrement spécifiés</em> (ou surspécifiés). <code><a href="tsraking.html">tsraking()</a></code> gère ces
incohérences en utilisant l'inverse de Moore-Penrose (distribution uniforme à travers tous les totaux contraignants).</p></li>
<li><p><code>tsbalancing()</code> permet de spécifier des problèmes épars (clairsemés) sous leur forme réduite. Ce n'est pas le cas de
<code><a href="tsraking.html">tsraking()</a></code> où les règles d'agrégation doivent toujours être entièrement spécifiées étant donné qu'un <em>cube de données
complet</em>, sans données manquantes, est attendu en entrée (chaque série composante de l'<em>intérieur du cube</em> doit
contribuer à toutes les dimensions du cube, c.-à-d., à chaque série totale des <em>faces extérieures du cube</em>).</p></li>
<li><p>Les deux outils traitent différemment les valeurs négatives dans les données d'entrée par défaut. Alors que les
solutions des problèmes de ratissage obtenues avec <code>tsbalancing()</code> et <code><a href="tsraking.html">tsraking()</a></code> sont identiques lorsque tous les
points de données d'entrée sont positifs, elles seront différentes si certains points de données sont négatifs (à
moins que l'argument <code>Vmat_option = 2</code> ne soit spécifié avec <code><a href="tsraking.html">tsraking()</a></code>).</p></li>
<li><p>Alors que <code>tsbalancing()</code> et <code><a href="tsraking.html">tsraking()</a></code> permettent toutes les deux de préserver les totaux temporels, la gestion
du temps n'est pas incorporée dans <code><a href="tsraking.html">tsraking()</a></code>. Par exemple, la construction des groupes de traitement (ensembles de
périodes de chaque problème de ratissage) est laissée à l'utilisateur avec <code><a href="tsraking.html">tsraking()</a></code> et des appels séparés doivent
être soumis pour chaque groupe de traitement (chaque problème de ratissage). De là l'utilité de la fonction
d'assistance <code><a href="tsraking_driver.html">tsraking_driver()</a></code> pour <code><a href="tsraking.html">tsraking()</a></code>.</p></li>
<li><p><code>tsbalancing()</code> renvoie le même ensemble de séries que l'objet d'entrée de type série chronologique (argument
<code>in_ts</code>) alors que <code><a href="tsraking.html">tsraking()</a></code> renvoie l'ensemble des séries impliquées dans le problème de ratissage plus celles
spécifiées avec l'argument <code>id</code> (qui pourrait correspondre à un sous-ensemble des séries d'entrée).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="r-f-rences">Références<a class="anchor" aria-label="anchor" href="#r-f-rences"></a></h2>
    <p>Dagum, E. B. et P. Cholette (2006). <strong>Benchmarking, Temporal Distribution and Reconciliation Methods
of Time Series</strong>. Springer-Verlag, New York, Lecture Notes in Statistics, Vol. 186.</p>
<p>Ferland, M., S. Fortier et J. Bérubé (2016). « A Mathematical Optimization Approach to Balancing Time Series:
Statistics Canada’s GSeriesTSBalancing ». Dans <strong>JSM Proceedings, Business and Economic Statistics Section</strong>. Alexandria,
VA: American Statistical Association. 2292-2306.</p>
<p>Ferland, M. (2018). « Time Series Balancing Quadratic Problem — Hessian matrix and vector of linear objective
function coefficients ». <strong>Document interne</strong>. Statistique Canada, Ottawa, Canada.</p>
<p>Quenneville, B. et S. Fortier (2012). « Restoring Accounting Constraints in Time Series – Methods and
Software for a Statistical Agency ». <strong>Economic Time Series: Modeling and Seasonality</strong>. Chapman &amp; Hall, New York.</p>
<p>SAS Institute Inc. (2015). « The LP Procedure Sparse Data Input Format ». <strong>SAS/OR\(^\circledR\) 14.1 User's
Guide: Mathematical Programming Legacy Procedures</strong>.
<a href="https://support.sas.com/documentation/cdl/en/ormplpug/68158/HTML/default/viewer.htm#ormplpug_lp_details03.htm" class="external-link">https://support.sas.com/documentation/cdl/en/ormplpug/68158/HTML/default/viewer.htm#ormplpug_lp_details03.htm</a></p>
<p>Statistique Canada (2016). « La macro <em><strong>GSeriesTSBalancing</strong></em> ». <strong>Guide de l'utilisateur de G-Séries 2.0</strong>.
Statistique Canada, Ottawa, Canada.</p>
<p>Statistique Canada (2018). <strong>Théorie et application de la réconciliation (Code du cours 0437)</strong>.
Statistique Canada, Ottawa, Canada.</p>
<p>Stellato, B., G. Banjac, P. Goulart et al. (2020). « OSQP: an operator splitting solver for quadratic programs ».
<strong>Math. Prog. Comp. 12</strong>, 637–672 (2020). <a href="https://doi.org/10.1007/s12532-020-00179-2" class="external-link">https://doi.org/10.1007/s12532-020-00179-2</a></p>
    </div>
    <div class="section level2">
    <h2 id="voir-galement">Voir également<a class="anchor" aria-label="anchor" href="#voir-galement"></a></h2>
    <div class="dont-index"><p><code><a href="tsraking.html">tsraking()</a></code> <code><a href="tsraking_driver.html">tsraking_driver()</a></code> <code><a href="rkMeta_to_blSpecs.html">rkMeta_to_blSpecs()</a></code> <code><a href="gs.build_proc_grps.html">gs.build_proc_grps()</a></code> <code><a href="build_balancing_problem.html">build_balancing_problem()</a></code> <a href="aliases.html">aliases</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Exemples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###########</span></span></span>
<span class="r-in"><span><span class="co"># Exemple 1 : Dans ce premier exemple, l'objectif est d'équilibrer un tableau comptable simple </span></span></span>
<span class="r-in"><span><span class="co">#             (`Profits = Revenus - Depenses`), pour 5 trimestres, sans modifier les `Profits` </span></span></span>
<span class="r-in"><span><span class="co">#             et où `Revenus &gt;= 0` et `Depenses &gt;= 0`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spécifications du problème</span></span></span>
<span class="r-in"><span><span class="va">mes_specs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQ"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                  <span class="st">"alter"</span>, <span class="cn">NA</span>, </span></span>
<span class="r-in"><span>                                  <span class="st">"lowerBd"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"Revenus"</span>, <span class="st">"Depenses"</span>, <span class="st">"Profits"</span>, </span></span>
<span class="r-in"><span>                                 <span class="cn">NA</span>, <span class="st">"Profits"</span>, </span></span>
<span class="r-in"><span>                                 <span class="cn">NA</span>, <span class="st">"Revenus"</span>, <span class="st">"Depenses"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         row <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Règle comptable"</span>, <span class="fl">4</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                 <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Coefficient d'altérabilité"</span>, <span class="fl">2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                 <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Borne inférieure"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                  <span class="cn">NA</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                  <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mes_specs1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      type      col                        row coef</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      EQ     &lt;NA&gt;            Règle comptable   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    &lt;NA&gt;  Revenus            Règle comptable    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    &lt;NA&gt; Depenses            Règle comptable   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    &lt;NA&gt;  Profits            Règle comptable   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   alter     &lt;NA&gt; Coefficient d'altérabilité   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    &lt;NA&gt;  Profits Coefficient d'altérabilité    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 lowerBd     &lt;NA&gt;           Borne inférieure   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    &lt;NA&gt;  Revenus           Borne inférieure    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    &lt;NA&gt; Depenses           Borne inférieure    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Données du problème</span></span></span>
<span class="r-in"><span><span class="va">mes_series1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">15</span>,  <span class="fl">10</span>,  <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                             <span class="fl">4</span>,   <span class="fl">8</span>,  <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">250</span>, <span class="fl">250</span>,   <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                             <span class="fl">8</span>,  <span class="fl">12</span>,   <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                             <span class="fl">0</span>,  <span class="fl">45</span>, <span class="op">-</span><span class="fl">55</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         ncol <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                         byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                         dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Revenus"</span>, <span class="st">"Depenses"</span>, <span class="st">"Profits"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2022</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Réconcilier les données</span></span></span>
<span class="r-in"><span><span class="va">res_equi1</span> <span class="op">&lt;-</span> <span class="fu">tsbalancing</span><span class="op">(</span>in_ts <span class="op">=</span> <span class="va">mes_series1</span>,</span></span>
<span class="r-in"><span>                         problem_specs_df <span class="op">=</span> <span class="va">mes_specs1</span>,</span></span>
<span class="r-in"><span>                         display_level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --- Package gstest 3.0.0 - (EN) 'G-Series' in 'R' | (FR) 'G-Séries' en 'R' ---</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created on April 8, 2025, at 3:40:01 PM EDT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> URL: https://ferlmic.github.io/gstest/en/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      https://ferlmic.github.io/gstest/fr/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Email: g-series@statcan.gc.ca</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tsbalancing() function:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     in_ts                    = mes_series1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     problem_specs_df         = mes_specs1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     temporal_grp_periodicity = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     temporal_grp_start       (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     osqp_settings_df         = default_osqp_sequence (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     display_level            = 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     alter_pos                = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     alter_neg                = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     alter_mix                = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     alter_temporal           (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lower_bound              = -Inf (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     upper_bound              = Inf (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolV                     = 0 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolV_temporal            (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)validation_tol        = 0.001 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)trunc_to_zero_tol     = validation_tol (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)validation_only       = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)quiet                 = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*) indicates new arguments in G-Series 3.0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing Problem Elements</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Balancing Constraints (1)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Règle comptable:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus - Depenses - Profits == 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Time Series Info</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>         name lowerBd                 upperBd           alter                </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   1  Revenus       0 (problem specs)     Inf (default)     1 (default)      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   2 Depenses       0 (problem specs)     Inf (default)     1 (default)      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   3  Profits    -Inf (default)           Inf (default)     0 (problem specs)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2022-1]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Initial solution:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Try to find a better solution with OSQP.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>              OSQP v0.6.3  -  Operator Splitting QP Solver</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                 (c) Bartolomeo Stellato,  Goran Banjac</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>           University of Oxford  -  Stanford University 2021</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   problem:  variables n = 2, constraints m = 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             nnz(P) + nnz(A) = 6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   settings: linear system solver = qdldl,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_abs = 1.0e-06, eps_rel = 1.0e-06,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_prim_inf = 1.0e-07, eps_dual_inf = 1.0e-07,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             rho = 1.00e-01 (adaptive),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             sigma = 1.00e-09, alpha = 1.60, max_iter = 4000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             check_termination: on (interval 25),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             scaling: off, scaled_termination: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             warm start: on, polish: on, time_limit: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iter  objective    pri res    dua res    rho        time</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      1  -1.3898e+00   7.94e-01   8.11e+01   1.00e-01   1.45e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     50  -1.9200e+00   9.38e-11   5.19e-10   1.00e-01   2.12e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   plsh  -1.9200e+00   1.11e-16   2.22e-16  ---------   2.88e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   status:               solved</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   solution polish:      successful</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   number of iterations: 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal objective:    -1.9200</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   run time:             2.88e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal rho estimate: 5.49e-02</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   OSQP iteration 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Valid solution (maximum discrepancy &lt;= 0.001 = `validation_tol`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Required polished solution achieved.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val lower_bd upper_bd alter value_in value_out dif rdif</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 1     2022        0      Inf     1       15        18   3  0.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 1     2022        0      Inf     1       10         8  -2 -0.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Profits 1     2022     -Inf      Inf     0       10        10   0  0.0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Constraints (l &lt;= Ax &lt;= u)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Balancing Constraints</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ---------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               name t time_val  l  u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Règle comptable 1     2022 10 10     5     10        5         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Period Value Bounds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val l   u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 1     2022 0 Inf    15     18        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 1     2022 0 Inf    10      8        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2022-2]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Initial solution:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Try to find a better solution with OSQP.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>              OSQP v0.6.3  -  Operator Splitting QP Solver</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                 (c) Bartolomeo Stellato,  Goran Banjac</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>           University of Oxford  -  Stanford University 2021</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   problem:  variables n = 2, constraints m = 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             nnz(P) + nnz(A) = 6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   settings: linear system solver = qdldl,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_abs = 1.0e-06, eps_rel = 1.0e-06,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_prim_inf = 1.0e-07, eps_dual_inf = 1.0e-07,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             rho = 1.00e-01 (adaptive),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             sigma = 1.00e-09, alpha = 1.60, max_iter = 4000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             check_termination: on (interval 25),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             scaling: off, scaled_termination: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             warm start: on, polish: on, time_limit: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iter  objective    pri res    dua res    rho        time</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      1  -1.2816e+00   1.57e-01   1.77e+01   1.00e-01   5.25e-05s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     50  -1.8750e+00   1.33e-11   1.11e-10   1.00e-01   1.15e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   plsh  -1.8750e+00   2.78e-17   0.00e+00  ---------   1.79e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   status:               solved</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   solution polish:      successful</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   number of iterations: 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal objective:    -1.8750</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   run time:             1.79e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal rho estimate: 5.47e-02</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   OSQP iteration 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Valid solution (maximum discrepancy &lt;= 0.001 = `validation_tol`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Required polished solution achieved.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val lower_bd upper_bd alter value_in value_out dif  rdif</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 2  2022.25        0      Inf     1        4         5   1  0.25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 2  2022.25        0      Inf     1        8         6  -2 -0.25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Profits 2  2022.25     -Inf      Inf     0       -1        -1   0  0.00</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Constraints (l &lt;= Ax &lt;= u)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Balancing Constraints</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ---------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               name t time_val  l  u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Règle comptable 2  2022.25 -1 -1    -4     -1        3         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Period Value Bounds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val l   u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 2  2022.25 0 Inf     4      5        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 2  2022.25 0 Inf     8      6        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2022-3]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Initial solution:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Try to find a better solution with OSQP.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>              OSQP v0.6.3  -  Operator Splitting QP Solver</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                 (c) Bartolomeo Stellato,  Goran Banjac</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>           University of Oxford  -  Stanford University 2021</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   problem:  variables n = 2, constraints m = 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             nnz(P) + nnz(A) = 6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   settings: linear system solver = qdldl,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_abs = 1.0e-06, eps_rel = 1.0e-06,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_prim_inf = 1.0e-07, eps_dual_inf = 1.0e-07,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             rho = 1.00e-01 (adaptive),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             sigma = 1.00e-09, alpha = 1.60, max_iter = 4000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             check_termination: on (interval 25),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             scaling: off, scaled_termination: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             warm start: on, polish: on, time_limit: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iter  objective    pri res    dua res    rho        time</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      1  -1.4512e+00   2.00e-02   3.05e+00   1.00e-01   6.19e-05s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     50  -1.9998e+00   1.70e-12   1.29e-11   1.00e-01   1.31e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   plsh  -1.9998e+00   1.73e-17   1.73e-17  ---------   2.03e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   status:               solved</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   solution polish:      successful</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   number of iterations: 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal objective:    -1.9998</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   run time:             2.03e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal rho estimate: 5.13e-02</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   OSQP iteration 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Valid solution (maximum discrepancy &lt;= 0.001 = `validation_tol`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Required polished solution achieved.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val lower_bd upper_bd alter value_in value_out  dif  rdif</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 3   2022.5        0      Inf     1      250     252.5  2.5  0.01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 3   2022.5        0      Inf     1      250     247.5 -2.5 -0.01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Profits 3   2022.5     -Inf      Inf     0        5       5.0  0.0  0.00</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Constraints (l &lt;= Ax &lt;= u)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Balancing Constraints</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ---------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               name t time_val l u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Règle comptable 3   2022.5 5 5     0      5        5         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Period Value Bounds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val l   u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 3   2022.5 0 Inf   250  252.5        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 3   2022.5 0 Inf   250  247.5        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2022-4]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Initial solution:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Try to find a better solution with OSQP.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>              OSQP v0.6.3  -  Operator Splitting QP Solver</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                 (c) Bartolomeo Stellato,  Goran Banjac</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>           University of Oxford  -  Stanford University 2021</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   problem:  variables n = 2, constraints m = 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             nnz(P) + nnz(A) = 6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   settings: linear system solver = qdldl,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_abs = 1.0e-06, eps_rel = 1.0e-06,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_prim_inf = 1.0e-07, eps_dual_inf = 1.0e-07,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             rho = 1.00e-01 (adaptive),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             sigma = 1.00e-09, alpha = 1.60, max_iter = 4000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             check_termination: on (interval 25),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             scaling: off, scaled_termination: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             warm start: on, polish: on, time_limit: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iter  objective    pri res    dua res    rho        time</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      1  -1.3898e+00   6.04e-03   1.05e+00   1.00e-01   6.24e-05s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     25  -1.9200e+00   5.09e-08   5.35e-07   1.00e-01   1.34e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   plsh  -1.9200e+00   0.00e+00   1.11e-16  ---------   2.11e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   status:               solved</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   solution polish:      successful</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   number of iterations: 25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal objective:    -1.9200</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   run time:             2.11e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal rho estimate: 4.88e-02</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   OSQP iteration 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Valid solution (maximum discrepancy &lt;= 0.001 = `validation_tol`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Required polished solution achieved.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val lower_bd upper_bd alter value_in value_out  dif rdif</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 4  2022.75        0      Inf     1        8       9.6  1.6  0.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 4  2022.75        0      Inf     1       12       9.6 -2.4 -0.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Profits 4  2022.75     -Inf      Inf     0        0       0.0  0.0   NA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Constraints (l &lt;= Ax &lt;= u)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Balancing Constraints</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ---------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               name t time_val l u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Règle comptable 4  2022.75 0 0    -4      0        4         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Period Value Bounds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val l   u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 4  2022.75 0 Inf     8    9.6        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 4  2022.75 0 Inf    12    9.6        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2023-1]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Initial solution:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Try to find a better solution with OSQP.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>              OSQP v0.6.3  -  Operator Splitting QP Solver</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                 (c) Bartolomeo Stellato,  Goran Banjac</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>           University of Oxford  -  Stanford University 2021</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -----------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   problem:  variables n = 1, constraints m = 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             nnz(P) + nnz(A) = 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   settings: linear system solver = qdldl,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_abs = 1.0e-06, eps_rel = 1.0e-06,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             eps_prim_inf = 1.0e-07, eps_dual_inf = 1.0e-07,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             rho = 1.00e-01 (adaptive),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             sigma = 1.00e-09, alpha = 1.60, max_iter = 4000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             check_termination: on (interval 25),</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             scaling: off, scaled_termination: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             warm start: on, polish: on, time_limit: off</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iter  objective    pri res    dua res    rho        time</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      1  -6.1701e-02   1.19e+00   1.21e+02   1.00e-01   5.75e-05s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     50  -9.5062e-01   1.37e-10   1.41e-10   1.00e-01   1.84e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   plsh  -9.5062e-01   0.00e+00   0.00e+00  ---------   2.99e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   status:               solved</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   solution polish:      successful</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   number of iterations: 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal objective:    -0.9506</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   run time:             2.99e-04s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   optimal rho estimate: 1.39e-01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   OSQP iteration 1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Maximum discrepancy = 7.105427e-15</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Total discrepancy   = 7.105427e-15</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Valid solution (maximum discrepancy &lt;= 0.001 = `validation_tol`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Required polished solution achieved.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   --------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val lower_bd upper_bd alter value_in value_out dif      rdif</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus 5     2023        0      Inf     1        0         0   0        NA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 5     2023        0      Inf     1       45        55  10 0.2222222</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Profits 5     2023     -Inf      Inf     0      -55       -55   0 0.0000000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Problem Constraints (l &lt;= Ax &lt;= u)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Balancing Constraints</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ---------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               name t time_val   l   u Ax_in Ax_out discr_in    discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Règle comptable 5     2023 -55 -55   -45    -55       10 7.105427e-15          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Period Value Bounds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>        name t time_val l   u Ax_in Ax_out discr_in discr_out validation_tol unmet_flag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    Depenses 5     2023 0 Inf    45     55        0         0          0.001      FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Données initiales</span></span></span>
<span class="r-in"><span><span class="va">mes_series1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Revenus Depenses Profits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q1      15       10      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q2       4        8      -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q3     250      250       5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q4       8       12       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2023 Q1       0       45     -55</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Données réconciliées</span></span></span>
<span class="r-in"><span><span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Revenus Depenses Profits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q1    18.0      8.0      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q2     5.0      6.0      -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q3   252.5    247.5       5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q4     9.6      9.6       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2023 Q1     0.0     55.0     -55</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Vérifier la présence de solutions invalides</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">res_equi1</span><span class="op">$</span><span class="va">proc_grp_df</span><span class="op">$</span><span class="va">sol_status_val</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Afficher les écarts maximaux des contraintes en sortie</span></span></span>
<span class="r-in"><span><span class="va">res_equi1</span><span class="op">$</span><span class="va">proc_grp_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proc_grp_label"</span>, <span class="st">"max_discr"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   proc_grp_label    max_discr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         2022-1 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2022-2 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         2022-3 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         2022-4 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         2023-1 7.105427e-15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># La solution renvoyée par `tsbalancing()` correspond à des changements proportionnels </span></span></span>
<span class="r-in"><span><span class="co"># égaux (au prorata) et est associée aux coefficients d'altérabilité par défaut de 1. </span></span></span>
<span class="r-in"><span><span class="co"># Des changements absolus égaux peuvent être obtenus en spécifiant des coefficients </span></span></span>
<span class="r-in"><span><span class="co"># d'altérabilité égaux à l'inverse des valeurs initiales. </span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># Faisons cela pour le groupe de traitement 2022T2 (`timeVal = 2022.25`), avec le niveau </span></span></span>
<span class="r-in"><span><span class="co"># d'information affiché par défaut (`display_level = 1`).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mes_specs1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mes_specs1</span>, </span></span>
<span class="r-in"><span>                          <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>timeVal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mes_specs1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Revenus"</span>, <span class="st">"Depenses"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               row <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Coefficient d'altérabilité"</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.125</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               timeVal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2022.25</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mes_specs1b</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       type      col                        row   coef timeVal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       EQ     &lt;NA&gt;            Règle comptable     NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     &lt;NA&gt;  Revenus            Règle comptable  1.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     &lt;NA&gt; Depenses            Règle comptable -1.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     &lt;NA&gt;  Profits            Règle comptable -1.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    alter     &lt;NA&gt; Coefficient d'altérabilité     NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     &lt;NA&gt;  Profits Coefficient d'altérabilité  0.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  lowerBd     &lt;NA&gt;           Borne inférieure     NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     &lt;NA&gt;  Revenus           Borne inférieure  0.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     &lt;NA&gt; Depenses           Borne inférieure  0.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    &lt;NA&gt;  Revenus Coefficient d'altérabilité  0.250 2022.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    &lt;NA&gt; Depenses Coefficient d'altérabilité  0.125 2022.25</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res_equi1b</span> <span class="op">&lt;-</span> <span class="fu">tsbalancing</span><span class="op">(</span>in_ts <span class="op">=</span> <span class="va">mes_series1</span>,</span></span>
<span class="r-in"><span>                          problem_specs_df <span class="op">=</span> <span class="va">mes_specs1b</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --- Package gstest 3.0.0 - (EN) 'G-Series' in 'R' | (FR) 'G-Séries' en 'R' ---</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created on April 8, 2025, at 3:40:01 PM EDT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> URL: https://ferlmic.github.io/gstest/en/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      https://ferlmic.github.io/gstest/fr/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Email: g-series@statcan.gc.ca</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tsbalancing() function:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     in_ts                    = mes_series1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     problem_specs_df         = mes_specs1b</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     temporal_grp_periodicity = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     temporal_grp_start       (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     osqp_settings_df         = default_osqp_sequence (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     display_level            = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     alter_pos                = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     alter_neg                = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     alter_mix                = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     alter_temporal           (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lower_bound              = -Inf (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     upper_bound              = Inf (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolV                     = 0 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolV_temporal            (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)validation_tol        = 0.001 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)trunc_to_zero_tol     = validation_tol (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)validation_only       = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)quiet                 = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*) indicates new arguments in G-Series 3.0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing Problem Elements</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Balancing Constraints (1)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Règle comptable:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Revenus - Depenses - Profits == 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Time Series Info</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ----------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>         name lowerBd                 upperBd           alter                  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   1  Revenus       0 (problem specs)     Inf (default)     1 * (default)      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   2 Depenses       0 (problem specs)     Inf (default)     1 * (default)      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   3  Profits    -Inf (default)           Inf (default)     0   (problem specs)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   * indicates cases where period-specific values (`timeVal` is not `NA`) are specified in the problem specs data frame.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2022-1]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2022-2]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2022-3]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2022-4]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2023-1]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Afficher les valeurs initiales de 2022T2 et les deux solutions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Statut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"initial"</span>, <span class="st">"prorata"</span>, <span class="st">"changement égal"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">res_equi1b</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Ecart_comptable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> </span></span>
<span class="r-in"><span>                                       <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                     <span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> </span></span>
<span class="r-in"><span>                                       <span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> </span></span>
<span class="r-in"><span>                                       <span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                     <span class="va">res_equi1b</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> </span></span>
<span class="r-in"><span>                                       <span class="va">res_equi1b</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> </span></span>
<span class="r-in"><span>                                       <span class="va">res_equi1b</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 ChgRel_Rev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, </span></span>
<span class="r-in"><span>                                <span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                <span class="va">res_equi1b</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 ChgRel_Dep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, </span></span>
<span class="r-in"><span>                                <span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                <span class="va">res_equi1b</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 ChgAbs_Rev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, </span></span>
<span class="r-in"><span>                                <span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                <span class="va">res_equi1b</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 ChgAbs_Dep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, </span></span>
<span class="r-in"><span>                                <span class="va">res_equi1</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                <span class="va">res_equi1b</span><span class="op">$</span><span class="va">out_ts</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">mes_series1</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Statut Revenus Depenses Profits Ecart_comptable ChgRel_Rev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         initial     4.0      8.0      -1              -3         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         prorata     5.0      6.0      -1               0      0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 changement égal     5.5      6.5      -1               0      0.375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ChgRel_Dep ChgAbs_Rev ChgAbs_Dep</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    -0.2500        1.0       -2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    -0.1875        1.5       -1.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###########</span></span></span>
<span class="r-in"><span><span class="co"># Exemple 2 : Dans ce deuxième exemple, nous considérons les données simulées des  </span></span></span>
<span class="r-in"><span><span class="co">#             ventes trimestrielles de véhicules par région (Ouest, Centre et Est), </span></span></span>
<span class="r-in"><span><span class="co">#             ainsi qu'un total national pour les trois régions, et par type de véhicules </span></span></span>
<span class="r-in"><span><span class="co">#             (voitures, camions et un total qui peut inclure d'autres types de véhicules). </span></span></span>
<span class="r-in"><span><span class="co">#             Les données correspondent à des données directement désaisonnalisées qui </span></span></span>
<span class="r-in"><span><span class="co">#             ont été étalonnées aux totaux annuels des séries originales (non </span></span></span>
<span class="r-in"><span><span class="co">#             désaisonnalisées) correspondantes dans le cadre du processus de </span></span></span>
<span class="r-in"><span><span class="co">#             désaisonnalisation (par exemple, avec le « spec » FORCE du logiciel </span></span></span>
<span class="r-in"><span><span class="co">#             X-13ARIMA-SEATS). </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#             L'objectif est de réconcilier les ventes régionales avec les ventes </span></span></span>
<span class="r-in"><span><span class="co">#             nationales sans modifier ces dernières, tout en veillant à ce que la somme </span></span></span>
<span class="r-in"><span><span class="co">#             des ventes de voitures et de camions ne dépasse pas 95% des ventes de tous </span></span></span>
<span class="r-in"><span><span class="co">#             les types de véhicules au cours d'un trimestre donné. À titre d'exemple, </span></span></span>
<span class="r-in"><span><span class="co">#             nous supposons que les ventes de camions dans la région Centre pour le 2e </span></span></span>
<span class="r-in"><span><span class="co">#             trimestre 2022 ne peuvent pas être modifiées.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spécifications du problème</span></span></span>
<span class="r-in"><span><span class="va">mes_specs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQ"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="st">"EQ"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="st">"EQ"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="st">"LE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="st">"LE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="st">"LE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="st">"alter"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"Ouest_Tous"</span>, <span class="st">"Centre_Tous"</span>, <span class="st">"Est_Tous"</span>, <span class="st">"National_Tous"</span>, </span></span>
<span class="r-in"><span>          <span class="cn">NA</span>, <span class="st">"Ouest_Autos"</span>, <span class="st">"Centre_Autos"</span>, <span class="st">"Est_Autos"</span>, <span class="st">"National_Autos"</span>, </span></span>
<span class="r-in"><span>          <span class="cn">NA</span>, <span class="st">"Ouest_Camions"</span>, <span class="st">"Centre_Camions"</span>, <span class="st">"Est_Camions"</span>, <span class="st">"National_Camions"</span>, </span></span>
<span class="r-in"><span>          <span class="cn">NA</span>, <span class="st">"Ouest_Autos"</span>, <span class="st">"Ouest_Camions"</span>, <span class="st">"Ouest_Tous"</span>, </span></span>
<span class="r-in"><span>          <span class="cn">NA</span>, <span class="st">"Centre_Autos"</span>, <span class="st">"Centre_Camions"</span>, <span class="st">"Centre_Tous"</span>, </span></span>
<span class="r-in"><span>          <span class="cn">NA</span>, <span class="st">"Est_Autos"</span>, <span class="st">"Est_Camions"</span>, <span class="st">"Est_Tous"</span>,</span></span>
<span class="r-in"><span>          <span class="cn">NA</span>, <span class="st">"National_Tous"</span>, <span class="st">"National_Autos"</span>, <span class="st">"National_Camions"</span>, <span class="st">"Centre_Camions"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  row <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Total national - Tous les véhicules"</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Total national - Autos"</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Total national - Camions"</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Somme région Ouest"</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Somme région Centre"</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Somme région Est"</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Coefficient d'altérabilité"</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>           <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>           <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>           <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">.95</span>,</span></span>
<span class="r-in"><span>           <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">.95</span>,</span></span>
<span class="r-in"><span>           <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">.95</span>,</span></span>
<span class="r-in"><span>           <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  time_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">31</span><span class="op">)</span>, <span class="fl">2022.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Début et fin du « data frame » des spécifications</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mes_specs2</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    type            col                                 row coef time_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    EQ           &lt;NA&gt; Total national - Tous les véhicules   NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  &lt;NA&gt;     Ouest_Tous Total national - Tous les véhicules    1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  &lt;NA&gt;    Centre_Tous Total national - Tous les véhicules    1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  &lt;NA&gt;       Est_Tous Total national - Tous les véhicules    1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  &lt;NA&gt;  National_Tous Total national - Tous les véhicules   -1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    EQ           &lt;NA&gt;              Total national - Autos   NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  &lt;NA&gt;    Ouest_Autos              Total national - Autos    1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  &lt;NA&gt;   Centre_Autos              Total national - Autos    1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  &lt;NA&gt;      Est_Autos              Total national - Autos    1       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 &lt;NA&gt; National_Autos              Total national - Autos   -1       NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">mes_specs2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     type              col                        row  coef time_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  &lt;NA&gt;         Est_Tous           Somme région Est -0.95       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 alter             &lt;NA&gt; Coefficient d'altérabilité    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  &lt;NA&gt;    National_Tous Coefficient d'altérabilité  0.00       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  &lt;NA&gt;   National_Autos Coefficient d'altérabilité  0.00       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  &lt;NA&gt; National_Camions Coefficient d'altérabilité  0.00       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  &lt;NA&gt;   Centre_Camions Coefficient d'altérabilité  0.00  2022.25</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Données du problème</span></span></span>
<span class="r-in"><span><span class="va">mes_series2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">49</span>, <span class="fl">47</span>, <span class="fl">136</span>, <span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">12</span>, <span class="fl">53</span>, <span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">26</span>, <span class="fl">61</span>,</span></span>
<span class="r-in"><span>           <span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">42</span>, <span class="fl">114</span>, <span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">19</span>, <span class="fl">44</span>, <span class="fl">21</span>, <span class="fl">26</span>, <span class="fl">21</span>, <span class="fl">59</span>,</span></span>
<span class="r-in"><span>           <span class="fl">35</span>, <span class="fl">47</span>, <span class="fl">40</span>, <span class="fl">133</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">50</span>, <span class="fl">19</span>, <span class="fl">25</span>, <span class="fl">19</span>, <span class="fl">71</span>,</span></span>
<span class="r-in"><span>           <span class="fl">44</span>, <span class="fl">44</span>, <span class="fl">45</span>, <span class="fl">138</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">14</span>, <span class="fl">52</span>, <span class="fl">21</span>, <span class="fl">18</span>, <span class="fl">27</span>, <span class="fl">74</span>,</span></span>
<span class="r-in"><span>           <span class="fl">46</span>, <span class="fl">48</span>, <span class="fl">55</span>, <span class="fl">135</span>, <span class="fl">16</span>, <span class="fl">15</span>, <span class="fl">19</span>, <span class="fl">51</span>, <span class="fl">27</span>, <span class="fl">25</span>, <span class="fl">28</span>, <span class="fl">54</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         ncol <span class="op">=</span> <span class="fl">12</span>,</span></span>
<span class="r-in"><span>         byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>         dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ouest_Tous"</span>, <span class="st">"Centre_Tous"</span>, <span class="st">"Est_Tous"</span>, </span></span>
<span class="r-in"><span>                           <span class="st">"National_Tous"</span>, <span class="st">"Ouest_Autos"</span>, <span class="st">"Centre_Autos"</span>, </span></span>
<span class="r-in"><span>                           <span class="st">"Est_Autos"</span>, <span class="st">"National_Autos"</span>, <span class="st">"Ouest_Camions"</span>, </span></span>
<span class="r-in"><span>                           <span class="st">"Centre_Camions"</span>, <span class="st">"Est_Camions"</span>, <span class="st">"National_Camions"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2022</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Réconcilier sans afficher l'en-tête de la fonction et imposer des données non négatives</span></span></span>
<span class="r-in"><span><span class="va">res_equi2</span> <span class="op">&lt;-</span> <span class="fu">tsbalancing</span><span class="op">(</span></span></span>
<span class="r-in"><span>  in_ts                    <span class="op">=</span> <span class="va">mes_series2</span>,</span></span>
<span class="r-in"><span>  problem_specs_df         <span class="op">=</span> <span class="va">mes_specs2</span>,</span></span>
<span class="r-in"><span>  temporal_grp_periodicity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">frequency</a></span><span class="op">(</span><span class="va">mes_series2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower_bound              <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  quiet                    <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing periods [2022-1 - 2022-4]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ===================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2023-1]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Données initiales</span></span></span>
<span class="r-in"><span><span class="va">mes_series2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ouest_Tous Centre_Tous Est_Tous National_Tous Ouest_Autos Centre_Autos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q1         43          49       47           136          20           18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q2         40          45       42           114          16           16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q3         35          47       40           133          14           15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q4         44          44       45           138          19           20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2023 Q1         46          48       55           135          16           15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Est_Autos National_Autos Ouest_Camions Centre_Camions Est_Camions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q1        12             53            20             22          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q2        19             44            21             26          21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q3        16             50            19             25          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q4        14             52            21             18          27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2023 Q1        19             51            27             25          28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         National_Camions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q1               61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q2               59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q3               71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q4               74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2023 Q1               54</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Données réconciliées</span></span></span>
<span class="r-in"><span><span class="va">res_equi2</span><span class="op">$</span><span class="va">out_ts</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Ouest_Tous Centre_Tous Est_Tous National_Tous Ouest_Autos Centre_Autos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q1   42.10895    47.63734 46.25371           136    21.15646     19.13355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q2   35.31121    41.40859 37.28019           114    14.00517     13.33816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q3   38.89464    50.58071 43.52465           133    15.24054     16.84858</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q4   45.68520    45.37335 46.94145           138    18.59783     19.67970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2023 Q1   41.67785    43.48993 49.83221           135    16.32000     15.30000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Est_Autos National_Autos Ouest_Camions Centre_Camions Est_Camions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q1  12.70999             53      18.56134       18.59359    23.84507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q2  16.65666             44      16.61497       26.00000    16.38503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q3  17.91088             50      21.70936       27.22926    22.06138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q4  13.72247             52      24.11433       19.17715    30.70852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2023 Q1  19.38000             51      18.22500       16.87500    18.90000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         National_Camions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q1               61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q2               59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q3               71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2022 Q4               74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2023 Q1               54</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Vérifier la présence de solutions invalides</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">res_equi2</span><span class="op">$</span><span class="va">proc_grp_df</span><span class="op">$</span><span class="va">sol_status_val</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Afficher les écarts maximaux des contraintes en sortie</span></span></span>
<span class="r-in"><span><span class="va">res_equi2</span><span class="op">$</span><span class="va">proc_grp_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proc_grp_label"</span>, <span class="st">"max_discr"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    proc_grp_label    max_discr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2022-1 - 2022-4 2.842171e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2023-1 0.000000e+00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###########</span></span></span>
<span class="r-in"><span><span class="co"># Exemple 3 : Reproduire le 2ème exemple de `tsraking_driver()` avec `tsbalancing()` </span></span></span>
<span class="r-in"><span><span class="co">#             (ratissage à 1 dimension avec préservation des totaux annuels).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Métadonnées de `tsraking()`</span></span></span>
<span class="r-in"><span><span class="va">mes_meta3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"autos_alb"</span>, <span class="st">"autos_sask"</span>, <span class="st">"autos_man"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        total1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"autos_tot"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mes_meta3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       series    total1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  autos_alb autos_tot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 autos_sask autos_tot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  autos_man autos_tot</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spécifications du problème de `tsbalancing()`</span></span></span>
<span class="r-in"><span><span class="va">mes_specs3</span> <span class="op">&lt;-</span> <span class="fu"><a href="rkMeta_to_blSpecs.html">rkMeta_to_blSpecs</a></span><span class="op">(</span><span class="va">mes_meta3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mes_specs3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     type        col                          row coef timeVal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     EQ       &lt;NA&gt; Marginal Total 1 (autos_tot)   NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   &lt;NA&gt;  autos_alb Marginal Total 1 (autos_tot)    1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   &lt;NA&gt; autos_sask Marginal Total 1 (autos_tot)    1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   &lt;NA&gt;  autos_man Marginal Total 1 (autos_tot)    1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   &lt;NA&gt;  autos_tot Marginal Total 1 (autos_tot)   -1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  alter       &lt;NA&gt;    Period Value Alterability   NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   &lt;NA&gt;  autos_alb    Period Value Alterability    1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   &lt;NA&gt; autos_sask    Period Value Alterability    1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   &lt;NA&gt;  autos_man    Period Value Alterability    1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  &lt;NA&gt;  autos_tot    Period Value Alterability    0      NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Données du problème</span></span></span>
<span class="r-in"><span><span class="va">mes_series3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">18</span>, <span class="fl">14</span>, <span class="fl">58</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">17</span>, <span class="fl">14</span>, <span class="fl">16</span>, <span class="fl">44</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">14</span>, <span class="fl">19</span>, <span class="fl">18</span>, <span class="fl">58</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">12</span>, <span class="fl">53</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">19</span>, <span class="fl">44</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">50</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">14</span>, <span class="fl">52</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">16</span>, <span class="fl">15</span>, <span class="fl">19</span>, <span class="fl">51</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         ncol <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                         byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                         dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"autos_alb"</span>, <span class="st">"autos_sask"</span>,</span></span>
<span class="r-in"><span>                                                 <span class="st">"autos_man"</span>, <span class="st">"autos_tot"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Réconcilier les données avec `tsraking()` (via `tsraking_driver()`)</span></span></span>
<span class="r-in"><span><span class="va">res_ratis3</span> <span class="op">&lt;-</span> <span class="fu"><a href="tsraking_driver.html">tsraking_driver</a></span><span class="op">(</span>in_ts <span class="op">=</span> <span class="va">mes_series3</span>,</span></span>
<span class="r-in"><span>                              metadata_df <span class="op">=</span> <span class="va">mes_meta3</span>,</span></span>
<span class="r-in"><span>                              temporal_grp_periodicity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">frequency</a></span><span class="op">(</span><span class="va">mes_series3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Raking period [2019-2]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ======================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Raking period [2019-3]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ======================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Raking period [2019-4]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ======================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Raking periods [2020-1 - 2020-4]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Raking period [2021-1]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ======================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Réconcilier les données avec `tsbalancing()`</span></span></span>
<span class="r-in"><span><span class="va">res_equi3</span> <span class="op">&lt;-</span> <span class="fu">tsbalancing</span><span class="op">(</span>in_ts <span class="op">=</span> <span class="va">mes_series3</span>,</span></span>
<span class="r-in"><span>                         problem_specs_df <span class="op">=</span> <span class="va">mes_specs3</span>,</span></span>
<span class="r-in"><span>                         temporal_grp_periodicity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">frequency</a></span><span class="op">(</span><span class="va">mes_series3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2019-2]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2019-3]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2019-4]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing periods [2020-1 - 2020-4]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ===================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Balancing period [2021-1]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Données initiales</span></span></span>
<span class="r-in"><span><span class="va">mes_series3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         autos_alb autos_sask autos_man autos_tot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q2        14         18        14        58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q3        17         14        16        44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q4        14         19        18        58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q1        20         18        12        53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q2        16         16        19        44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q3        14         15        16        50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q4        19         20        14        52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2021 Q1        16         15        19        51</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Les deux ensembles de données réconciliées</span></span></span>
<span class="r-in"><span><span class="va">res_ratis3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         autos_alb autos_sask autos_man autos_tot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q2  17.65217   22.69565  17.65217        58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q3  15.91489   13.10638  14.97872        44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q4  15.92157   21.60784  20.47059        58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q1  21.15283   19.04513  12.80204        53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q2  13.74700   13.75373  16.49927        44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q3  15.50782   16.62184  17.87034        50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q4  18.59234   19.57931  13.82835        52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2021 Q1  16.32000   15.30000  19.38000        51</span>
<span class="r-in"><span><span class="va">res_equi3</span><span class="op">$</span><span class="va">out_ts</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         autos_alb autos_sask autos_man autos_tot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q2  17.65217   22.69565  17.65217        58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q3  15.91489   13.10638  14.97872        44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2019 Q4  15.92157   21.60784  20.47059        58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q1  21.15283   19.04513  12.80204        53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q2  13.74700   13.75373  16.49927        44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q3  15.50782   16.62184  17.87034        50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2020 Q4  18.59234   19.57931  13.82835        52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2021 Q1  16.32000   15.30000  19.38000        51</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Vérifier la présence de solutions de `tsbalancing()` invalides</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">res_equi3</span><span class="op">$</span><span class="va">proc_grp_df</span><span class="op">$</span><span class="va">sol_status_val</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Afficher les écarts maximaux des contraintes en sortie dans les solutions de `tsbalancing()`</span></span></span>
<span class="r-in"><span><span class="va">res_equi3</span><span class="op">$</span><span class="va">proc_grp_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proc_grp_label"</span>, <span class="st">"max_discr"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    proc_grp_label    max_discr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          2019-2 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2019-3 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          2019-4 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2020-1 - 2020-4 7.105427e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          2021-1 0.000000e+00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Confirmer que les deux solutions (`tsraking() et `tsbalancing()`) sont les mêmes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">res_ratis3</span>, <span class="va">res_equi3</span><span class="op">$</span><span class="va">out_ts</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table des matières"><h2>Sur cette page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Développé par Michel Ferland, Statistics Canada.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site créé avec <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

