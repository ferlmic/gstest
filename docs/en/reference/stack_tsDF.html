<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stack time series data — stack_tsDF • gstest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stack time series data — stack_tsDF"><meta name="description" content="
Convert a multivariate time series data frame (see ts_to_tsDF()) for the benchmarking functions
(benchmarking() and stock_benchmarking()) into a stacked (tall) data frame with four variables (columns):
one (1) for the series name
two (2) for the data point identification (year and period)
one (1) for the data point value


Missing (NA) series values are not included in the output stacked data frame by default. Specify argument
keep_NA = TRUE in order to keep them.
This function is useful when intending to use the by argument (BY-group processing mode) of the benchmarking
functions in order to benchmark multiple series in a single function call."><meta property="og:description" content="
Convert a multivariate time series data frame (see ts_to_tsDF()) for the benchmarking functions
(benchmarking() and stock_benchmarking()) into a stacked (tall) data frame with four variables (columns):
one (1) for the series name
two (2) for the data point identification (year and period)
one (1) for the data point value


Missing (NA) series values are not included in the output stacked data frame by default. Specify argument
keep_NA = TRUE in order to keep them.
This function is useful when intending to use the by argument (BY-group processing mode) of the benchmarking
functions in order to benchmark multiple series in a single function call."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gstest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gstest.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmarking-cookbook.html">Benchmarking CookBook</a></li>
    <li><a class="dropdown-item" href="../articles/benchmarking-demo-script.html">A Beginner's Benchmarking Demo Script</a></li>
    <li><a class="dropdown-item" href="../articles/osqp-settings-sequence-dataframe.html">OSQP Settings Sequence Data Frame</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/tree/main/">G-Series 3.0 (latest - R package gstest 3.0.0)</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/releases/tag/v2.0/">G-Series 2.0 (SAS® version)</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/releases/tag/v1.04/">G-Series 1.04 (SAS® version)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ferlmic/gstest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>

    <ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="#" onclick="window.location = location.href.replace('/en/','/fr/');"><span class="fa fa-language fa-lg"></span> Français</a></li></ul></div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stack time series data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ferlmic/gstest/tree/main/R/stack_tsDF.R" class="external-link"><code>R/stack_tsDF.R</code></a></small>
      <div class="d-none name"><code>stack_tsDF.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p></p>
<p>Convert a multivariate time series data frame (see <code><a href="ts_to_tsDF.html">ts_to_tsDF()</a></code>) for the benchmarking functions
(<code><a href="benchmarking.html">benchmarking()</a></code> and <code><a href="stock_benchmarking.html">stock_benchmarking()</a></code>) into a stacked (tall) data frame with four variables (columns):</p><ul><li><p>one (1) for the series name</p></li>
<li><p>two (2) for the data point identification (year and period)</p></li>
<li><p>one (1) for the data point value</p></li>
</ul><p>Missing (<code>NA</code>) series values are not included in the output stacked data frame by default. Specify argument
<code>keep_NA = TRUE</code> in order to keep them.</p>
<p>This function is useful when intending to use the <code>by</code> argument (<em>BY-group</em> processing mode) of the benchmarking
functions in order to benchmark multiple series in a single function call.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stack_tsDF</span><span class="op">(</span></span>
<span>  <span class="va">ts_df</span>,</span>
<span>  ser_cName <span class="op">=</span> <span class="st">"series"</span>,</span>
<span>  yr_cName <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  per_cName <span class="op">=</span> <span class="st">"period"</span>,</span>
<span>  val_cName <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  keep_NA <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ts-df">ts_df<a class="anchor" aria-label="anchor" href="#arg-ts-df"></a></dt>
<dd><p>(mandatory)</p>
<p>Data frame, or object to be coerced to one, that contains the multivariate time series data to be stacked.</p></dd>


<dt id="arg-ser-cname">ser_cName<a class="anchor" aria-label="anchor" href="#arg-ser-cname"></a></dt>
<dd><p>(optional)</p>
<p>String specifying the name of the character variable (column) in the output stacked data frame that will
contain the series names (name of the time series variables in the input multivariate time series data
frame). This variable can then be used as the BY-group variable (argument <code>by</code>) with the benchmarking functions.</p>
<p><strong>Default value</strong> is <code>ser_cName = "series"</code>.</p></dd>


<dt id="arg-yr-cname-per-cname">yr_cName, per_cName<a class="anchor" aria-label="anchor" href="#arg-yr-cname-per-cname"></a></dt>
<dd><p>(optional)</p>
<p>Strings specifying the name of the numeric variables (columns) in the input multivariate time series data frame
that contain the data point year and period (cycle) identifiers. These variables are <em>transferred</em> to the output
stacked data frame with the same variable names.</p>
<p><strong>Default values</strong> are <code>yr_cName = "year"</code> and <code>per_cName   = "period"</code>.</p></dd>


<dt id="arg-val-cname">val_cName<a class="anchor" aria-label="anchor" href="#arg-val-cname"></a></dt>
<dd><p>(optional)</p>
<p>String specifying the name of the numeric variable (column) in the output stacked data frame that will
contain the data point values.</p>
<p><strong>Default value</strong> is <code>val_cName = "value"</code>.</p></dd>


<dt id="arg-keep-na">keep_NA<a class="anchor" aria-label="anchor" href="#arg-keep-na"></a></dt>
<dd><p>(optional)</p>
<p>Logical argument specifying whether <code>NA</code> time series values in the input multivariate time series data frame
should be kept in the output stacked data frame.</p>
<p><strong>Default value</strong> is <code>keep_NA = FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a data frame with four variables:</p><ul><li><p>Series name, type character (see argument <code>ser_cName</code>)</p></li>
<li><p>Data point year, type numeric (see argument <code>yr_cName</code>)</p></li>
<li><p>Data point period, type numeric (see argument <code>per_cName</code>)</p></li>
<li><p>Data point value, type numeric (see argument <code>val_cName</code>)</p></li>
</ul><p>Note: the function returns a "data.frame" object than can be explicitly coerced to another type of object
with the appropriate <code>as*()</code> function (e.g., <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">tibble::as_tibble()</a></code> would coerce it to a tibble).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="unstack_tsDF.html">unstack_tsDF()</a></code> <code><a href="stack_bmkDF.html">stack_bmkDF()</a></code> <code><a href="ts_to_tsDF.html">ts_to_tsDF()</a></code> <code><a href="benchmarking.html">benchmarking()</a></code> <code><a href="stock_benchmarking.html">stock_benchmarking()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a data frame with 2 quarterly indicators series</span></span></span>
<span class="r-in"><span><span class="co"># (with missing values for the last 2 quarters)</span></span></span>
<span class="r-in"><span><span class="va">my_indicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts_to_tsDF.html">ts_to_tsDF</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ser1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">*</span>  <span class="fl">10</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                          ser2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">*</span> <span class="fl">100</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_indicators</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   year period ser1 ser2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2019      1   10  100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2019      2   20  200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2019      3   30  300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2019      4   40  400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2020      1   50  500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2020      2   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 2020      3   NA   NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stack the indicator series ...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># discarding `NA` values in the output stacked data frame (default behavior)</span></span></span>
<span class="r-in"><span><span class="fu">stack_tsDF</span><span class="op">(</span><span class="va">my_indicators</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    series year period value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    ser1 2019      1    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    ser1 2019      2    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    ser1 2019      3    30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    ser1 2019      4    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    ser1 2020      1    50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    ser2 2019      1   100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    ser2 2019      2   200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    ser2 2019      3   300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    ser2 2019      4   400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   ser2 2020      1   500</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># keeping `NA` values in the output stacked data frame</span></span></span>
<span class="r-in"><span><span class="fu">stack_tsDF</span><span class="op">(</span><span class="va">my_indicators</span>, keep_NA <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    series year period value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    ser1 2019      1    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    ser1 2019      2    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    ser1 2019      3    30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    ser1 2019      4    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    ser1 2020      1    50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    ser1 2020      2    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    ser1 2020      3    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    ser2 2019      1   100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    ser2 2019      2   200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   ser2 2019      3   300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   ser2 2019      4   400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   ser2 2020      1   500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   ser2 2020      2    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   ser2 2020      3    NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using custom variable (column) names</span></span></span>
<span class="r-in"><span><span class="fu">stack_tsDF</span><span class="op">(</span><span class="va">my_indicators</span>, ser_cName <span class="op">=</span> <span class="st">"ser_name"</span>, val_cName <span class="op">=</span> <span class="st">"ser_val"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ser_name year period ser_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      ser1 2019      1      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      ser1 2019      2      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      ser1 2019      3      30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      ser1 2019      4      40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      ser1 2020      1      50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      ser2 2019      1     100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      ser2 2019      2     200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      ser2 2019      3     300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      ser2 2019      4     400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     ser2 2020      1     500</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michel Ferland, Statistics Canada.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

