<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Restore temporal constraints — benchmarking • gstest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Restore temporal constraints — benchmarking"><meta name="description" content="
Replication of the G-Series 2.0 SAS\(^\circledR\) BENCHMARKING procedure (PROC BENCHMARKING).
See the G-Series 2.0 documentation for details (Statistics Canada 2016).
This function ensures coherence between time series data of the same target variable measured at different
frequencies (e.g., sub-annually and annually). Benchmarking consists of imposing the level of the benchmark
series (e.g., annual data) while minimizing the revisions of the observed movement in the indicator series
(e.g.,  sub-annual data) as much as possible. The function also allows nonbinding benchmarking where the
benchmark series can also be revised.
The function may also be used for benchmarking-related topics such as temporal distribution
(the reciprocal action of benchmarking: disaggregation of the benchmark series into more frequent observations),
calendarization (a special case of temporal distribution) and linking (the connection of different time series
segments into a single consistent time series).
Several series can be benchmarked in a single function call."><meta property="og:description" content="
Replication of the G-Series 2.0 SAS\(^\circledR\) BENCHMARKING procedure (PROC BENCHMARKING).
See the G-Series 2.0 documentation for details (Statistics Canada 2016).
This function ensures coherence between time series data of the same target variable measured at different
frequencies (e.g., sub-annually and annually). Benchmarking consists of imposing the level of the benchmark
series (e.g., annual data) while minimizing the revisions of the observed movement in the indicator series
(e.g.,  sub-annual data) as much as possible. The function also allows nonbinding benchmarking where the
benchmark series can also be revised.
The function may also be used for benchmarking-related topics such as temporal distribution
(the reciprocal action of benchmarking: disaggregation of the benchmark series into more frequent observations),
calendarization (a special case of temporal distribution) and linking (the connection of different time series
segments into a single consistent time series).
Several series can be benchmarked in a single function call."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gstest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gstest.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmarking-cookbook.html">Benchmarking CookBook</a></li>
    <li><a class="dropdown-item" href="../articles/benchmarking-demo-script.html">A Beginner's Benchmarking Demo Script</a></li>
    <li><a class="dropdown-item" href="../articles/osqp-settings-sequence-dataframe.html">OSQP Settings Sequence Data Frame</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/tree/main/">G-Series 3.0 (latest - R package gstest 3.0.0)</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/releases/tag/v2.0/">G-Series 2.0 (SAS® version)</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/releases/tag/v1.04/">G-Series 1.04 (SAS® version)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ferlmic/gstest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>

    <ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="#" onclick="window.location = location.href.replace('/en/','/fr/');"><span class="fa fa-language fa-lg"></span> Français</a></li></ul></div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Restore temporal constraints</h1>
      <small class="dont-index">Source: <a href="https://github.com/ferlmic/gstest/tree/main/R/benchmarking.R" class="external-link"><code>R/benchmarking.R</code></a></small>
      <div class="d-none name"><code>benchmarking.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p></p>
<p><em>Replication of the G-Series 2.0 SAS\(^\circledR\) BENCHMARKING procedure (PROC BENCHMARKING).
See the G-Series 2.0 documentation for details (Statistics Canada 2016).</em></p>
<p>This function ensures coherence between time series data of the same target variable measured at different
frequencies (e.g., sub-annually and annually). Benchmarking consists of imposing the level of the benchmark
series (e.g., annual data) while minimizing the revisions of the observed movement in the indicator series
(e.g.,  sub-annual data) as much as possible. The function also allows nonbinding benchmarking where the
benchmark series can also be revised.</p>
<p>The function may also be used for benchmarking-related topics such as <em>temporal distribution</em>
(the reciprocal action of benchmarking: disaggregation of the benchmark series into more frequent observations),
<em>calendarization</em> (a special case of temporal distribution) and <em>linking</em> (the connection of different time series
segments into a single consistent time series).</p>
<p>Several series can be benchmarked in a single function call.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">benchmarking</span><span class="op">(</span></span>
<span>  <span class="va">series_df</span>,</span>
<span>  <span class="va">benchmarks_df</span>,</span>
<span>  <span class="va">rho</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">biasOption</span>,</span>
<span>  bias <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  tolV <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  tolP <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  warnNegResult <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tolN <span class="op">=</span> <span class="op">-</span><span class="fl">0.001</span>,</span>
<span>  var <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  with <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span></span>
<span>  <span class="co"># New in G-Series 3.0</span></span>
<span>  constant <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  negInput_option <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  allCols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-series-df">series_df<a class="anchor" aria-label="anchor" href="#arg-series-df"></a></dt>
<dd><p>(mandatory)</p>
<p>Data frame, or object to be coerced to one, that contains the indicator time series data to be benchmarked.
In addition to the series data variable(s), specified with argument <code>var</code>, the data frame must also contain
two numeric variables, <code>year</code> and <code>period</code>, identifying the periods of the indicator time series.</p></dd>


<dt id="arg-benchmarks-df">benchmarks_df<a class="anchor" aria-label="anchor" href="#arg-benchmarks-df"></a></dt>
<dd><p>(mandatory)</p>
<p>Data frame, or object to be coerced to one, that contains the benchmarks. In addition to the benchmarks
data variable(s), specified with argument <code>with</code>, the data frame must also contain four numeric variables,
<code>startYear</code>, <code>startPeriod</code>, <code>endYear</code> and <code>endPeriod</code>, identifying the indicator time series periods covered
by each benchmark.</p></dd>


<dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>(mandatory)</p>
<p>Real number in the \([0,1]\) interval that specifies the value of the autoregressive parameter
\(\rho\). See section <strong>Details</strong> for more information on the effect of parameter \(\rho\).</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>(mandatory)</p>
<p>Real number, with suggested values in the \([-3,3]\) interval, that specifies the value of the
adjustment model parameter \(\lambda\). Typical values are <code>lambda = 0.0</code> for an additive model
and <code>lambda = 1.0</code> for a proportional model.</p></dd>


<dt id="arg-biasoption">biasOption<a class="anchor" aria-label="anchor" href="#arg-biasoption"></a></dt>
<dd><p>(mandatory)</p>
<p>Specification of the bias estimation option:</p><ul><li><p><code>1</code>: Do not estimate the bias. The bias used to correct the indicator series will be the value
specified with argument <code>bias</code>.</p></li>
<li><p><code>2</code>: Estimate the bias, display the result, but do not use it. The bias used to correct the indicator
series will be the value specified with argument <code>bias</code>.</p></li>
<li><p><code>3</code>: Estimate the bias, display the result and use the estimated bias to correct the indicator series.
Any value specified with argument <code>bias</code> will be ignored.</p></li>
</ul><p>Argument <code>biasOption</code> is ignored when <code>rho = 1.0</code>. See section <strong>Details</strong> for more information on the bias.</p></dd>


<dt id="arg-bias">bias<a class="anchor" aria-label="anchor" href="#arg-bias"></a></dt>
<dd><p>(optional)</p>
<p>Real number, or <code>NA</code>, specifying the value of the user-defined bias to be used for the correction of the
indicator series prior to benchmarking. The bias is added to the indicator series with an additive model
(argument  <code>lambda = 0.0</code>) while it is multiplied otherwise (argument <code>lambda != 0.0</code>). No bias
correction is applied when <code>bias = NA</code>, which is equivalent to specifying <code>bias = 0.0</code> when <code>lambda = 0.0</code>
and <code>bias = 1.0</code> otherwise. Argument <code>bias</code> is ignored when <code>biasOption = 3</code> or <code>rho = 1.0</code>. See section
<strong>Details</strong> for more information on the bias.</p>
<p><strong>Default value</strong> is <code>bias = NA</code> (no user-defined bias).</p></dd>


<dt id="arg-tolv-tolp">tolV, tolP<a class="anchor" aria-label="anchor" href="#arg-tolv-tolp"></a></dt>
<dd><p>(optional)</p>
<p>Nonnegative real number, or <code>NA</code>, specifying the tolerance, in absolute value or percentage, to be used
for the validation of the output binding benchmarks (alterability coefficient of \(0.0\)). This validation
compares the input binding benchmark values with the equivalent values calculated from the benchmarked series
(output) data. Arguments <code>tolV</code> and <code>tolP</code> cannot be both specified (one must be specified while the other
must be <code>NA</code>).</p>
<p><strong>Example:</strong> to set a tolerance of 10 <em>units</em>, specify <code>tolV = 10, tolP = NA</code>; to set a tolerance of 1%,
specify <code>tolV = NA, tolP = 0.01</code>.</p>
<p><strong>Default values</strong> are <code>tolV = 0.001</code> and <code>tolP = NA</code>.</p></dd>


<dt id="arg-warnnegresult">warnNegResult<a class="anchor" aria-label="anchor" href="#arg-warnnegresult"></a></dt>
<dd><p>(optional)</p>
<p>Logical argument specifying whether a warning message is generated when a negative value created by the
function in the benchmarked (output) series is smaller than the threshold specified by argument <code>tolN</code>.</p>
<p><strong>Default value</strong> is <code>warnNegResult = TRUE</code>.</p></dd>


<dt id="arg-toln">tolN<a class="anchor" aria-label="anchor" href="#arg-toln"></a></dt>
<dd><p>(optional)</p>
<p>Negative real number specifying the threshold for the identification of negative values. A value is
considered negative when it is smaller than this threshold.</p>
<p><strong>Default value</strong> is <code>tolN = -0.001</code>.</p></dd>


<dt id="arg-var">var<a class="anchor" aria-label="anchor" href="#arg-var"></a></dt>
<dd><p>(optional)</p>
<p>String vector (minimum length of 1) specifying the variable name(s) in the indicator series data frame
(argument <code>series_df</code>) containing the values and (optionally) the user-defined alterability coefficients
of the series to be benchmarked. These variables must be numeric.</p>
<p>The syntax is <code>var = c("series1 &lt;/ alt_ser1&gt;", "series2 &lt;/ alt_ser2&gt;", ...)</code>. Default alterability
coefficients of \(1.0\) are used when a user-defined alterability coefficients variable is not specified
alongside an indicator series variable. See section <strong>Details</strong> for more information on alterability coefficients.</p>
<p><strong>Example:</strong> <code>var = "value / alter"</code> would benchmark indicator series data frame variable <code>value</code> with the
alterability coefficients contained in variable <code>alter</code> while <code>var = c("value / alter", "value2")</code> would
additionally benchmark variable <code>value2</code> with default alterability coefficients of \(1.0\).</p>
<p><strong>Default value</strong> is <code>var = "value"</code> (benchmark variable <code>value</code> using default alterability coefficients of
\(1.0\)).</p></dd>


<dt id="arg-with">with<a class="anchor" aria-label="anchor" href="#arg-with"></a></dt>
<dd><p>(optional)</p>
<p>String vector (same length as argument <code>var</code>), or <code>NULL</code>, specifying the variable name(s) in the benchmarks data
frame (argument <code>benchmarks_df</code>) containing the values and (optionally) the user-defined alterability coefficients
of the benchmarks. These variables must be numeric. Specifying <code>with = NULL</code> results in using benchmark variable(s)
with the same names(s) as those specified with argument <code>var</code> without user-defined benchmark alterability coefficients
(i.e., default alterability coefficients of \(0.0\) corresponding to binding benchmarks).</p>
<p>The syntax is <code>with = NULL</code> or <code>with = c("bmk1 &lt;/ alt_bmk1&gt;", "bmk2 &lt;/ alt_bmk2&gt;", ...)</code>. Default alterability
coefficients of \(0.0\) (binding benchmarks) are used when a user-defined alterability coefficients variable
is not specified alongside a benchmark variable. See section <strong>Details</strong> for more information on alterability
coefficients.</p>
<p><strong>Example:</strong> <code>with = "val_bmk"</code> would use benchmarks data frame variable <code>val_bmk</code> with default benchmark
alterability coefficients of \(0.0\) to benchmark the indicator series while
<code>with = c("val_bmk", "val_bmk2 / alt_bmk2")</code> would additionally benchmark a second indicator series using
benchmark variable <code>val_bmk2</code> with the benchmark alterability coefficients contained in variable <code>alt_bmk2</code>.</p>
<p><strong>Default value</strong> is <code>with = NULL</code> (same benchmark variable(s) as argument <code>var</code> using default benchmark
alterability coefficients of \(0.0\)).</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>(optional)</p>
<p>String vector (minimum length of 1), or <code>NULL</code>, specifying the variable name(s) in the input data frames
(arguments <code>series_df</code> and <code>benchmarks_df</code>) to be used to form groups (for <em>BY-group</em> processing) and allow
the benchmarking of multiple series in a single function call. BY-group variables can be numeric or
character (factors or not), must be present in both input data frames and will appear in all three output
data frames (see section <strong>Value</strong>). BY-group processing is not  implemented when <code>by = NULL</code>. See
"Benchmarking Multiple Series" in section <strong>Details</strong> for more information.</p>
<p><strong>Default value</strong> is <code>by = NULL</code> (no BY-group processing).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>(optional)</p>
<p>Logical argument specifying whether information on intermediate steps with execution time (real time,
not CPU time) should be displayed. Note that specifying argument <code>quiet = TRUE</code> would <em>nullify</em> argument
<code>verbose</code>.</p>
<p><strong>Default value</strong> is <code>verbose = FALSE</code>.</p></dd>


<dt id="arg-constant">constant<a class="anchor" aria-label="anchor" href="#arg-constant"></a></dt>
<dd><p>(optional)</p>
<p>Real number that specifies a value to be temporarily added to both the indicator series and the
benchmarks before solving proportional benchmarking problems (<code>lambda != 0.0</code>). The temporary
constant is removed from the final output benchmarked series. E.g., specifying a (small) constant
would allow proportional benchmarking with <code>rho = 1</code> (e.g., proportional Denton benchmarking) on
indicator series that include values of 0. Otherwise, proportional benchmarking with values of 0 in
the indicator series is only possible when <code>rho &lt; 1</code>. Specifying a constant with additive benchmarking
(<code>lambda = 0.0</code>) has no impact on the resulting benchmarked data. The data variables in the <strong>graphTable</strong>
output data frame include the constant, corresponding to the benchmarking problem that was actually solved.</p>
<p><strong>Default value</strong> is <code>constant = 0</code> (no temporary additive constant).</p></dd>


<dt id="arg-neginput-option">negInput_option<a class="anchor" aria-label="anchor" href="#arg-neginput-option"></a></dt>
<dd><p>(optional)</p>
<p>Handling of negative values in the input data for proportional benchmarking (<code>lambda != 0.0</code>):</p><ul><li><p><code>0</code>: Do not allow negative values with proportional benchmarking. An error message is displayed in the
presence of negative values in the input indicator series or benchmarks and missing (<code>NA</code>) values are
returned for the benchmarked series. This corresponds to the G-Series 2.0 behaviour.</p></li>
<li><p><code>1</code>: Allow negative values with proportional benchmarking but display a warning message.</p></li>
<li><p><code>2</code>: Allow negative values with proportional benchmarking without displaying any message.</p></li>
</ul><p><strong>Default value</strong> is <code>negInput_option = 0</code> (do not allow negative values with proportional benchmarking).</p></dd>


<dt id="arg-allcols">allCols<a class="anchor" aria-label="anchor" href="#arg-allcols"></a></dt>
<dd><p>(optional)</p>
<p>Logical argument specifying whether all variables in the indicator series data frame (argument <code>series_df</code>),
other than <code>year</code> and <code>period</code>, determine the set of series to benchmark. Values specified with arguments <code>var</code>
and <code>with</code> are ignored when <code>allCols = TRUE</code>, which automatically implies default alterability coefficients,
and variables with the same names as the indicator series must exist in the benchmarks data frame (argument
<code>benchmarks_df</code>).</p>
<p><strong>Default value</strong> is <code>allCols = FALSE</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>(optional)</p>
<p>Logical argument specifying whether or not to display only essential information such as warning messages,
error messages and variable (series) or BY-group information when multiple series are benchmarked in a single call
to the function. We advise against <em>wrapping</em> your <code>benchmarking()</code> call with <code><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages()</a></code> to further suppress
the display of variable (series) or BY-group information when processing multiple series as this would make
troubleshooting difficult in case of issues with individual series. Note that specifying <code>quiet = TRUE</code> would
also <em>nullify</em> argument <code>verbose</code>.</p>
<p><strong>Default value</strong> is <code>quiet = FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns is a list of three data frames:</p><ul><li><p><strong>series</strong>: data frame containing the benchmarked data (primary function output). BY variables specified
with argument <code>by</code> would be included in the data frame but not alterability coefficient variables
specified with argument <code>var</code>.</p></li>
<li><p><strong>benchmarks</strong>: copy of the input benchmarks data frame (excluding invalid benchmarks when applicable).
BY variables specified with argument <code>by</code> would be included in the data frame but not alterability
coefficient variables specified with argument <code>with</code>.</p></li>
<li><p><strong>graphTable</strong>: data frame containing supplementary data useful for producing analytical tables and graphs
(see function <code><a href="plot_graphTable.html">plot_graphTable()</a></code>). It contains the following variables in addition to the BY variables
specified with argument <code>by</code>:</p><ul><li><p><code>varSeries</code>: Name of the indicator series variable</p></li>
<li><p><code>varBenchmarks</code>: Name of the benchmark variable</p></li>
<li><p><code>altSeries</code>: Name of the user-defined indicator series alterability coefficients variable</p></li>
<li><p><code>altSeriesValue</code>: Indicator series alterability coefficients</p></li>
<li><p><code>altbenchmarks</code>: Name of the user-defined benchmark alterability coefficients variable</p></li>
<li><p><code>altBenchmarksValue</code>: Benchmark alterability coefficients</p></li>
<li><p><code>t</code>: Indicator series period identifier (1 to \(T\))</p></li>
<li><p><code>m</code>: Benchmark coverage periods identifier (1 to \(M\))</p></li>
<li><p><code>year</code>: Data point calendar year</p></li>
<li><p><code>period</code>: Data point period (cycle) value (1 to <code>periodicity</code>)</p></li>
<li><p><code>constant</code>: Temporary additive constant (argument <code>constant</code>)</p></li>
<li><p><code>rho</code>: Autoregressive parameter \(\rho\) (argument <code>rho</code>)</p></li>
<li><p><code>lambda</code>: Adjustment model parameter \(\lambda\) (argument <code>lambda</code>)</p></li>
<li><p><code>bias</code>: Bias adjustment (default, user-defined or estimated bias according to arguments <code>biasOption</code> and <code>bias</code>)</p></li>
<li><p><code>periodicity</code>: The maximum number of periods in a year (e.g. 4 for a quarterly indicator series)</p></li>
<li><p><code>date</code>: Character string combining the values of variables <code>year</code> and <code>period</code></p></li>
<li><p><code>subAnnual</code>: Indicator series values</p></li>
<li><p><code>benchmarked</code>: Benchmarked series values</p></li>
<li><p><code>avgBenchmark</code>: Benchmark values divided by the number of coverage periods</p></li>
<li><p><code>avgSubAnnual</code>: Indicator series values (variable <code>subAnnual</code>) averaged over the benchmark coverage period</p></li>
<li><p><code>subAnnualCorrected</code>: Bias corrected indicator series values</p></li>
<li><p><code>benchmarkedSubAnnualRatio</code>: Difference (\(\lambda = 0\)) or ratio (\(\lambda \ne 0\)) of the values
of variables <code>benchmarked</code> and <code>subAnnual</code></p></li>
<li><p><code>avgBenchmarkSubAnnualRatio</code>: Difference (\(\lambda = 0\)) or ratio (\(\lambda \ne 0\)) of the values
of variables <code>avgBenchmark</code> and <code>avgSubAnnual</code></p></li>
<li><p><code>growthRateSubAnnual</code>: Period to period difference (\(\lambda = 0\)) or relative difference (\(\lambda \ne 0\)) of the indicator series values (variable <code>subAnnual</code>)</p></li>
<li><p><code>growthRateBenchmarked</code>: Period to period difference (\(\lambda = 0\)) or relative difference (\(\lambda \ne 0\)) of the benchmarked series values (variable <code>benchmarked</code>)</p></li>
</ul></li>
</ul><p>Notes:</p><ul><li><p>The output <strong>benchmarks</strong> data frame always contains the original benchmarks provided in the input
benchmarks data frame. Modified nonbinding benchmarks, when applicable, can be recovered (calculated)
from the output <strong>series</strong> data frame.</p></li>
<li><p>The function returns a <code>NULL</code> object if an error occurs before data processing could start. Otherwise,
if execution gets far enough so that data processing could start, then an incomplete object would be
returned in case of errors (e.g., output <strong>series</strong> data frame with <code>NA</code> values for the benchmarked data).</p></li>
<li><p>The function returns "data.frame" objects that can be explicitly coerced to other types of objects with
the appropriate <code>as*()</code> function (e.g., <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">tibble::as_tibble()</a></code> would coerce any of them to a tibble).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When \(\rho &lt; 1\), this function returns the generalized least squared solution of a special case of the general
regression-based benchmarking model proposed by Dagum and Cholette (2006). The model, in matrix form, is:
$$\displaystyle
\begin{bmatrix} s^\dagger \\ a \end{bmatrix} =
\begin{bmatrix} I \\ J \end{bmatrix} \theta +
\begin{bmatrix} e \\ \varepsilon \end{bmatrix}
$$
where</p><ul><li><p>\(a\) is the vector of length \(M\) of the benchmarks.</p></li>
<li><p>\(s^\dagger = \left\{
    \begin{array}{cl}
      s + b &amp; \text{if } \lambda = 0 \\
      s \cdot b  &amp; \text{otherwise}
    \end{array} \right.
  \) is the vector of length \(T\) of the bias corrected
indicator series values, with \(s\) denoting the initial (input) indicator series.</p></li>
<li><p>\(b\) is the bias, which is specified with argument <code>bias</code> when argument <code>bias_option != 3</code> or, when <code>bias_option = 3</code>,
is estimated as \(\hat{b} = \left\{
    \begin{array}{cl}
      \frac{{1_M}^\mathrm{T} (a - Js)}{{1_M}^\mathrm{T} J 1_T} &amp; \text{if } \lambda = 0 \\
      \frac{{1_M}^\mathrm{T} a}{{1_M}^\mathrm{T} Js} &amp; \text{otherwise}
    \end{array} \right.
  \), where
\(1_X = (1, ..., 1)^\mathrm{T}\) is a vector of \(1\) of length \(X\).</p></li>
<li><p>\(J\) is the \(M \times T\) matrix of temporal aggregation constraints with elements
\(j_{m, t} = \left\{
    \begin{array}{cl}
      1 &amp; \text{if benchmark } m \text{ covers period } t \\
      0 &amp; \text{otherwise}
    \end{array} \right.
  \).</p></li>
<li><p>\(\theta\) is the vector of the final (benchmarked) series values.</p></li>
<li><p>\(e \sim \left( 0, V_e \right)\) is the vector of the measurement errors of \(s^\dagger\)
with covariance matrix \(V_e = C \Omega_e C\).</p></li>
<li><p>\(C = \mathrm{diag} \left( \sqrt{c_{s^\dagger}} \left| s^\dagger \right|^\lambda \right)\) where \(c_{s^\dagger}\) is the vector of the alterability coefficients of \(s^\dagger\),
assuming \(0^0 = 1\).</p></li>
<li><p>\(\Omega_e\) is a \(T \times T\) matrix with elements \(\omega_{e_{i,j}} = \rho^{|i-j|}\) representing the
autocorrelation of an AR(1) process, again assuming \(0^0 = 1\).</p></li>
<li><p>\(\varepsilon \sim (0, V_\varepsilon)\) is the vector of the measurement errors of the benchmarks
\(a\) with covariance matrix \(V_\varepsilon = \mathrm{diag} \left( c_a a \right)\) where \(c_a\)
is the vector of the alterability coefficients of the benchmarks \(a\).</p></li>
</ul><p>The generalized least squared solution is:
$$\displaystyle
\hat{\theta} = s^\dagger + V_e J^{\mathrm{T}} \left( J V_e J^{\mathrm{T}} + V_\varepsilon \right)^+ \left( a - J s^\dagger \right)
$$
where \(A^{+}\) designates the Moore-Penrose inverse of matrix \(A\).</p>
<p>When \(\rho = 1\), the function returns the solution of the (modified) Denton method:
$$\displaystyle
\hat{\theta} = s + W \left( a - J s \right)
$$
where</p><ul><li><p>\(W\) is the upper-right corner matrix from the following matrix product
$$
    \left[\begin{array}{cc}
      D^{+} \Delta^{\mathrm{T}} \Delta D^{+} &amp; J^{\mathrm{T}} \\
      J &amp; 0
    \end{array} \right]^{+}
    \left[\begin{array}{cc}
      D^{+} \Delta^{\mathrm{T}} \Delta D^{+} &amp; 0 \\
      J &amp; I_M
    \end{array} \right] =
    \left[\begin{array}{cc}
      I_T &amp; W \\
      0 &amp; W_\nu
    \end{array} \right]
  $$</p></li>
<li><p>\(D = \mathrm{diag} \left( \left| s \right|^\lambda \right)\), assuming \(0^0 = 1\). Note that
\(D\) corresponds to \(C\) with \(c_{s^\dagger} = 1.0\) and without bias correction (arguments
<code>bias_option = 1</code> and <code>bias = NA</code>).</p></li>
<li><p>\(\Delta\) is a \(T-1 \times T\) matrix with elements \(\delta_{i,j} = \left\{
    \begin{array}{cl}
      -1 &amp; \text{if } i=j \\
      1 &amp; \text{if } j=i+1 \\
      0 &amp; \text{otherwise}
    \end{array} \right.
  \).</p></li>
<li><p>\(W_\nu\) is a \(M \times M\) matrix associated with the Lagrange multipliers of the corresponding
minimization problem, expressed as:
$$\displaystyle
\begin{aligned}
&amp; \underset{\theta}{\text{minimize}}
&amp; &amp; \sum_{t \ge 2} \left[ \frac{\left( s_t - \theta_t \right)}{\left| s_t\right|^\lambda}
      - \frac{\left( s_{t-1} - \theta_{t-1} \right)}{\left| s_{t-1}\right|^\lambda} \right]^2 \\
&amp; \text{subject to}
&amp; &amp; a = J \theta
\end{aligned}
$$</p></li>
</ul><p>See Quenneville et al. (2006) and Dagum and Cholette (2006) for details.</p><div class="section">
<h3 id="autoregressive-parameter-rho-and-bias">Autoregressive Parameter \(\rho\) and <em>bias</em><a class="anchor" aria-label="anchor" href="#autoregressive-parameter-rho-and-bias"></a></h3>


<p>Parameter \(\rho\) (argument <code>rho</code>) is associated to the change between the (input) indicator and the (output)
benchmarked series for two consecutive periods and is often called the <em>movement preservation parameter</em>. The larger
the value of \(\rho\), the more the indicator series period to period movements are preserved in the
benchmarked series. With \(\rho = 0\), period to period movement preservation is not enforced and the
resulting benchmarking adjustments are not smooth, as in the case of prorating (\(\rho = 0\) and
\(\lambda = 0.5\)) where the adjustments take the shape of a <em>step function</em>. At the other end of the
spectrum is \(\rho = 1\), referred to as <em>Denton benchmarking</em>, where period to period movement preservation
is maximized, which results in the smoothest possible set of benchmarking adjustments available with the function.</p>
<p>The <em>bias</em> represents the expected discrepancies between the benchmarks and the indicator series. It can be
used to pre-adjust the indicator series in order to reduce, on average, the discrepancies between the two
sources of data. Bias correction, which is specified with arguments <code>biasOption</code> and <code>bias</code>, can be particularly
useful for periods not covered by benchmarks when \(\rho &lt; 1\). In this context, parameter \(\rho\) dictates the
speed at which the projected benchmarking adjustments converge to the bias (or converge to <em>no adjustment</em> without bias
correction) for periods not covered by a benchmark. The smaller the value of \(\rho\), the faster the convergence to
the bias, with immediate convergence when \(\rho = 0\) and no convergence at all (the adjustment of the last period
covered by a benchmark is repeated) when \(\rho = 1\) (Denton benchmarking). Arguments <code>biasOption</code> and <code>bias</code> are
actually ignored when \(\rho = 1\) since correcting for the bias has no impact on Denton benchmarking solutions.
The suggested value for \(\rho\) is \(0.9\) for monthly indicators and \(0.9^3 = 0.729\) for quarterly indicators,
representing a reasonable compromise between maximizing movement preservation and reducing revisions as new benchmarks
become available in the future (benchmarking <em>timeliness issue</em>). In practice, note that Denton benchmarking could be
<em>approximated</em> with the regression-based model by using a \(\rho\) value that is smaller than, but very close to,
\(1.0\) (e.g., \(\rho = 0.999\)). See Dagum and Cholette (2006) for a complete discussion on this topic.</p>
</div>

<div class="section">
<h3 id="alterability-coefficients">Alterability Coefficients<a class="anchor" aria-label="anchor" href="#alterability-coefficients"></a></h3>


<p>Alterability coefficients \(c_{s^\dagger}\) and \(c_a\) conceptually represent the measurement errors
associated with the (bias corrected) indicator time series values \(s^\dagger\) and benchmarks \(a\)
respectively. They are nonnegative real numbers which, in practice, specify the extent to which an initial value can be
modified in relation to other values. Alterability coefficients of \(0.0\) define fixed (binding) values while
alterability coefficients greater than \(0.0\) define free (nonbinding) values. Increasing the alterability coefficient
of an intial value results in more changes for that value in the benchmarking solution and, conversely, less changes when
decreasing the alterability coefficient. The default alterability coefficients are \(0.0\) for the benchmarks (binding
benchmarks) and \(1.0\) for the indicator series values (nonbinding indicator series). Important notes:</p><ul><li><p>With a value of \(\rho = 1\) (argument <code>rho = 1</code>, associated to Denton Benchmarking), only the default
alterability coefficients (\(0.0\) for a benchmark and \(1.0\) for a an indicator series value) are valid. The
specification of user-defined alterability coefficients variables is therefore not allowed. If such variables are
specified (see arguments <code>var</code> and <code>with</code>), the function ignores them and displays a warning message in the console.</p></li>
<li><p>Alterability coefficients \(c_{s^\dagger}\) come into play after the indicator series has been corrected for
the bias, when applicable (\(c_{s^\dagger}\) is associated to \(s^\dagger\), not \(s\)). This means
that specifying an alterability coefficient of \(0.0\) for a given indicator series value <strong>will not</strong> result in an unchanged
value after benchmarking <strong>with bias correction</strong> (see arguments <code>biasOption</code> and <code>bias</code>).</p></li>
</ul><p>Nonbinding benchmarks, when applicable, can be recovered (calculated) from the benchmarked series (see output data frame
<strong>series</strong> in section <strong>Value</strong>). The output <strong>benchmarks</strong> data frame always contains the original benchmarks provided
in the input benchmarks data frame (argument <code>benchmarks_df</code>).</p>
</div>

<div class="section">
<h3 id="benchmarking-multiple-series">Benchmarking Multiple Series<a class="anchor" aria-label="anchor" href="#benchmarking-multiple-series"></a></h3>


<p>Multiple series can be benchmarked in a single <code>benchmarking()</code> call, by specifying <code>allCols = TRUE</code>, by
(manually) specifying multiple variables with argument <code>var</code> (and argument <code>with</code>) or with BY-group processing
(argument <code>by != NULL</code>). An important distinction is that all indicator series specified with <code>allCols = TRUE</code>
or with argument <code>var</code> (and benchmarks with argument <code>with</code>) are expected to be of the same length, i.e., same
set of periods and same set (number) of benchmarks. Benchmarking series of different lengths (different sets of
periods) or with different sets (number) of benchmarks must be done with BY-group processing on stacked indicator
series and benchmarks input data frames (see utility functions <code><a href="stack_tsDF.html">stack_tsDF()</a></code> and <code><a href="stack_bmkDF.html">stack_bmkDF()</a></code>). Arguments
<code>by</code> and <code>var</code> can be combined in order to implement BY-group processing for multiple series as illustrated by
<em>Example 2</em> in the <strong>Examples</strong> section. While multiple variables with argument <code>var</code> (or <code>allCols = TRUE</code>)
without BY-group processing (argument <code>by = NULL</code>) is slightly more efficient (faster), a BY-group approach with
a single series variable is usually recommended as it is more general (works in all contexts). The latter is
illustrated by <em>Example 3</em> in the <strong>Examples</strong> section. The BY variables specified with argument <code>by</code> appear in
all three output data frames.</p>
</div>

<div class="section">
<h3 id="arguments-constant-and-neginput-option">Arguments <code>constant</code> and <code>negInput_option</code><a class="anchor" aria-label="anchor" href="#arguments-constant-and-neginput-option"></a></h3>


<p>These arguments extend the usage of proportional benchmarking to a larger set of problems. Their default
values correspond to the G-Series 2.0 behaviour (SAS\(^\circledR\) PROC BENCHMARKING) for which equivalent
options are not defined. Although proportional benchmarking may not necessarily be the most appropriate approach
(additive benchmarking may be more appropriate) when the values of the indicator series approach 0 (unstable
period-to-period ratios) or "cross the 0 line" and can therefore go from positive to negative and vice versa
(confusing, difficult to interpret period-to-period ratios), these cases are not invalid mathematically
speaking (i.e., the associated proportional benchmarking problem can be solved). It is strongly recommended,
however, to carefully analyze and validate the resulting benchmarked data in these situations and make sure they
correspond to reasonable, interpretable solutions.</p>
</div>

<div class="section">
<h3 id="treatment-of-missing-na-values">Treatment of Missing (<code>NA</code>) Values<a class="anchor" aria-label="anchor" href="#treatment-of-missing-na-values"></a></h3>

<ul><li><p>If a missing value appears in one of the variables of the benchmarks input data frame (other than the
BY variables), the observations with the missing values are dropped, a warning message is displayed and the
function executes.</p></li>
<li><p>If a missing value appears in the <code>year</code> and/or <code>period</code> variables of the indicator series input data frame
and BY variables are specified, the corresponding BY-group is skipped, a warning message is displayed and
the function moves on to the next BY-group. If no BY variables are specified, a warning message is displayed
and no processing is done.</p></li>
<li><p>If a missing value appears in one of the indicator series variables in the indicator series input data
frame and BY variables are specified, the corresponding BY-group is skipped, a warning message is displayed
and the function moves on to the next BY-group. If no BY variables are specified, the affected indicator
series is not processed, a warning message is displayed and the function moves on to the next indicator
series (when applicable).</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dagum, E. B. and P. Cholette (2006). <strong>Benchmarking, Temporal Distribution and Reconciliation
Methods of Time Series</strong>. Springer-Verlag, New York, Lecture Notes in Statistics, Vol. 186</p>
<p>Fortier, S. and B. Quenneville (2007). "Theory and Application of Benchmarking in Business Surveys".
<strong>Proceedings of the Third International Conference on Establishment Surveys (ICES-III)</strong>. Montréal, June 2007.</p>
<p>Latendresse, E., M. Djona and S. Fortier (2007). "Benchmarking Sub-Annual Series to Annual Totals –
From Concepts to SAS\(^\circledR\) Procedure and Enterprise Guide\(^\circledR\) Custom Task". <strong>Proceedings
of the SAS\(^\circledR\) Global Forum 2007 Conference</strong>. Cary, NC: SAS Institute Inc.</p>
<p>Quenneville, B., S. Fortier, Z.-G. Chen and E. Latendresse (2006). "Recent Developments in Benchmarking to
Annual Totals in X-12-ARIMA and at Statistics Canada". <strong>Proceedings of the Eurostat Conference on Seasonality,
Seasonal Adjustment and Their Implications for Short-Term Analysis and Forecasting</strong>. Luxembourg, May 2006.</p>
<p>Quenneville, B., P. Cholette, S. Fortier and J. Bérubé (2010). "Benchmarking Sub-Annual Indicator
Series to Annual Control Totals (Forillon v1.04.001)". <strong>Internal document</strong>. Statistics Canada, Ottawa, Canada.</p>
<p>Quenneville, B. and S. Fortier (2012). "Restoring Accounting Constraints in Time Series – Methods and
Software for a Statistical Agency". <strong>Economic Time Series: Modeling and Seasonality</strong>. Chapman &amp; Hall, New York.</p>
<p>Statistics Canada (2012). <strong>Theory and Application of Benchmarking (Course code 0436)</strong>.
Statistics Canada, Ottawa, Canada.</p>
<p>Statistics Canada (2016). "The BENCHMARKING Procedure". <strong>G-Series 2.0 User Guide</strong>.
Statistics Canada, Ottawa, Canada.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="stock_benchmarking.html">stock_benchmarking()</a></code> <code><a href="plot_graphTable.html">plot_graphTable()</a></code> <a href="bench_graphs.html">bench_graphs</a> <code><a href="plot_benchAdj.html">plot_benchAdj()</a></code> <code><a href="gs.gInv_MP.html">gs.gInv_MP()</a></code> <a href="aliases.html">aliases</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Set the working directory (for the PDF files)</span></span></span>
<span class="r-in"><span><span class="va">iniwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###########</span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Simple case with a single quarterly series to benchmark to annual values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quarterly indicator series</span></span></span>
<span class="r-in"><span><span class="va">my_series1</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts_to_tsDF.html">ts_to_tsDF</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="fl">2.4</span>, <span class="fl">3.1</span>, <span class="fl">2.2</span>, <span class="fl">2.0</span>, <span class="fl">2.6</span>, <span class="fl">3.4</span>, <span class="fl">2.4</span>, <span class="fl">2.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_series1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   year period value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2015      1   1.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2015      2   2.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2015      3   3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2015      4   2.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2016      1   2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2016      2   2.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 2016      3   3.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 2016      4   2.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 2017      1   2.3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Annual benchmarks for quarterly data</span></span></span>
<span class="r-in"><span><span class="va">my_benchmarks1</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts_to_bmkDF.html">ts_to_bmkDF</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10.3</span>, <span class="fl">10.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 start <span class="op">=</span> <span class="fl">2015</span>,</span></span>
<span class="r-in"><span>                                 frequency <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              ind_frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_benchmarks1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   startYear startPeriod endYear endPeriod value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      2015           1    2015         4  10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      2016           1    2016         4  10.2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Benchmarking using...</span></span></span>
<span class="r-in"><span><span class="co">#   - recommended `rho` value for quarterly series (`rho = 0.729`)</span></span></span>
<span class="r-in"><span><span class="co">#   - proportional model (`lambda = 1`)</span></span></span>
<span class="r-in"><span><span class="co">#   - bias-corrected indicator series with the estimated bias (`biasOption = 3`)</span></span></span>
<span class="r-in"><span><span class="va">out_bench1</span> <span class="op">&lt;-</span> <span class="fu">benchmarking</span><span class="op">(</span><span class="va">my_series1</span>,</span></span>
<span class="r-in"><span>                           <span class="va">my_benchmarks1</span>,</span></span>
<span class="r-in"><span>                           rho <span class="op">=</span> <span class="fl">0.729</span>,</span></span>
<span class="r-in"><span>                           lambda <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                           biasOption <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --- Package gstest 3.0.0 - (EN) 'G-Series' in 'R' | (FR) 'G-Séries' en 'R' ---</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created on April 8, 2025, at 3:40:01 PM EDT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> URL: https://ferlmic.github.io/gstest/en/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      https://ferlmic.github.io/gstest/fr/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Email: g-series@statcan.gc.ca</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> benchmarking() function:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     series_df          = my_series1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     benchmarks_df      = my_benchmarks1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rho                = 0.729</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lambda             = 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     biasOption         = 3 (Calculate bias, use calculated bias)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     bias               (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolV               = 0.001 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     warnNegResult      = TRUE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolN               = -0.001 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     var                = value (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     with               = NULL (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     by                 = NULL (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     verbose            = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)constant        = 0 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)negInput_option = 0 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)allCols         = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)quiet           = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*) indicates new arguments in G-Series 3.0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of observations in the BENCHMARKS data frame .............: 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid observations in the BENCHMARKS data frame .......: 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of observations in the SERIES data frame .................: 9</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid observations in the SERIES data frame ...........: 9</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BIAS = 0.0625 (calculated)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate the benchmarking graphs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_graphTable.html">plot_graphTable</a></span><span class="op">(</span><span class="va">out_bench1</span><span class="op">$</span><span class="va">graphTable</span>, <span class="st">"Ex1_graphs.pdf"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating the benchmarking graphics. Please be patient...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking graphics generated for 1 series in the following PDF file:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   %TEMP%\Rtmp0M5DK2\Ex1_graphs.pdf</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###########</span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Two quarterly series to benchmark to annual values,</span></span></span>
<span class="r-in"><span><span class="co">#            with BY-groups and user-defined alterability coefficients</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sales data (same sales for groups A and B; only alter coefs for van sales differ)</span></span></span>
<span class="r-in"><span><span class="va">qtr_sales</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="co"># Car sales</span></span></span>
<span class="r-in"><span>                         <span class="fl">1851</span>, <span class="fl">2436</span>, <span class="fl">3115</span>, <span class="fl">2205</span>, <span class="fl">1987</span>, <span class="fl">2635</span>, <span class="fl">3435</span>, <span class="fl">2361</span>, <span class="fl">2183</span>, <span class="fl">2822</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">3664</span>, <span class="fl">2550</span>, <span class="fl">2342</span>, <span class="fl">3001</span>, <span class="fl">3779</span>, <span class="fl">2538</span>, <span class="fl">2363</span>, <span class="fl">3090</span>, <span class="fl">3807</span>, <span class="fl">2631</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">2601</span>, <span class="fl">3063</span>, <span class="fl">3961</span>, <span class="fl">2774</span>, <span class="fl">2476</span>, <span class="fl">3083</span>, <span class="fl">3864</span>, <span class="fl">2773</span>, <span class="fl">2489</span>, <span class="fl">3082</span>,</span></span>
<span class="r-in"><span>                         <span class="co"># Van sales</span></span></span>
<span class="r-in"><span>                         <span class="fl">1900</span>, <span class="fl">2200</span>, <span class="fl">3000</span>, <span class="fl">2000</span>, <span class="fl">1900</span>, <span class="fl">2500</span>, <span class="fl">3800</span>, <span class="fl">2500</span>, <span class="fl">2100</span>, <span class="fl">3100</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">3650</span>, <span class="fl">2950</span>, <span class="fl">3300</span>, <span class="fl">4000</span>, <span class="fl">3290</span>, <span class="fl">2600</span>, <span class="fl">2010</span>, <span class="fl">3600</span>, <span class="fl">3500</span>, <span class="fl">2100</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">2050</span>, <span class="fl">3500</span>, <span class="fl">4290</span>, <span class="fl">2800</span>, <span class="fl">2770</span>, <span class="fl">3080</span>, <span class="fl">3100</span>, <span class="fl">2800</span>, <span class="fl">3100</span>, <span class="fl">2860</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2011</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                frequency <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"car_sales"</span>, <span class="st">"van_sales"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ann_sales</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="co"># Car sales</span></span></span>
<span class="r-in"><span>                         <span class="fl">10324</span>, <span class="fl">10200</span>, <span class="fl">10582</span>, <span class="fl">11097</span>, <span class="fl">11582</span>, <span class="fl">11092</span>,</span></span>
<span class="r-in"><span>                         <span class="co"># Van sales</span></span></span>
<span class="r-in"><span>                         <span class="fl">12000</span>, <span class="fl">10400</span>, <span class="fl">11550</span>, <span class="fl">11400</span>, <span class="fl">14500</span>, <span class="fl">16000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                start <span class="op">=</span> <span class="fl">2011</span>,</span></span>
<span class="r-in"><span>                frequency <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"car_sales"</span>, <span class="st">"van_sales"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quarterly indicator series (with default alter coefs for now)</span></span></span>
<span class="r-in"><span><span class="va">my_series2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">qtr_sales</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     alt_van <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">qtr_sales</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          <span class="fu"><a href="ts_to_tsDF.html">ts_to_tsDF</a></span><span class="op">(</span><span class="va">qtr_sales</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">qtr_sales</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     alt_van <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">qtr_sales</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          <span class="fu"><a href="ts_to_tsDF.html">ts_to_tsDF</a></span><span class="op">(</span><span class="va">qtr_sales</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set binding van sales (alter coef = 0) for 2012 Q1 and Q2 in group A (rows 5 and 6)</span></span></span>
<span class="r-in"><span><span class="va">my_series2</span><span class="op">$</span><span class="va">alt_van</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">my_series2</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    group alt_van year period car_sales van_sales</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      A       1 2011      1      1851      1900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      A       1 2011      2      2436      2200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      A       1 2011      3      3115      3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      A       1 2011      4      2205      2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      A       0 2012      1      1987      1900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      A       0 2012      2      2635      2500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      A       1 2012      3      3435      3800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      A       1 2012      4      2361      2500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      A       1 2013      1      2183      2100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     A       1 2013      2      2822      3100</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">my_series2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    group alt_van year period car_sales van_sales</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55     B       1 2017      1      2476      2770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56     B       1 2017      2      3083      3080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57     B       1 2017      3      3864      3100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58     B       1 2017      4      2773      2800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59     B       1 2018      1      2489      3100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60     B       1 2018      2      3082      2860</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Annual benchmarks for quarterly data (without alter coefs)</span></span></span>
<span class="r-in"><span><span class="va">my_benchmarks2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ann_sales</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              <span class="fu"><a href="ts_to_bmkDF.html">ts_to_bmkDF</a></span><span class="op">(</span><span class="va">ann_sales</span>, ind_frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ann_sales</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              <span class="fu"><a href="ts_to_bmkDF.html">ts_to_bmkDF</a></span><span class="op">(</span><span class="va">ann_sales</span>, ind_frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_benchmarks2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    group startYear startPeriod endYear endPeriod car_sales van_sales</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      A      2011           1    2011         4     10324     12000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      A      2012           1    2012         4     10200     10400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      A      2013           1    2013         4     10582     11550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      A      2014           1    2014         4     11097     11400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      A      2015           1    2015         4     11582     14500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      A      2016           1    2016         4     11092     16000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      B      2011           1    2011         4     10324     12000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      B      2012           1    2012         4     10200     10400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      B      2013           1    2013         4     10582     11550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     B      2014           1    2014         4     11097     11400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     B      2015           1    2015         4     11582     14500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     B      2016           1    2016         4     11092     16000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Benchmarking using...</span></span></span>
<span class="r-in"><span><span class="co">#   - recommended `rho` value for quarterly series (`rho = 0.729`)</span></span></span>
<span class="r-in"><span><span class="co">#   - proportional model (`lambda = 1`)</span></span></span>
<span class="r-in"><span><span class="co">#   - without bias correction (`biasOption = 1` and `bias` not specified)</span></span></span>
<span class="r-in"><span><span class="co">#   - `quiet = TRUE` to avoid generating the function header</span></span></span>
<span class="r-in"><span><span class="va">out_bench2</span> <span class="op">&lt;-</span> <span class="fu">benchmarking</span><span class="op">(</span><span class="va">my_series2</span>,</span></span>
<span class="r-in"><span>                           <span class="va">my_benchmarks2</span>,</span></span>
<span class="r-in"><span>                           rho <span class="op">=</span> <span class="fl">0.729</span>,</span></span>
<span class="r-in"><span>                           lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           biasOption <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"car_sales"</span>, <span class="st">"van_sales / alt_van"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           with <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"car_sales"</span>, <span class="st">"van_sales"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           by <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>                           quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking by-group 1 (group=A)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking indicator series [car_sales] with benchmarks [car_sales]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking indicator series [van_sales] with benchmarks [van_sales]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking by-group 2 (group=B)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking indicator series [car_sales] with benchmarks [car_sales]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking indicator series [van_sales] with benchmarks [van_sales]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate the benchmarking graphs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_graphTable.html">plot_graphTable</a></span><span class="op">(</span><span class="va">out_bench2</span><span class="op">$</span><span class="va">graphTable</span>, <span class="st">"Ex2_graphs.pdf"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating the benchmarking graphics. Please be patient...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking graphics generated for 4 series in the following PDF file:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   %TEMP%\Rtmp0M5DK2\Ex2_graphs.pdf</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check the value of van sales for 2012 Q1 and Q2 in group A (fixed values)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">my_series2</span><span class="op">$</span><span class="va">van_sales</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span>, <span class="va">out_bench2</span><span class="op">$</span><span class="va">series</span><span class="op">$</span><span class="va">van_sales</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###########</span></span></span>
<span class="r-in"><span><span class="co"># Example 3: same as example 2, but benchmarking all 4 series as BY-groups</span></span></span>
<span class="r-in"><span><span class="co">#            (4 BY-groups of 1 series instead of 2 BY-groups of 2 series)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">qtr_sales2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.union.html" class="external-link">ts.union</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">qtr_sales</span>, B <span class="op">=</span> <span class="va">qtr_sales</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_series3</span> <span class="op">&lt;-</span> <span class="fu"><a href="stack_tsDF.html">stack_tsDF</a></span><span class="op">(</span><span class="fu"><a href="ts_to_tsDF.html">ts_to_tsDF</a></span><span class="op">(</span><span class="va">qtr_sales2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_series3</span><span class="op">$</span><span class="va">alter</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">my_series3</span><span class="op">$</span><span class="va">alter</span><span class="op">[</span><span class="va">my_series3</span><span class="op">$</span><span class="va">series</span> <span class="op">==</span> <span class="st">"A.van_sales"</span></span></span>
<span class="r-in"><span>                <span class="op">&amp;</span> <span class="va">my_series3</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2012</span> <span class="op">&amp;</span> <span class="va">my_series3</span><span class="op">$</span><span class="va">period</span> <span class="op">&lt;=</span> <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">my_series3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        series year period value alter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 A.car_sales 2011      1  1851     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 A.car_sales 2011      2  2436     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 A.car_sales 2011      3  3115     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 A.car_sales 2011      4  2205     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 A.car_sales 2012      1  1987     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 A.car_sales 2012      2  2635     1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">my_series3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          series year period value alter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115 B.van_sales 2017      1  2770     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116 B.van_sales 2017      2  3080     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117 B.van_sales 2017      3  3100     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118 B.van_sales 2017      4  2800     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 B.van_sales 2018      1  3100     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120 B.van_sales 2018      2  2860     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ann_sales2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.union.html" class="external-link">ts.union</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">ann_sales</span>, B <span class="op">=</span> <span class="va">ann_sales</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_benchmarks3</span> <span class="op">&lt;-</span> <span class="fu"><a href="stack_bmkDF.html">stack_bmkDF</a></span><span class="op">(</span><span class="fu"><a href="ts_to_bmkDF.html">ts_to_bmkDF</a></span><span class="op">(</span><span class="va">ann_sales2</span>, ind_frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">my_benchmarks3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        series startYear startPeriod endYear endPeriod value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 A.car_sales      2011           1    2011         4 10324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 A.car_sales      2012           1    2012         4 10200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 A.car_sales      2013           1    2013         4 10582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 A.car_sales      2014           1    2014         4 11097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 A.car_sales      2015           1    2015         4 11582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 A.car_sales      2016           1    2016         4 11092</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">my_benchmarks3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         series startYear startPeriod endYear endPeriod value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 B.van_sales      2011           1    2011         4 12000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 B.van_sales      2012           1    2012         4 10400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 B.van_sales      2013           1    2013         4 11550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 B.van_sales      2014           1    2014         4 11400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 B.van_sales      2015           1    2015         4 14500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 B.van_sales      2016           1    2016         4 16000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out_bench3</span> <span class="op">&lt;-</span> <span class="fu">benchmarking</span><span class="op">(</span><span class="va">my_series3</span>,</span></span>
<span class="r-in"><span>                           <span class="va">my_benchmarks3</span>,</span></span>
<span class="r-in"><span>                           rho <span class="op">=</span> <span class="fl">0.729</span>,</span></span>
<span class="r-in"><span>                           lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           biasOption <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           var <span class="op">=</span> <span class="st">"value / alter"</span>,</span></span>
<span class="r-in"><span>                           with <span class="op">=</span> <span class="st">"value"</span>,</span></span>
<span class="r-in"><span>                           by <span class="op">=</span> <span class="st">"series"</span>,</span></span>
<span class="r-in"><span>                           quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking by-group 1 (series=A.car_sales)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ============================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking by-group 2 (series=A.van_sales)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ============================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking by-group 3 (series=B.car_sales)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ============================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking by-group 4 (series=B.van_sales)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ============================================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate the benchmarking graphs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_graphTable.html">plot_graphTable</a></span><span class="op">(</span><span class="va">out_bench3</span><span class="op">$</span><span class="va">graphTable</span>, <span class="st">"Ex3_graphs.pdf"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating the benchmarking graphics. Please be patient...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking graphics generated for 4 series in the following PDF file:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   %TEMP%\Rtmp0M5DK2\Ex3_graphs.pdf</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert data frame `out_bench3$series` to a "mts" object</span></span></span>
<span class="r-in"><span><span class="va">qtr_sales2_bmked</span> <span class="op">&lt;-</span> <span class="fu"><a href="tsDF_to_ts.html">tsDF_to_ts</a></span><span class="op">(</span><span class="fu"><a href="unstack_tsDF.html">unstack_tsDF</a></span><span class="op">(</span><span class="va">out_bench3</span><span class="op">$</span><span class="va">series</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print the first 10 observations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">qtr_sales2_bmked</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">qtr_sales2</span><span class="op">)</span>, deltat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">deltat</a></span><span class="op">(</span><span class="va">qtr_sales2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         A.car_sales A.van_sales B.car_sales B.van_sales</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011 Q1    1987.762    2470.301    1987.762    2497.155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011 Q2    2641.222    2956.559    2641.222    2980.984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011 Q3    3366.003    4031.113    3366.003    4029.901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011 Q4    2329.013    2542.026    2329.013    2491.960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012 Q1    2021.161    1900.000    2021.161    2077.268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012 Q2    2602.064    2500.000    2602.064    2466.739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012 Q3    3320.486    3636.551    3320.486    3522.652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012 Q4    2256.289    2363.449    2256.289    2333.342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2013 Q1    2072.168    2071.868    2072.168    2060.533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2013 Q2    2663.309    3112.774    2663.309    3110.631</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check the value of van sales for 2012 Q1 and Q2 in group A (fixed values)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">qtr_sales2</span><span class="op">[</span>, <span class="st">"A.van_sales"</span><span class="op">]</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2012</span>, <span class="fl">1</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2012</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">qtr_sales2_bmked</span><span class="op">[</span>, <span class="st">"A.van_sales"</span><span class="op">]</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2012</span>, <span class="fl">1</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2012</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reset the working directory to its initial location</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">iniwd</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michel Ferland, Statistics Canada.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

