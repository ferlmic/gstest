<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="fr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Rétablir les contraintes temporelles pour des séries de stocks — stock_benchmarking • gstest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rétablir les contraintes temporelles pour des séries de stocks — stock_benchmarking"><meta name="description" content="Fonction spécifiquement destinée à l'étalonnage des séries de stocks où les étalons sont des points d'ancrage couvrant
une seule période de la série indicatrice. Les étalons couvrant plus d'une période de la série indicatrice ne peuvent pas
être utilisés avec cette fonction. La fonction benchmarking() doit être utilisée à la place pour étalonner des séries de
flux (« non-stock »).
Plusieurs séries de stocks peuvent être étalonnées en un seul appel de fonction.
Notez que les fonctions stock_benchmarking() et benchmarking() partagent principalement les mêmes arguments et renvoient
le même type d'objet. Les différences sont énumérées ci-dessous :
L'argument verbose n'est pas défini pour stock_benchmarking().
Des arguments supplémentaires sont définis pour stock_benchmarking() :
low_freq_periodicity
n_low_freq_proj
proj_knots_rho_bd

La liste renvoyée par stock_benchmarking() contient un data frame supplémentaire :
splineKnots



Voir la section Détails pour plus d'informations sur les similitudes et les différences entre les fonctions
stock_benchmarking() et benchmarking().
Un équivalent direct de stock_benchmarking() n'existe pas dans G-Séries 2.0 en SAS\(^\circledR\)."><meta property="og:description" content="Fonction spécifiquement destinée à l'étalonnage des séries de stocks où les étalons sont des points d'ancrage couvrant
une seule période de la série indicatrice. Les étalons couvrant plus d'une période de la série indicatrice ne peuvent pas
être utilisés avec cette fonction. La fonction benchmarking() doit être utilisée à la place pour étalonner des séries de
flux (« non-stock »).
Plusieurs séries de stocks peuvent être étalonnées en un seul appel de fonction.
Notez que les fonctions stock_benchmarking() et benchmarking() partagent principalement les mêmes arguments et renvoient
le même type d'objet. Les différences sont énumérées ci-dessous :
L'argument verbose n'est pas défini pour stock_benchmarking().
Des arguments supplémentaires sont définis pour stock_benchmarking() :
low_freq_periodicity
n_low_freq_proj
proj_knots_rho_bd

La liste renvoyée par stock_benchmarking() contient un data frame supplémentaire :
splineKnots



Voir la section Détails pour plus d'informations sur les similitudes et les différences entre les fonctions
stock_benchmarking() et benchmarking().
Un équivalent direct de stock_benchmarking() n'existe pas dans G-Séries 2.0 en SAS\(^\circledR\)."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Passer au contenu</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Navigation sur le site"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gstest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Dernière version publiée">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Activer la navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gstest.html">Prise en main</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Référence</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmarking-cookbook.html">Livre de recette sur l'étalonnage</a></li>
    <li><a class="dropdown-item" href="../articles/benchmarking-demo-script.html">Un script d'étalonnage pour débutant</a></li>
    <li><a class="dropdown-item" href="../articles/osqp-settings-sequence-dataframe.html">« Data frame » pour la séquence de paramètres d'OSQP</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-nouveaut-s" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Nouveautés</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-nouveaut-s"><li><h6 class="dropdown-header" data-toc-skip>Versions</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/tree/main/">G-Séries 3.0 (version la plus récente - librairie R gstest 3.0.0)</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/releases/tag/v2.0/">G-Séries 2.0 (version SAS®)</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ferlmic/gstest/releases/tag/v1.04/">G-Séries 1.04 (version SAS®)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changements</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Rechercher sur le site" placeholder="Rechercher" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ferlmic/gstest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>

    <ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="#" onclick="window.location = location.href.replace('/fr/','/en/');"><span class="fa fa-language fa-lg"></span> English</a></li></ul></div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rétablir les contraintes temporelles pour des séries de stocks</h1>
      <small class="dont-index">Source : <a href="https://github.com/ferlmic/gstest/tree/main/fr/R/stock_benchmarking.R" class="external-link"><code>R/stock_benchmarking.R</code></a></small>
      <div class="d-none name"><code>stock_benchmarking.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fonction spécifiquement destinée à l'étalonnage des séries de stocks où les étalons sont des points d'ancrage couvrant
une seule période de la série indicatrice. Les étalons couvrant plus d'une période de la série indicatrice ne peuvent pas
être utilisés avec cette fonction. La fonction <code><a href="benchmarking.html">benchmarking()</a></code> doit être utilisée à la place pour étalonner des séries de
flux (« non-stock »).</p>
<p>Plusieurs séries de stocks peuvent être étalonnées en un seul appel de fonction.</p>
<p>Notez que les fonctions <code>stock_benchmarking()</code> et <code><a href="benchmarking.html">benchmarking()</a></code> partagent principalement les mêmes arguments et renvoient
le même type d'objet. Les différences sont énumérées ci-dessous :</p><ul><li><p>L'argument <code>verbose</code> n'est pas défini pour <code>stock_benchmarking()</code>.</p></li>
<li><p>Des arguments supplémentaires sont définis pour <code>stock_benchmarking()</code> :</p><ul><li><p><code>low_freq_periodicity</code></p></li>
<li><p><code>n_low_freq_proj</code></p></li>
<li><p><code>proj_knots_rho_bd</code></p></li>
</ul></li>
<li><p>La liste renvoyée par <code>stock_benchmarking()</code> contient un <em>data frame</em> supplémentaire :</p><ul><li><p><code>splineKnots</code></p></li>
</ul></li>
</ul><p>Voir la section <strong>Détails</strong> pour plus d'informations sur les similitudes et les différences entre les fonctions
<code>stock_benchmarking()</code> et <code><a href="benchmarking.html">benchmarking()</a></code>.</p>
<p><em>Un équivalent direct de <code>stock_benchmarking()</code> n'existe pas dans G-Séries 2.0 en SAS\(^\circledR\).</em></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Utilisation<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stock_benchmarking</span><span class="op">(</span></span>
<span>  <span class="va">series_df</span>,</span>
<span>  <span class="va">benchmarks_df</span>,</span>
<span>  <span class="va">rho</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">biasOption</span>,</span>
<span>  bias <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  low_freq_periodicity <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  n_low_freq_proj <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  proj_knots_rho_bd <span class="op">=</span> <span class="fl">0.995</span>,</span>
<span>  tolV <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  tolP <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  warnNegResult <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tolN <span class="op">=</span> <span class="op">-</span><span class="fl">0.001</span>,</span>
<span>  var <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  with <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  constant <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  negInput_option <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  allCols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-series-df">series_df<a class="anchor" aria-label="anchor" href="#arg-series-df"></a></dt>
<dd><p>(obligatoire)</p>
<p><em>Data frame</em>, ou objet compatible, qui contient les données de la (des) série(s) indicatrice(s) à étalonner. En plus de
la (des) variable(s) contenant les données, spécifiée(s) avec l'argument <code>var</code>, le <em>data frame</em> doit aussi contenir deux
variables numériques, <code>year</code> et <code>period</code>, identifiant les périodes des séries indicatrices.</p></dd>


<dt id="arg-benchmarks-df">benchmarks_df<a class="anchor" aria-label="anchor" href="#arg-benchmarks-df"></a></dt>
<dd><p>(obligatoire)</p>
<p><em>Data frame</em>, ou objet compatible, qui contient les étalons. En plus de la (des) variable(s) contenant les données,
spécifiée(s) avec l'argument <code>with</code>, le <em>data frame</em> doit aussi contenir quatre variables numériques, <code>startYear</code>,
<code>startPeriod</code>, <code>endYear</code> et <code>endPeriod</code>, identifiant les périodes des séries indicatrices couvertes par chaque étalon.</p></dd>


<dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>(obligatoire)</p>
<p>Nombre réel compris dans l'intervalle \([0,1]\) qui spécifie la valeur du paramètre autorégressif \(\rho\).
Voir la section <strong>Détails</strong> pour plus d'informations sur l'effet du paramètre \(\rho\).</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>(obligatoire)</p>
<p>Nombre réel, avec des valeurs suggérées dans l'intervalle \([-3,3]\), qui spécifie la valeur du paramètre du modèle
d'ajustement \(\lambda\). Les valeurs typiques sont <code>lambda = 0.0</code> pour un modèle additif et <code>lambda = 1.0</code> pour un
modèle proportionnel.</p></dd>


<dt id="arg-biasoption">biasOption<a class="anchor" aria-label="anchor" href="#arg-biasoption"></a></dt>
<dd><p>(obligatoire)</p>
<p>Spécification de l'option d'estimation du biais :</p><ul><li><p><code>1</code> : Ne pas estimer le biais. Le biais utilisé pour corriger la série indicatrice sera la valeur
spécifiée avec l'argument <code>bias</code>.</p></li>
<li><p><code>2</code> : Estimer le biais, afficher le résultat, mais ne pas l'utiliser. Le biais utilisé pour corriger
la série indicatrice sera la valeur spécifiée avec l'argument <code>bias</code>.</p></li>
<li><p><code>3</code> : Estimer le biais, afficher le résultat et utiliser le biais estimé pour corriger la série indicatrice.
Toute valeur spécifiée avec l'argument <code>bias</code> sera ignorée.</p></li>
</ul><p>L'argument <code>biasOption</code> n'est pas utilisé quand <code>rho = 1.0</code>. Voir la section <strong>Détails</strong> pour plus d'informations sur
le biais.</p></dd>


<dt id="arg-bias">bias<a class="anchor" aria-label="anchor" href="#arg-bias"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel, ou <code>NA</code>, spécifiant la valeur du biais défini par l'utilisateur à utiliser pour la correction de la série
indicatrice avant de procéder à l'étalonnage. Le biais est ajouté à la série indicatrice avec un modèle additif
(argument <code>lambda = 0.0</code>) alors qu'il est multiplié dans le cas contraire (argument <code>lambda != 0.0</code>). Aucune correction
de biais n'est appliquée lorsque <code>bias = NA</code>, ce qui équivaut à spécifier <code>bias = 0.0</code> lorsque <code>lambda = 0.0</code> et
<code>bias = 1.0</code> dans le cas contraire. L'argument <code>bias</code> n'est pas utilisé lorsque <code>biasOption = 3</code> ou <code>rho = 1.0</code>. Voir la
section <strong>Détails</strong> pour plus d'informations sur le biais.</p>
<p><strong>La valeur par défaut</strong> est <code>bias = NA</code> (pas de biais défini par l'utilisateur).</p></dd>


<dt id="arg-low-freq-periodicity">low_freq_periodicity<a class="anchor" aria-label="anchor" href="#arg-low-freq-periodicity"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre entier positif représentant le nombre de périodes définissant la <em>basse fréquence</em> (e.g., celle des étalons) pour
l'ajout de nœuds supplémentaires à la spline cubique (avant le premier étalon et après le dernier étalon). Par exemple,
<code>low_freq_periodicity = 3</code> avec des indicateurs mensuels
définira des nœuds trimestriels. Des nœuds annuels sont ajoutés lorsque <code>low_freq_periodicity = NA</code>.</p>
<p><strong>La valeur par défaut</strong> est <code>low_freq_periodicity = NA</code> (nœuds annuels).</p></dd>


<dt id="arg-n-low-freq-proj">n_low_freq_proj<a class="anchor" aria-label="anchor" href="#arg-n-low-freq-proj"></a></dt>
<dd><p>(optionnel)</p>
<p>Entier non négatif représentant le nombre de nœuds de basse fréquence (tel que défini avec l'argument
<code>low_freq_periodicity</code>) à ajouter aux deux extrémités (avant le premier étalon et après le dernier étalon)
avant de commencer à ajouter des nœuds de <em>haute fréquence</em> (celle de la série indicatrice).</p>
<p><strong>La valeur par défaut</strong> est <code>n_low_freq_proj = 1</code>.</p></dd>


<dt id="arg-proj-knots-rho-bd">proj_knots_rho_bd<a class="anchor" aria-label="anchor" href="#arg-proj-knots-rho-bd"></a></dt>
<dd><p>(optionnel)</p>
<p>Limite qui s'applique à la valeur spécifiée avec l'argument <code>rho</code> et qui determine le type noœuds supplémentaires à
ajouter aux deux extrémités (avant le premier étalon et après le dernier étalon). Lorsque <code>rho &gt; proj_knots_rho_bd</code>, des
nœuds de <em>haute fréquence</em> (celle de la série indicatrice) sont utilisés immédiatement aux deux extrémité. Autrement,
lorsque <code>rho &lt;= proj_knots_rho_bd</code>, des nœuds de <em>basse fréquence</em> (voir les arguments <code>low_freq_periodicity</code> et
<code>n_low_freq_proj</code>) sont d'abord projetés de part et d'autre. Notez que pour des stocks trimestriels, le cube de
<code>proj_knots_rho_bd</code> est utilisé. Par conséquent, la valeur de l'argument <code>proj_knots_rho_bd</code> doit correspondre à des
indicateurs de stocks mensuels; elle est ajustée à l'interne pour des stocks trimestriels. Cet argument vise à atteindre
un compromis pour les périodes à l'extérieur (avant ou après) les étalons (points d'ancrage) fournis en entrée,
c'est-à-dire des ajustements de type Denton (en ligne droite) lorsque <code>rho</code> s'approche de 1 (lorsque
<code>rho &gt; proj_knots_rho_bd</code>) et une spline cubique d'apparence normale (sans contorsions excessives) dans le cas contraire
(lorsque <code>rho &lt;= proj_knots_rho_bd</code>). La section <strong>Détails</strong> contient plus d'informations sur ce sujet et certains
cas illustratifs sont fournis dans la section <strong>Exemples</strong>.</p>
<p><strong>La valeur par défaut</strong> est <code>proj_knots_rho_bd = 0.995</code> (\(0.995^3\) pour des indicateurs de stocks trimestriels).</p></dd>


<dt id="arg-tolv-tolp">tolV, tolP<a class="anchor" aria-label="anchor" href="#arg-tolv-tolp"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel non négatif, ou <code>NA</code>, spécifiant la tolérance, en valeur absolue ou en pourcentage, à utiliser pour
la validation des étalons contraignants (coefficient d'altérabilité de \(0.0\)) en sortie. Cette validation consiste à
comparer la valeur des étalons contraignants en entrée à la valeur équivalente calculée à partir des données de la série
étalonnée (sortie). Les arguments <code>tolV</code> et <code>tolP</code> ne peuvent pas être spécifiés tous les deux à la fois (l'un doit être
spécifié tandis que l'autre doit être <code>NA</code>).</p>
<p><strong>Exemple :</strong> pour une tolérance de 10 <em>unités</em>, spécifiez <code>tolV = 10, tolP = NA</code>; pour une tolérance de 1%,
spécifiez <code>tolV = NA, tolP = 0.01</code>.</p>
<p><strong>Les valeurs par défaut</strong> sont <code>tolV = 0.001</code> et <code>tolP = NA</code>.</p></dd>


<dt id="arg-warnnegresult">warnNegResult<a class="anchor" aria-label="anchor" href="#arg-warnnegresult"></a></dt>
<dd><p>(optionnel)</p>
<p>Argument logique (<em>logical</em>) spécifiant si un message d'avertissement doit être affiché lorsqu'une valeur négative
créée par la fonction dans la série étalonnée (en sortie) est inférieure au seuil spécifié avec l'argument <code>tolN</code>.</p>
<p><strong>La valeur par défaut</strong> est <code>warnNegResult = TRUE</code>.</p></dd>


<dt id="arg-toln">tolN<a class="anchor" aria-label="anchor" href="#arg-toln"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel négatif spécifiant le seuil pour l'identification des valeurs négatives. Une valeur est considérée
négative lorsqu'elle est inférieure à ce seuil.</p>
<p><strong>La valeur par défaut</strong> est <code>tolN = -0.001</code>.</p></dd>


<dt id="arg-var">var<a class="anchor" aria-label="anchor" href="#arg-var"></a></dt>
<dd><p>(optionnel)</p>
<p>Vecteur (longueur minimale de 1) de chaînes de caractères spécifiant le(s) nom(s) de variable(s) du <em>data frame</em> des séries
indicatrices (argument <code>series_df</code>) contenant les valeurs et (optionnellement) les coefficients d'altérabilité définis par
l'utilisateur de la (des) série(s) à étalonner. Ces variables doivent être numériques.</p>
<p>La syntaxe est <code>var = c("serie1 &lt;/ alt_ser1&gt;", "serie2 &lt;/ alt_ser2&gt;", ...)</code>. Des coefficients d'altérabilité par défaut
de \(1.0\) sont utilisés lorsqu'une variable de coefficients d'altérabilité définie par l'utilisateur n'est pas spécifiée
à côté d'une variable de série indicatrice. Voir la section <strong>Détails</strong> pour plus d'informations sur les coefficients
d'altérabilité.</p>
<p><strong>Exemple :</strong> <code>var = "value / alter"</code> étalonnerait la variable <code>value</code> du <em>data frame</em> des séries indicatrices avec les
coefficients d'altérabilité contenus dans la variable <code>alter</code> tandis que <code>var = c("value / alter", "value2")</code> étalonnerait
en plus la variable <code>value2</code> avec des coefficients d'altérabilité par défaut de \(1.0\).</p>
<p><strong>La valeur par défaut</strong> est <code>var = "value"</code> (étalonner la variable <code>value</code> avec des coefficients d'altérabilité par défaut
de \(1.0\)).</p></dd>


<dt id="arg-with">with<a class="anchor" aria-label="anchor" href="#arg-with"></a></dt>
<dd><p>(optionnel)</p>
<p>Vecteur (même longueur que l'argument <code>var</code>) de chaînes de caractères, ou <code>NULL</code>, spécifiant le(s) nom(s) de variable(s)
du <em>data frame</em> des étalons (argument <code>benchmarks_df</code>) contenant les valeurs et (optionnellement) les coefficients
d'altérabilité définis par l'utilisateur des étalons. Ces variables doivent être numériques. La spécification de <code>with = NULL</code>
entraîne l'utilisation de variable(s) d'étalons correspondant à la (aux) variable(s) spécifiée(s) avec l'argument <code>var</code> sans
coefficients d'altérabilité d'étalons définis par l'utilisateur (c'est  à dire des coefficients d'altérabilité par défaut de
\(0.0\) correspondant à des étalons contraignants).</p>
<p>La syntaxe est <code>with = NULL</code> ou <code>with = c("bmk1 &lt;/ alt_bmk1&gt;", "bmk2 &lt;/ alt_bmk2&gt;", ...)</code>. Des coefficients d'altérabilité
par défaut de \(0.0\) (étalons contraignants) sont utilisés lorsqu'une variable de coefficients d'altérabilité définie
par l'utilisateur n'est pas spécifiée à côté d'une variable d'étalon. Voir la section <strong>Détails</strong> pour plus d'informations
sur les coefficients d'altérabilité.</p>
<p><strong>Exemple :</strong> <code>with = "val_bmk"</code> utiliserait la variable <code>val_bmk</code> du <em>data frame</em> des étalons avec les coefficients
d'altérabilité par défaut de \(0.0\) pour étalonner la série indicatrice tandis que
<code>with = c("val_bmk", "val_bmk2 / alt_bmk2")</code> étalonnerait en plus une deuxième série indicatrice en utilisant la variable
d'étalons <code>val_bmk2</code> avec les coefficients d'altérabilité d'étalons contenus dans la variable <code>alt_bmk2</code>.</p>
<p><strong>La valeur par défaut</strong> est <code>with = NULL</code> (même(s) variable(s) d'étalons que l'argument <code>var</code> avec des coefficients
d'altérabilité d'étalons par défaut de \(0.0\)).</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>(optionnel)</p>
<p>Vecteur (longueur minimale de 1) de chaînes de caractères, ou <code>NULL</code>, spécifiant le(s) nom(s) de variable(s) dans les
<em>data frames</em> d'entrée (arguments <code>series_df</code> et <code>benchmarks_df</code>) à utiliser pour former des groupes (pour le traitement
« groupes-BY ») et permettre l'étalonnage de plusieurs séries en un seul appel de fonction. Les variables groupes-BY
peuvent être numériques ou caractères (facteurs ou non), doivent être présentes dans les deux <em>data frames</em> d'entrée
et apparaîtront dans les trois <em>data frames</em> de sortie (voir la section <strong>Valeur de retour</strong>). Le traitement groupes-BY
n'est pas implémenté lorsque <code>by = NULL</code>. Voir « Étalonnage de plusieurs séries » dans la section <strong>Détails</strong> pour plus
d'informations.</p>
<p><strong>La valeur par défaut</strong> est <code>by = NULL</code> (pas de traitement groupes-BY).</p></dd>


<dt id="arg-constant">constant<a class="anchor" aria-label="anchor" href="#arg-constant"></a></dt>
<dd><p>(optionnel)</p>
<p>Nombre réel qui spécifie une valeur à ajouter temporairement à la fois à la (aux) série(s) indicatrice(s) et aux étalons
avant de résoudre les problèmes d'étalonnage proportionnels (<code>lambda != 0.0</code>). La constante temporaire est enlevée de la
série étalonnée finale en sortie. Par exemple, la spécification d'une (petite) constante permettrait l'étalonnage
proportionnel avec <code>rho = 1</code> (étalonnage de  Denton proportionnel) sur avec des séries indicatrices qui comprennent des
valeurs de 0. Sinon, l'étalonnage proportionnel avec des valeurs de 0 pour la série indicatrice n'est possible que
lorsque <code>rho &lt; 1</code>. Spécifier une constante avec l'étalonnage additif (<code>lambda = 0.0</code>) n'a pas d'impact sur les données
étalonnées résultantes. Les variables de données dans le <em>data frame</em> de sortie <strong>graphTable</strong> incluent la constante,
correspondant au problème d'étalonnage effectivement résolu par la fonction.</p>
<p><strong>La valeur par défaut</strong> est <code>constant = 0</code> (pas de constante additive temporaire).</p></dd>


<dt id="arg-neginput-option">negInput_option<a class="anchor" aria-label="anchor" href="#arg-neginput-option"></a></dt>
<dd><p>(optionnel)</p>
<p>Traitement des valeurs négatives dans les données d'entrée pour l'étalonnage proportionnel (<code>lambda != 0.0</code>) :</p><ul><li><p><code>0</code> : Ne pas autoriser les valeurs négatives pour l'étalonnage proportionnel. Un message d'erreur est affiché en
présence de valeurs négatives dans les séries indicatrices ou les étalons d'entrée et des valeurs manquantes (<code>NA</code>)
sont renvoyées pour les séries étalonnées. Ceci correspond au comportement de G-Séries 2.0.</p></li>
<li><p><code>1</code> : Autoriser les valeurs négatives pour l'étalonnage proportionnel mais avec l'affichage d'un message d'avertissement.</p></li>
<li><p><code>2</code> : Autoriser les valeurs négatives pour l'étalonnage proportionnel sans afficher de message.</p></li>
</ul><p><strong>La valeur par défaut</strong> est <code>negInput_option = 0</code> (ne pas autoriser les valeurs négatives pour l'étalonnage proportionnel).</p></dd>


<dt id="arg-allcols">allCols<a class="anchor" aria-label="anchor" href="#arg-allcols"></a></dt>
<dd><p>(optionnel)</p>
<p>Argument logique (<em>logical</em>) spécifiant si toutes les variables du <em>data frame</em> des séries indicatrices (argument <code>series_df</code>),
autres que <code>year</code> et <code>period</code>, déterminent l'ensemble des séries à étalonner. Les valeurs spécifiées avec les arguments <code>var</code>
et <code>with</code> sont ignorées lorsque <code>allCols = TRUE</code>, ce qui implique automatiquement des coefficients d'altérabilité par défaut,
et des variables avec les mêmes noms que les séries indicatrices doivent exister dans le <em>data frame</em> des étalons (argument
<code>benchmarks_df</code>).</p>
<p><strong>La valeur par défaut</strong> est <code>allCols = FALSE</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>(optionnel)</p>
<p>Argument logique (<em>logical</em>) spécifiant s'il faut ou non afficher uniquement les informations essentielles telles que les
messages d'avertissements, les messages d'erreurs et les informations sur les variables (séries) ou les groupes-BY lorsque
plusieurs séries sont étalonnées en un seul appel à la fonction. Nous vous déconseillons d'<em>envelopper</em> votre appel à
<code><a href="benchmarking.html">benchmarking()</a></code> avec <code><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages()</a></code> afin de supprimer l'affichage des informations sur les variables (séries) ou les
groupes-BY lors du traitement de plusieurs séries, car cela compliquerait le dépannage en cas de problèmes avec des séries
individuelles. Notez que la spécification de <code>quiet = TRUE</code> annulera également l'argument <code>verbose</code>.</p>
<p><strong>La valeur par défaut</strong> est <code>quiet = FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="valeur-de-retour">Valeur de retour<a class="anchor" aria-label="anchor" href="#valeur-de-retour"></a></h2>
    <p>La fonction renvoie une liste de quatre <em>data frames</em> :</p><ul><li><p><strong>series</strong> : <em>data frame</em> contenant les données étalonnées (sortie principale de la fonction). Les variables BY spécifiées
avec l'argument <code>by</code> sont incluses dans le <em>data frame</em> mais pas les variables de coefficient d'altérabilité spécifiées
avec l'argument <code>var</code>.</p></li>
<li><p><strong>benchmarks</strong> : copie du <em>data frame</em> d'entrée des étalons (à l'exclusion des étalons non valides, le cas échéant).
Les variables BY spécifiées avec l'argument <code>by</code> sont incluses dans le <em>data frame</em> mais pas les variables de coefficient
d'altérabilité spécifiées avec l'argument <code>with</code>.</p></li>
<li><p><strong>graphTable</strong> : <em>data frame</em> contenant des données supplémentaires utiles pour produire des tableaux et des graphiques
analytiques (voir la fonction <code><a href="plot_graphTable.html">plot_graphTable()</a></code>). Il contient les variables suivantes en plus des variables BY spécifiées
avec l'argument <code>by</code> :</p><ul><li><p><code>varSeries</code> : Nom de la variable de la série indicatrice</p></li>
<li><p><code>varBenchmarks</code> : Nom de la variable des étalons</p></li>
<li><p><code>altSeries</code> : Nom de la variable des coefficients d'altérabilité définis par l'utilisateur pour la série indicatrice</p></li>
<li><p><code>altSeriesValue</code> : Coefficients d'altérabilité de la série indicatrice</p></li>
<li><p><code>altbenchmarks</code> : Nom de la variable des coefficients d'altérabilité définis par l'utilisateur pour les étalons</p></li>
<li><p><code>altBenchmarksValue</code> : Coefficients d'altérabilité des étalons</p></li>
<li><p><code>t</code> : Identificateur de la période de la série indicatrice (1 à \(T\))</p></li>
<li><p><code>m</code> : Identificateur des périodes de couverture de l'étalon (1 à \(M\))</p></li>
<li><p><code>year</code> : Année civile du point de données</p></li>
<li><p><code>period</code> : Valeur de la période (du cycle) du point de données (1 à <code>periodicity</code>)</p></li>
<li><p><code>rho</code> : Paramètre autorégressif \(\rho\) (argument <code>rho</code>)</p></li>
<li><p><code>lambda</code> : Paramètre du modèle d'ajustement \(\lambda\) (argument <code>lambda</code>)</p></li>
<li><p><code>bias</code> : Ajustement du biais (par défaut, défini par l'utilisateur ou biais estimé selon les arguments <code>biasOption</code>
et <code>bias</code>)</p></li>
<li><p><code>periodicity</code> : Le nombre maximum de périodes dans une année (par exemple 4 pour une série indicatrice trimestrielle)</p></li>
<li><p><code>date</code> : Chaîne de caractères combinant les valeurs des variables <code>year</code> et <code>period</code></p></li>
<li><p><code>subAnnual</code> : Valeurs de la série indicatrice</p></li>
<li><p><code>benchmarked</code> : Valeurs de la série étalonnée</p></li>
<li><p><code>avgBenchmark</code> : Valeurs des étalons divisées par le nombre de périodes de couverture</p></li>
<li><p><code>avgSubAnnual</code> : Valeurs moyennes de la série indicatrice (variable <code>subAnnual</code>) pour les périodes couvertes par les
étalons</p></li>
<li><p><code>subAnnualCorrected</code> : Valeurs de la série indicatrice corrigée pour le biais</p></li>
<li><p><code>benchmarkedSubAnnualRatio</code> : Différence (\(\lambda = 0\)) ou ratio (\(\lambda \ne 0\)) des valeurs
des variables <code>benchmarked</code> et <code>subAnnual</code></p></li>
<li><p><code>avgBenchmarkSubAnnualRatio</code> : Différence (\(\lambda = 0\)) ou ratio (\(\lambda \ne 0\)) des valeurs
des variables <code>avgBenchmark</code> et <code>avgSubAnnual</code></p></li>
<li><p><code>growthRateSubAnnual</code> : Différence (\(\lambda = 0\)) ou différence relative (\(\lambda \ne 0\)) d'une
période à l'autre des valeurs de la série indicatrice (variable <code>subAnnual</code>)</p></li>
<li><p><code>growthRateBenchmarked</code> : Différence (\(\lambda = 0\)) ou différence relative (\(\lambda \ne 0\)) d'une
période à l'autre des valeurs de la série étalonnée (variable <code>benchmarked</code>)</p></li>
</ul></li>
<li><p><strong>splineKnots</strong> : ensemble de coordonnées <code>x</code> et <code>y</code> (nœuds) utilisées pour estimer la spline cubique naturelle avec la
fonction <code><a href="https://rdrr.io/r/stats/splinefun.html" class="external-link">stats::spline()</a></code>. En plus de l'ensemble original de nœuds correspondant aux étalons (points d'ancrage) contraignants,
des nœuds supplémentaires sont également ajoutés au début et à la fin afin de traiter le <em>problème d'actualité</em> de
l'étalonnage et d'approximer une spline de <em>pente=0</em> aux deux extrémités (voir section <strong>Détails</strong>). Il contient les variables
suivantes en plus des variables BY spécifiées avec l'argument <code>by</code> :</p><ul><li><p><code>varSeries</code> : Nom de la variable de la série indicatrice</p></li>
<li><p><code>varBenchmarks</code> : Nom de la variable des étalons</p></li>
<li><p><code>x</code> : Coordonnée <code>x</code> de la spline cubique</p></li>
<li><p><code>y</code> : Coordonnée <code>y</code> de la spline cubique</p></li>
<li><p><code>extraKnot</code> : Valeur logique (<em>logical</em>) identifiant les nœuds supplémentaires ajoutés au début et à la fin.</p></li>
</ul><p>Les enregistrements pour lesquels <code>extraKnot == FALSE</code> correspondent aux enregistrements du <em>data frame</em> de sortie
<strong>graphTable</strong> pour lesquels <code>m</code> n'est pas manquant (pas <code>NA</code>), avec <code>x = t</code> et <code>y = benchmarkedSubAnnualRatio</code>.</p></li>
</ul><p>Notes :</p><ul><li><p>Le <em>data frame</em> de sortie <strong>benchmarks</strong> contient toujours les étalons originaux fournis dans le <em>data frame</em> d'entrée
des étalons. Les étalons modifiés non contraignants, le cas échéant, peuvent être récupérés (calculés) à partir du <em>data frame</em>
de sortie <strong>series</strong>.</p></li>
<li><p>La fonction renvoie un objet <code>NULL</code> si une erreur se produit avant que le traitement des données ne puisse commencer.
Dans le cas contraire, si l'exécution est suffisamment avancée pour que le traitement des données puisse commencer, alors
un objet incomplet sera renvoyé en cas d'erreur (par exemple, un <em>data frame</em> de sortie <strong>series</strong> avec des valeurs <code>NA</code>
pour les données étalonnées).</p></li>
<li><p>La fonction renvoie des objets « data.frame » qui peuvent être explicitement convertis en d'autres types d'objets avec la
fonction <code>as*()</code> appropriée (ex., <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">tibble::as_tibble()</a></code> convertirait n'importe lequel d'entre eux en tibble).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="d-tails">Détails<a class="anchor" aria-label="anchor" href="#d-tails"></a></h2>

<div class="section">
<h3 id="comparaison-avec-benchmarking-">Comparaison avec <code><a href="benchmarking.html">benchmarking()</a></code><a class="anchor" aria-label="anchor" href="#comparaison-avec-benchmarking-"></a></h3>


<p>Avec des séries de stocks, <code><a href="benchmarking.html">benchmarking()</a></code> est connu pour produire des bris dans les ajustements d'étalonnage aux périodes
correspondant aux étalons (points d'ancrage). <code>stock_benchmarking()</code> résout ce problème en travaillant directement sur les
ajustements d'étalonnage. Des ajustements lisses pour les stocks sont garantis en estimant une spline cubique de <em>pente=0</em>
(une spline qui est <em>plate</em> aux deux extrémités) passant par les nœuds correspondant à la différence (lorsque l'argument
<code>lambda = 0.0</code>) ou au ratio (sinon) entre les étalons (points d'ancrage) et les valeurs correspondantes de la série indicatrice.
Ces nœuds sont parfois appelés <em>différences BI</em> ou <em>ratios BI</em> (<em><strong>B</strong>enchmark-to-<strong>I</strong>ndicator</em> en anglais). Les
interpolations à partir de la spline cubique estimée fournissent alors les ajustements d'étalonnage pour les périodes entre
les étalons.</p>
<p>Les arguments <code>rho</code>, <code>lambda</code>, <code>biasOption</code> et <code>bias</code> jouent un rôle similaire à ceux de <code><a href="benchmarking.html">benchmarking()</a></code>. Cependant, notez que
pour <code>stock_benchmarking()</code>, l'argument <code>rho</code> n'affecte les résultats que pour les périodes à l'extérieur, ou autour, du premier
et du dernier étalon et <code>lambda</code> ne prend que deux valeurs en pratique : <code>lambda = 0.0</code> pour des ajustements additifs
(interpolations par spline cubique où les nœuds sont des <em>différences BI</em>) ou <code>lambda = 1.0</code> pour des ajustements multiplicatifs
(interpolations par spline cubique où les nœuds sont des <em>ratios BI</em>). Toute valeur non nulle pour <code>lambda</code> donnerait le même
résultat que <code>lambda = 1.0</code>. Les coefficients d'altérabilité jouent également un rôle similaire à ceux de <code><a href="benchmarking.html">benchmarking()</a></code> et ont
les mêmes valeurs par défaut, c'est-à-dire \(1.0\) pour la série indicatrice (valeurs non contraignantes) et \(0.0\) pour
les étalons (étalons contraignants). Cependant, comme pour l'argument <code>lambda</code>, les coefficients d'altérabilité de cette
fonction ne prennent que deux valeurs en pratique : \(0.0\) pour des valeurs contraignantes ou \(1.0\) pour des valeurs
non contraignantes. Tout coefficient d'altérabilité non nul renverrait le même résultat qu'un coefficient de \(1.0\). Une
autre différence avec <code><a href="benchmarking.html">benchmarking()</a></code> est que les coefficients d'altérabilité définis par l'utilisateur sont autorisés même
si <code>rho = 1</code> avec <code>stock_benchmarking()</code>. Enfin, le fait de spécifier un étalon non contraignant avec <code>stock_benchmarking()</code>
équivaut à l'ignorer complètement, comme si l'étalon en question n'était pas inclus dans le fichier d'entrée des étalons. Par
rapport à <code><a href="benchmarking.html">benchmarking()</a></code>, cette approche se traduit généralement par un impact plus important des étalons non contraignants
sur les résultats de l'étalonnage (sur les stocks étalonnés résultants).</p>
</div>

<div class="section">
<h3 id="solution-autour-des-premier-et-dernier-talons-probl-me-d-actualit-de-l-talonnage-">Solution autour des premier et dernier étalons (<em>problème d'actualité</em> de l'étalonnage)<a class="anchor" aria-label="anchor" href="#solution-autour-des-premier-et-dernier-talons-probl-me-d-actualit-de-l-talonnage-"></a></h3>


<p>Une spline de <em>pente=0</em> est choisie parce qu'elle correspond conceptuellement à l'approche (populaire) d'<em>étalonnage de
Denton</em> (<code>rho = 1</code>). Afin de fournir une solution avant le premier étalon et après le dernier étalon qui soit semblable à
celle de <code><a href="benchmarking.html">benchmarking()</a></code> lorsque <code>rho &lt; 1</code>, c'est-à-dire des ajustements convergeant vers le biais à une vitesse dictée par
l'argument <code>rho</code>, des nœuds supplémentaires sont ajoutés aux deux extrémités avant d'estimer la spline. Par défaut, un nœud
supplémentaire de basse fréquence (défini par l'argument <code>low_freq_periodicity</code>) est ajouté de chaque côté (au début et à la fin),
c'est-à-dire qu'un nœud supplémentaire est ajouté avant le premier étalon et après le dernier étalon. Ensuite, des nœuds de
haute fréquence (celle de la série indicatrice) sont ajoutés pour couvrir l'étendue de la série indicatrice, à laquelle est
ajoutée une année supplémentaire de nœuds de haute fréquence. La valeur de tous ces nœuds supplémentaires est basée sur les
arguments <code>rho</code>, <code>biasOption</code> et <code>bias</code>. Cela produit des ajustements lisses et naturels pour les périodes à l'extérieur, ou
autour, des premier et dernier étalons qui convergent progressivement vers le biais, de manière similaire à <code><a href="benchmarking.html">benchmarking()</a></code>.
Le nombre de nœuds supplémentaires de basse fréquence à ajouter peut être modifié avec l'argument <code>n_low_freq_proj</code>.
L'utilisation immédiate de nœuds de haute fréquence (<code>n_low_freq_proj = 0</code>) produirait les mêmes ajustements projetés que
<code><a href="benchmarking.html">benchmarking()</a></code>. Cependant, notez que cela tend à produire une spline d'apparence peu naturelle (exagérément contortionnée)
autour des premier et dernier étalons qui pourrait être révisée de manière substantielle une fois que le prochain étalon sera
disponible. L'utilisation de la valeur par défaut <code>n_low_freq_proj = 1</code> fonctionne généralement mieux. Cependant, lorsque
<code>rho</code> est <em>proche de 1</em> (voir l'argument <code>proj_knots_rho_bd</code>), des noeuds de haute fréquence sont immédiatement ajoutés de
chaque côté afin d'assurer des ajustements projetés de type Denton (en ligne droite) pour les périodes à l'extérieur des
premier et dernier étalons. Enfin, une spline cubique de <em>pente=0</em> passant à travers les nœuds (originaux et supplémentaires)
est estimée. Notez qu'en pratique, la spline de <em>pente=0</em> est en fait approximée en reproduisant la valeur des nœuds aux
extrémités 100 fois au cours de la période suivante (à une fréquence correspondant à 100 fois la fréquence de la série
indicatrice).</p>
<p>Une <em>spline naturelle</em> aux nœuds d'extrémité originaux (premier et dernier étalons) peut être approximée en spécifiant
une grande valeur pour l'argument <code>low_freq_periodicity</code>. Plus la valeur de <code>low_freq_periodicity</code> est grande, plus la spline
cubique se comportera comme une <em>spline naturelle</em> (dérivée seconde égale à 0 aux extrémités, c'est-à-dire une spline qui
garde une pente constante aux extrémités au lieu d'être plate comme une spline de <em>pente=0</em>).</p>
<p>En résumé, les ajustements projetés sont contrôlés avec les arguments <code>rho</code>, <code>bias</code> (et <code>biasOption</code>), <code>n_low_freq_proj</code>,
<code>proj_knots_rho_bd</code> et <code>low_freq_periodicity</code> :</p><ul><li><p>Les valeurs par défaut de ces arguments produisent des ajustements projetés du type fonction <code>benchmarking</code> (convergence
raisonnablement lente vers le biais).</p></li>
<li><p>Des valeurs plus petites de <code>rho</code> généreraient une convergence plus rapide vers le biais.</p></li>
<li><p>Spécifier un biais défini par l'utilisateur avec l'argument <code>bias</code> lorsque <code>rho &lt; 1</code> est une autre façon d'influencer la
forme des ajustements projetés.</p></li>
<li><p>Spécifier <code>rho = 1</code> produit des ajustements projetés de type Denton (premiers/derniers ajustements répétés sans convergence
vers le biais).</p></li>
<li><p>Spécifier une grande valeur pour <code>low_freq_periodicity</code> génère des ajustements projetés qui se comportent plus comme une
spline naturelle, c'est-à-dire des ajustements qui continuent dans la même direction au premier/dernier étalon. Plus la valeur
de <code>low_freq_periodicity</code> est grande, plus les ajustements projetés continuent à aller dans la même direction avant de <em>tourner</em>.</p></li>
</ul><p>La spline cubique associée aux ajustements de <code>stock_benchmarking()</code> peut être commodément tracée avec <code><a href="plot_benchAdj.html">plot_benchAdj()</a></code>.</p>
</div>

<div class="section">
<h3 id="note-sur-les-r-visions-des-ajustements-d-talonnage">Note sur les révisions des ajustements d'étalonnage<a class="anchor" aria-label="anchor" href="#note-sur-les-r-visions-des-ajustements-d-talonnage"></a></h3>


<p>Les ajustements de <code><a href="benchmarking.html">benchmarking()</a></code> ne seraient pas révisés si tous les futurs étalons tombaient exactement sur ceux qui sont
projetés (sur la base du biais et de la valeur de <code>rho</code>) et si le biais était fixé. La même chose pourrait être obtenue avec
<code>stock_benchmarking()</code> si <em>suffisamment</em> de nœuds de basse fréquence (celle des étalons) étaient projetés. Le problème avec
cette approche, cependant, est que les ajustements projetés peuvent ne pas sembler naturels car la spline peut osciller plus
que souhaité autour des nœuds projetés. Ceci est clairement perceptible lorsque <code>rho</code> s'approche de 1 et que la spline oscille
autour des nœuds projetés alignés horizontalement au lieu d'être alignée sur une ligne parfaitement droite. L'implémentation
par défaut de la spline autour des premier et dernier étalons décrite précédemment vise à atteindre une <em>solution de meilleur
compromis</em> :</p><ul><li><p>une spline d'apparence naturelle aux extrémités évitant les oscillations et les contorsions excessives;</p></li>
<li><p>de petites révisions de la spline si l'étalon suivant est proche de celui projeté lorsque <code>rho</code> est <em>assez éloigné</em>
de 1 (<code>rho &lt;= proj_knots_rho_bd</code>);</p></li>
<li><p>ajustements projetés qui sont en ligne droite (sans oscillations) lorsque <code>rho</code> s'approche de 1 (<code>rho &gt; proj_knots_rho_bd</code>).</p></li>
</ul><p>Les sous-sections <em>Étalonnage de plusieurs séries</em>, <em>Arguments <code>constant</code> et <code>negInput_option</code></em> et <em>Traitement des valeurs
manquantes (<code>NA</code>)</em> à la fin de la section <strong>Détails</strong> de <code><a href="benchmarking.html">benchmarking()</a></code> sont également pertinentes pour
<code>stock_benchmarking()</code>. Consultez-les au besoin.</p>
<p>Enfin, notez que la spline cubique associée aux ajustements de <code>stock_benchmarking()</code> peut être commodément tracée avec
<code><a href="plot_benchAdj.html">plot_benchAdj()</a></code>. Cette dernière est utilisée dans les <strong>Exemples</strong> pour illustrer certains des sujets abordés ci-dessus.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="r-f-rences">Références<a class="anchor" aria-label="anchor" href="#r-f-rences"></a></h2>
    <p>Statistique Canada (2012). « Chapitre 5 : Étalonnage de stocks ». <strong>Théorie et application de l’étalonnage
(Code du cours 0436)</strong>. Statistique Canada, Ottawa, Canada.</p>
    </div>
    <div class="section level2">
    <h2 id="voir-galement">Voir également<a class="anchor" aria-label="anchor" href="#voir-galement"></a></h2>
    <div class="dont-index"><p><code><a href="benchmarking.html">benchmarking()</a></code> <code><a href="plot_graphTable.html">plot_graphTable()</a></code> <a href="bench_graphs.html">bench_graphs</a> <code><a href="plot_benchAdj.html">plot_benchAdj()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Exemples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Série de stocks trimestriels (même patron répété chaque année)</span></span></span>
<span class="r-in"><span><span class="va">mes_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts_to_tsDF.html">ts_to_tsDF</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>, <span class="fl">95</span>, <span class="fl">125</span>, <span class="fl">95</span><span class="op">)</span>, <span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2013</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mes_ind</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   year period value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2013      1    85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2013      2    95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2013      3   125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2013      4    95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2014      1    85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2014      2    95</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Étalons annuels (stocks de fin d'année)</span></span></span>
<span class="r-in"><span><span class="va">mes_eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts_to_bmkDF.html">ts_to_bmkDF</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">135</span>, <span class="fl">125</span>, <span class="fl">155</span>, <span class="fl">145</span>, <span class="fl">165</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          start <span class="op">=</span> <span class="fl">2013</span>,</span></span>
<span class="r-in"><span>                          frequency <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       discrete_flag <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                       alignment <span class="op">=</span> <span class="st">"e"</span>,</span></span>
<span class="r-in"><span>                       ind_frequency <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mes_eta</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   startYear startPeriod endYear endPeriod value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      2013           4    2013         4   135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      2014           4    2014         4   125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      2015           4    2015         4   155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      2016           4    2016         4   145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      2017           4    2017         4   165</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Étalonnage avec...</span></span></span>
<span class="r-in"><span><span class="co">#   - valeur de `rho` recommandée pour des séries trimestrielles (`rho = 0.729`)</span></span></span>
<span class="r-in"><span><span class="co">#   - modèle proportionnel (`lambda = 1`)</span></span></span>
<span class="r-in"><span><span class="co">#   - correction de la série indicatrice pour le biais avec estimation du biais </span></span></span>
<span class="r-in"><span><span class="co">#     (`biasOption = 3`)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... avec `benchmarking()` (approche « Proc Benchmarking »)</span></span></span>
<span class="r-in"><span><span class="va">res_PB</span> <span class="op">&lt;-</span> <span class="fu"><a href="benchmarking.html">benchmarking</a></span><span class="op">(</span><span class="va">mes_ind</span>,</span></span>
<span class="r-in"><span>                       <span class="va">mes_eta</span>,</span></span>
<span class="r-in"><span>                       rho <span class="op">=</span> <span class="fl">0.729</span>,</span></span>
<span class="r-in"><span>                       lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                       biasOption <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --- Package gstest 3.0.0 - (EN) 'G-Series' in 'R' | (FR) 'G-Séries' en 'R' ---</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created on April 8, 2025, at 3:40:01 PM EDT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> URL: https://ferlmic.github.io/gstest/en/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      https://ferlmic.github.io/gstest/fr/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Email: g-series@statcan.gc.ca</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> benchmarking() function:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     series_df          = mes_ind</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     benchmarks_df      = mes_eta</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rho                = 0.729</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lambda             = 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     biasOption         = 3 (Calculate bias, use calculated bias)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     bias               (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolV               = 0.001 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     warnNegResult      = TRUE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolN               = -0.001 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     var                = value (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     with               = NULL (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     by                 = NULL (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     verbose            = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)constant        = 0 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)negInput_option = 0 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)allCols         = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*)quiet           = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (*) indicates new arguments in G-Series 3.0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of observations in the BENCHMARKS data frame .............:  5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid observations in the BENCHMARKS data frame .......:  5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of observations in the SERIES data frame .................: 28</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid observations in the SERIES data frame ...........: 28</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BIAS = 1.526316 (calculated)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... avec `stock_benchmarking()` (approche « Stock Benchmarking »)</span></span></span>
<span class="r-in"><span><span class="va">res_SB</span> <span class="op">&lt;-</span> <span class="fu">stock_benchmarking</span><span class="op">(</span><span class="va">mes_ind</span>,</span></span>
<span class="r-in"><span>                             <span class="va">mes_eta</span>,</span></span>
<span class="r-in"><span>                             rho <span class="op">=</span> <span class="fl">0.729</span>,</span></span>
<span class="r-in"><span>                             lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                             biasOption <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --- Package gstest 3.0.0 - (EN) 'G-Series' in 'R' | (FR) 'G-Séries' en 'R' ---</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created on April 8, 2025, at 3:40:01 PM EDT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> URL: https://ferlmic.github.io/gstest/en/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>      https://ferlmic.github.io/gstest/fr/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Email: g-series@statcan.gc.ca</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> stock_benchmarking() function:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     series_df            = mes_ind</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     benchmarks_df        = mes_eta</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rho                  = 0.729</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lambda               = 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     biasOption           = 3 (Calculate bias, use calculated bias)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     bias                 (ignored)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     low_freq_periodicity = NA (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     n_low_freq_proj      = 1 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     proj_knots_rho_bd    = 0.995 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolV                 = 0.001 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     warnNegResult        = TRUE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tolN                 = -0.001 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     var                  = value (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     with                 = NULL (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     by                   = NULL (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     constant             = 0 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     negInput_option      = 0 (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     allCols              = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     quiet                = FALSE (default)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of observations in the BENCHMARKS data frame .............:  5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid observations in the BENCHMARKS data frame .......:  5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of observations in the SERIES data frame .................: 28</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid observations in the SERIES data frame ...........: 28</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BIAS = 1.526316 (calculated)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparer les ajustements d'étalonnage des deux approches</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_benchAdj.html">plot_benchAdj</a></span><span class="op">(</span>PB_graphTable <span class="op">=</span> <span class="va">res_PB</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              SB_graphTable <span class="op">=</span> <span class="va">res_SB</span><span class="op">$</span><span class="va">graphTable</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Avez-vous remarqué que les ajustements de `stock_benchmarking()` sont plus lisses </span></span></span>
<span class="r-in"><span><span class="co"># que ceux de `benchmarking()` ?</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># L'amélioration de la qualité des données étalonnées qui en résulte n'est pas </span></span></span>
<span class="r-in"><span><span class="co"># nécessairement évidente dans cet exemple.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SB</span><span class="op">$</span><span class="va">graphTable</span><span class="op">$</span><span class="va">t</span>, <span class="va">res_SB</span><span class="op">$</span><span class="va">graphTable</span><span class="op">$</span><span class="va">benchmarked</span>,</span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"red"</span>, xlab <span class="op">=</span> <span class="st">"t"</span>, ylab <span class="op">=</span> <span class="st">"Stocks étalonnés"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">res_PB</span><span class="op">$</span><span class="va">graphTable</span><span class="op">$</span><span class="va">t</span>, <span class="va">res_PB</span><span class="op">$</span><span class="va">graphTable</span><span class="op">$</span><span class="va">benchmarked</span>,</span></span>
<span class="r-in"><span>      type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topleft"</span>, bty <span class="op">=</span> <span class="st">"n"</span>, inset <span class="op">=</span> <span class="fl">0.05</span>, lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"res_SB"</span>, <span class="st">"res_PB"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Stocks étalonnés"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Qu'en est-il des cas où un indicateur plat (rectiligne) est utilisé, ce qui se produit </span></span></span>
<span class="r-in"><span><span class="co"># souvent en pratique en l'absence d'un bon indicateur des mouvements infra-annuels ?</span></span></span>
<span class="r-in"><span><span class="va">mes_inds2</span> <span class="op">&lt;-</span> <span class="va">mes_ind</span></span></span>
<span class="r-in"><span><span class="va">mes_inds2</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fl">1</span>  <span class="co"># indicateur plat</span></span></span>
<span class="r-in"><span><span class="va">res_PB2</span> <span class="op">&lt;-</span> <span class="fu"><a href="benchmarking.html">benchmarking</a></span><span class="op">(</span><span class="va">mes_inds2</span>,</span></span>
<span class="r-in"><span>                        <span class="va">mes_eta</span>,</span></span>
<span class="r-in"><span>                        rho <span class="op">=</span> <span class="fl">0.729</span>,</span></span>
<span class="r-in"><span>                        lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                        biasOption <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                        quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># ne pas afficher l'en-tête</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res_SB2</span> <span class="op">&lt;-</span> <span class="fu">stock_benchmarking</span><span class="op">(</span><span class="va">mes_inds2</span>,</span></span>
<span class="r-in"><span>                              <span class="va">mes_eta</span>,</span></span>
<span class="r-in"><span>                              rho <span class="op">=</span> <span class="fl">0.729</span>,</span></span>
<span class="r-in"><span>                              lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                              biasOption <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                              quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># ne pas afficher l'en-tête</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SB2</span><span class="op">$</span><span class="va">graphTable</span><span class="op">$</span><span class="va">t</span>, <span class="va">res_SB2</span><span class="op">$</span><span class="va">graphTable</span><span class="op">$</span><span class="va">benchmarked</span>,</span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"red"</span>, xlab <span class="op">=</span> <span class="st">"t"</span>, ylab <span class="op">=</span> <span class="st">"Stocks étalonnés"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">res_PB2</span><span class="op">$</span><span class="va">graphTable</span><span class="op">$</span><span class="va">t</span>, <span class="va">res_PB2</span><span class="op">$</span><span class="va">graphTable</span><span class="op">$</span><span class="va">benchmarked</span>,</span></span>
<span class="r-in"><span>      type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topleft"</span>, bty <span class="op">=</span> <span class="st">"n"</span>, inset <span class="op">=</span> <span class="fl">0.05</span>, lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"res_SB2"</span>, <span class="st">"res_PB2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Stocks étalonnés - Indicateur plat"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># L'apparence plutôt étrange des valeurs étalonnées produites par `benchmarking()` devient </span></span></span>
<span class="r-in"><span><span class="co"># soudainement plus évidente. En effet, la série étalonnée correspond aux ajustements </span></span></span>
<span class="r-in"><span><span class="co"># d'étalonnage lorsqu'on utilise un indicateur plat (par exemple, une série de 1 avec </span></span></span>
<span class="r-in"><span><span class="co"># un étalonnage proportionnel) :</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_benchAdj.html">plot_benchAdj</a></span><span class="op">(</span>PB_graphTable <span class="op">=</span> <span class="va">res_PB2</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              SB_graphTable <span class="op">=</span> <span class="va">res_SB2</span><span class="op">$</span><span class="va">graphTable</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Les lacunes de l'approche « Proc Benchmarking » (fonction `benchmarking()`) avec </span></span></span>
<span class="r-in"><span><span class="co"># des stocks sont également très visibles lorsque l'on regarde les taux de croissance </span></span></span>
<span class="r-in"><span><span class="co"># trimestriels résultants, qui sont commodément produits par `plot_graphTable()`. </span></span></span>
<span class="r-in"><span><span class="co"># Portez une attention particulière à la transition des taux de croissance de T4 à T1 </span></span></span>
<span class="r-in"><span><span class="co"># à chaque année dans les graphiques PDF générés.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_graphTable.html">plot_graphTable</a></span><span class="op">(</span><span class="va">res_PB2</span><span class="op">$</span><span class="va">graphTable</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Stock_ind_plat_PB.pdf"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating the benchmarking graphics. Please be patient...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking graphics generated for 1 series in the following PDF file:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   %TEMP%\RtmpuGkRbM\Stock_ind_plat_PB.pdf</span>
<span class="r-in"><span><span class="fu"><a href="plot_graphTable.html">plot_graphTable</a></span><span class="op">(</span><span class="va">res_SB2</span><span class="op">$</span><span class="va">graphTable</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Stock_ind_plat_SB.pdf"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating the benchmarking graphics. Please be patient...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Benchmarking graphics generated for 1 series in the following PDF file:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   %TEMP%\RtmpuGkRbM\Stock_ind_plat_SB.pdf</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Illustrer l'approximation d'une spline cubique naturelle aux nœuds d'extrémité originaux </span></span></span>
<span class="r-in"><span><span class="co"># (premier et dernier étalons) en spécifiant une grande valeur pour `low_freq_periodicity`.</span></span></span>
<span class="r-in"><span><span class="va">res_SB3</span> <span class="op">&lt;-</span> <span class="fu">stock_benchmarking</span><span class="op">(</span><span class="va">mes_ind</span>,</span></span>
<span class="r-in"><span>                              <span class="va">mes_eta</span>,</span></span>
<span class="r-in"><span>                              rho <span class="op">=</span> <span class="fl">0.729</span>,</span></span>
<span class="r-in"><span>                              lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                              biasOption <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span>                              <span class="co"># Grande valeur pour approximer une spline cubique naturelle</span></span></span>
<span class="r-in"><span>                              low_freq_periodicity <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span>                              quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_benchAdj.html">plot_benchAdj</a></span><span class="op">(</span>SB_graphTable <span class="op">=</span> <span class="va">res_SB3</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              SB_splineKnots <span class="op">=</span> <span class="va">res_SB3</span><span class="op">$</span><span class="va">splineKnots</span>,</span></span>
<span class="r-in"><span>              legendPos <span class="op">=</span> <span class="st">"topleft"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Illustrer les « oscillations » pour les ajustements projetés au-delà des nœuds </span></span></span>
<span class="r-in"><span><span class="co"># d'extrémité originaux avec l'étalonnage de type Denton (`rho ~ 1`) causées par </span></span></span>
<span class="r-in"><span><span class="co"># l'utilisation de nœuds supplémentaires de basse fréquence (annuelle).</span></span></span>
<span class="r-in"><span><span class="va">res_SB4</span> <span class="op">&lt;-</span> <span class="fu">stock_benchmarking</span><span class="op">(</span><span class="va">mes_ind</span>,</span></span>
<span class="r-in"><span>                              <span class="va">mes_eta</span>,</span></span>
<span class="r-in"><span>                              rho <span class="op">=</span> <span class="fl">0.999</span>,</span></span>
<span class="r-in"><span>                              lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                              biasOption <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span>                              <span class="co"># Utiliser d'abord 3 noœuds supplémentaires annuels</span></span></span>
<span class="r-in"><span>                              n_low_freq_proj <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                              proj_knots_rho_bd <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span>                              quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_benchAdj.html">plot_benchAdj</a></span><span class="op">(</span>SB_graphTable <span class="op">=</span> <span class="va">res_SB4</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              SB_splineKnots <span class="op">=</span> <span class="va">res_SB4</span><span class="op">$</span><span class="va">splineKnots</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pas d'« oscillations » avec la valeur par défaut de `proj_knots_rho_bd` parce que </span></span></span>
<span class="r-in"><span><span class="co"># des nœuds supplémentaires de haute fréquence (trimestrielle) sont utilisés immédiatement </span></span></span>
<span class="r-in"><span><span class="co"># (`n_low_freq_proj` est ignoré) puisque `rho = 0.999` excède la valeur par défaut de </span></span></span>
<span class="r-in"><span><span class="co"># `proj_knots_rho_bd` (0.995^3 pour des données trimestrielles). Ces ajustements projetés </span></span></span>
<span class="r-in"><span><span class="co"># correspondent davantage à des ajustements de type Denton (en ligne droite).</span></span></span>
<span class="r-in"><span><span class="va">res_SB4b</span> <span class="op">&lt;-</span> <span class="fu">stock_benchmarking</span><span class="op">(</span><span class="va">mes_ind</span>,</span></span>
<span class="r-in"><span>                               <span class="va">mes_eta</span>,</span></span>
<span class="r-in"><span>                               rho <span class="op">=</span> <span class="fl">0.999</span>,</span></span>
<span class="r-in"><span>                               lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                               biasOption <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                               quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_benchAdj.html">plot_benchAdj</a></span><span class="op">(</span>SB_graphTable <span class="op">=</span> <span class="va">res_SB4b</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              SB_splineKnots <span class="op">=</span> <span class="va">res_SB4b</span><span class="op">$</span><span class="va">splineKnots</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Illustrer les « contorsions » de la spline cubique autour des nœuds d'extrémité originaux </span></span></span>
<span class="r-in"><span><span class="co"># causées par l'utilisation immédiate de nœuds supplémentaires de haute fréquence </span></span></span>
<span class="r-in"><span><span class="co"># (`n_low_freq_proj = 0`), c.à-d., en utilisant les mêmes ajustements projetés que ceux qui </span></span></span>
<span class="r-in"><span><span class="co"># seraient obtenus avec `benchmarking()`.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Pour exacerber le phénomène, nous utiliserons des données mensuelles (11 périodes entre </span></span></span>
<span class="r-in"><span><span class="co"># chaque étalon annuel contre seulement 3 pour des données trimestrielles, c.-à-d., une </span></span></span>
<span class="r-in"><span><span class="co"># spline moins contrainte) et une valeur plutôt faible de `rho` (0.5 &lt; 0.9 = valeur </span></span></span>
<span class="r-in"><span><span class="co"># recommandée pour des données mensuelles) pour une convergence plus rapide vers le biais </span></span></span>
<span class="r-in"><span><span class="co"># des ajustements projetés.</span></span></span>
<span class="r-in"><span><span class="va">vec_ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mes_ind</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mes_ind3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">vec_ans</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec_ans</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec_ans</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># indicateur plat</span></span></span>
<span class="r-in"><span><span class="va">mes_eta2</span> <span class="op">&lt;-</span> <span class="va">mes_eta</span></span></span>
<span class="r-in"><span><span class="va">mes_eta2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"startPeriod"</span>, <span class="st">"endPeriod"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">12</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res_SB5</span> <span class="op">&lt;-</span> <span class="fu">stock_benchmarking</span><span class="op">(</span><span class="va">mes_ind3</span>,</span></span>
<span class="r-in"><span>                              <span class="va">mes_eta2</span>,</span></span>
<span class="r-in"><span>                              rho <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                              lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                              biasOption <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span>                              <span class="co"># Utilisation immédiate de noœuds supplémentaires mensuels</span></span></span>
<span class="r-in"><span>                              n_low_freq_proj <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span>                              quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_benchAdj.html">plot_benchAdj</a></span><span class="op">(</span>SB_graphTable <span class="op">=</span> <span class="va">res_SB5</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              SB_splineKnots <span class="op">=</span> <span class="va">res_SB5</span><span class="op">$</span><span class="va">splineKnots</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pas de « contorsions » excessives autour des nœuds d'extrémité originaux avec la valeur </span></span></span>
<span class="r-in"><span><span class="co"># par défaut `n_low_freq_proj = 1`, c.-à-d., utiliser d'abord 1 nœud supplémentaire de </span></span></span>
<span class="r-in"><span><span class="co"># basse fréquence (annuelle).</span></span></span>
<span class="r-in"><span><span class="va">res_SB5b</span> <span class="op">&lt;-</span> <span class="fu">stock_benchmarking</span><span class="op">(</span><span class="va">mes_ind3</span>,</span></span>
<span class="r-in"><span>                               <span class="va">mes_eta2</span>,</span></span>
<span class="r-in"><span>                               rho <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                               lambda <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                               biasOption <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                               quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_benchAdj.html">plot_benchAdj</a></span><span class="op">(</span>SB_graphTable <span class="op">=</span> <span class="va">res_SB5b</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              SB_splineKnots <span class="op">=</span> <span class="va">res_SB5b</span><span class="op">$</span><span class="va">splineKnots</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Afin de mettre encore mieux en évidence les « contorsions » excessives potentielles de </span></span></span>
<span class="r-in"><span><span class="co"># la spline cubique lorsqu'on impose les ajustements projetés de `benchmarking()` (c.-à-d., </span></span></span>
<span class="r-in"><span><span class="co"># des nœuds supplémentaires de basse fréquence immédiats avec `n_low_freq_proj = 0`), </span></span></span>
<span class="r-in"><span><span class="co"># traçons les deux précédents ensembles d'ajustements sur le même graphique (la ligne </span></span></span>
<span class="r-in"><span><span class="co"># bleue correspond ici au cas `n_low_freq_proj = 0`, soit les ajustements projetés de </span></span></span>
<span class="r-in"><span><span class="co"># `benchmarking()` alors que la ligne rouge correspond aux ajustements par défaut de </span></span></span>
<span class="r-in"><span><span class="co"># `stock_benchmarking()`, soit `n_low_freq_proj = 1`).</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_benchAdj.html">plot_benchAdj</a></span><span class="op">(</span>PB_graphTable <span class="op">=</span> <span class="va">res_SB5</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              SB_graphTable <span class="op">=</span> <span class="va">res_SB5b</span><span class="op">$</span><span class="va">graphTable</span>,</span></span>
<span class="r-in"><span>              legend <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stock_benchmarking-10.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table des matières"><h2>Sur cette page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Développé par Michel Ferland, Statistics Canada.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site créé avec <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

